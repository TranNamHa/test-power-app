"ListCommunicationRecord As screen.'phoneLayout_FluidGridWithHeaderPageLayout_ver3.0'":
    Fill: =RGBA(248, 248, 249, 1)
    OnHidden: =
    OnVisible: |-
        =UpdateContext({ShowNotification: false});
        //Header
        Set(MenuSelect,"Portal");
        Set(MenuSelect2,"Communication Records");
        Set(HeaderText,"");
        
        //Clear(position);
        Reset(Timer1_18);
        Reset(Search_Input_5);
        Reset(DateFrom_Datepicker_7);
        Reset(DateTo_DatePicker_7);
        Reset(CRSummaryTitle_Input_2);
        Reset(Input_meeting_title);
        Reset(DateOfMeeting_DatePicker_2);
        Set(recordItemSelected, Blank());
        Set(reportDivisionCRValue, Blank());
        
        // Show notification
        Set(IsError, false);
        Switch(ShowNotificationCheck,
        "CREATED_SUCCESS", Set(NoticationText,"Submitted successfully!");UpdateContext({ShowNotification: true}),
        "UPDATED_SUCCESS", Set(NoticationText,"Submitted successfully!");UpdateContext({ShowNotification: true}),
        "REJECTED_SUCCESS", Set(NoticationText,"Rejected successfully!");UpdateContext({ShowNotification: true}),
        "REVISED_SUCCESS", Set(NoticationText,"Revised successfully!");UpdateContext({ShowNotification: true}),
        "APPROVED_SUCCESS", Set(NoticationText,"Approved successfully!");UpdateContext({ShowNotification: true}),
        "DELETED_SUCCESS", Set(NoticationText,"Deleted successfully!");UpdateContext({ShowNotification: true}),
        "SYSTEM_ERROR", Set(IsError, true);Set(NoticationText,"The system is busy, please try again later!");UpdateContext({ShowNotification: true}),
        "SYSTEM_ERROR_APPROVED", Set(IsError, true);Set(NoticationText,"This proposal has been approved, please check again.");UpdateContext({ShowNotification: true}),
        "STATUS_CHANGED", Set(IsError, true);Set(NoticationText,"This proposal has been processed by another user, please reload this page.");UpdateContext({ShowNotification: true})
        );
        Set(ShowNotificationCheck, "");
        Set(isHeadDivision, false);
        
        Set(isDisable, false );
        Set(PageSizeNumberRecord,10);
        Set(currentPageIndexRecord,0);
        Set(isShowModifyModal, false);
        Set(DealDetailTab, 1);
        Set(isEditShowPopup, true);
        Set(isAllowTab, true);
        If(!isFromDetailCommunicationRecord, Set(isLoading, true), Set(isLoading, false));
        If(TypeDivison = "Research", ClearCollect(colExternalRecord, colExternalRecordActioneed), ClearCollect(colExternalRecord, colExternalRecordMyMeeting));
        
        //Check division
        If("Research" in LookUp(currenUserV2.permissionList,process_code = "Process1.1", division), 
        Set(TypeDivison, "Research"),
        Set(TypeDivison, "IBPE")
        );
        
        // Check status
        Clear(proposalFilterStatus);
        If(DealDetailTab = 1,
            If("CREATE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action), Collect(proposalFilterStatus,{value: "DRAFT"}));
            If("APPROVE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action), Collect(proposalFilterStatus,{value: "SUBMITTED"}));,
            DealDetailTab = 2,
            Collect(proposalFilterStatus,{value: "DRAFT"});
            If(!("APPROVE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action)), Collect(proposalFilterStatus,{value: "SUBMITTED"}));,
            Collect(proposalFilterStatus,{value: "APPROVED"});
            Collect(proposalFilterStatus,{value: "REJECTED"});
        );
        
        //Check Head Division
        If("CREATE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action) && !("APPROVE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action)), Set(isHeadDivision, false));
        
        If("APPROVE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action), Set(isHeadDivision, true));
        
        Set(isFullPermission, "CREATE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action) && "APPROVE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action));
        
        If(TypeDivison <> "Research",
            Concurrent(ClearCollect(listDivisionFilterTemp, 'TVS->GetLookUpDivisionFilter'.Run(envDEV, envTEST, envUAT1, envUAT2)),
            ClearCollect(colExternalRecordMyMeeting, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                resKeyOpenAll.open, resKeyOpenAll.close,
                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                PageSizeNumberRecord, 
                currentPageIndexRecord, 
                envDEV, envTEST, envUAT1, envUAT2,
                currenUserV2.id,
                currenUserV2.email,
                isAllowTab, // isMyMeeting
                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id), //divison
                isHeadDivision,
                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''")
            )),
            ClearCollect(colExternalRecordShareMeeting, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                resKeyOpenAll.open, resKeyOpenAll.close,
                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                PageSizeNumberRecord, 
                currentPageIndexRecord, 
                envDEV, envTEST, envUAT1, envUAT2,
                currenUserV2.id,
                currenUserV2.email,
                false, // isMyMeeting
                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id), //divison
                isHeadDivision,
                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''")
            ))),
            Concurrent(
            ClearCollect(listDivisionFilterTemp, 'TVS->GetLookUpDivisionFilter'.Run(envDEV, envTEST, envUAT1, envUAT2)),
            If(isFullPermission, ClearCollect(colExternalRecordShareMeetingFull, 'TVS->FilterFindAllRecords_Both-V3'.Run(
                resKeyOpenAll.open, resKeyOpenAll.close,
                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                PageSizeNumberRecord, 
                currentPageIndexRecord, 
                envDEV, envTEST, envUAT1, envUAT2, 
                currenUserV2.id, 
                true,
                false,
                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                currenUserV2.email, 
                false,
                false, // isMyMeeting
                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
        )),
        ClearCollect(colExternalRecordShareMeetingNoFull, 'TVS->FilterFindAllRecords-V3'.Run(
                resKeyOpenAll.open, resKeyOpenAll.close,
                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                PageSizeNumberRecord, 
                currentPageIndexRecord, 
                envDEV, envTEST, envUAT1, envUAT2, 
                currenUserV2.id, 
                 true,
                false,
                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                isHeadDivision,
                currenUserV2.email, 
                false,
                false, // isMyMeeting
                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
        ))),
            ClearCollect(colExternalRecordActioneed, If(isFullPermission, 
            'TVS->FilterFindAllRecords_Both-V3'.Run(
                resKeyOpenAll.open, resKeyOpenAll.close,
                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                PageSizeNumberRecord, 
                currentPageIndexRecord, 
                envDEV, envTEST, envUAT1, envUAT2, 
                currenUserV2.id, 
                true,
                false,
        
                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                currenUserV2.email, 
              false,
                isAllowTab, // isMyMeeting
                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
        ), 
            'TVS->FilterFindAllRecords-V3'.Run(
                resKeyOpenAll.open, resKeyOpenAll.close,
                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                PageSizeNumberRecord, 
                currentPageIndexRecord, 
                envDEV, envTEST, envUAT1, envUAT2, 
                currenUserV2.id, 
                true,
                false,
                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                isHeadDivision,
                currenUserV2.email, 
                false,
                isAllowTab, // isMyMeeting
                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
            )
        )),
            //Inprocess
            ClearCollect(colExternalRecordInProcess, If(isFullPermission, 
            'TVS->FilterFindAllRecords_Both-V3'.Run(
                resKeyOpenAll.open, resKeyOpenAll.close,
                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                10, 
                0, 
                envDEV, envTEST, envUAT1, envUAT2, 
                false,
                true,
                currenUserV2.id, 
                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                currenUserV2.email, 
                false,
              //  If(DealDetailTab = 3, true, false),
                isAllowTab, // isMyMeeting
                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
        ), 
            'TVS->FilterFindAllRecords-V3'.Run(
                resKeyOpenAll.open, resKeyOpenAll.close,
                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                10, 
                0, 
                envDEV, envTEST, envUAT1, envUAT2, 
                currenUserV2.id, 
                 false,
                true,
                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                isHeadDivision,
                currenUserV2.email, 
              //  If(DealDetailTab = 3, true, false),
              false,
                isAllowTab, // isMyMeeting
                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
            )
        )),
            //Complete
            ClearCollect(colExternalRecordComplete, If(isFullPermission, 
            'TVS->FilterFindAllRecords_Both-V3'.Run(
                resKeyOpenAll.open, resKeyOpenAll.close,
                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                PageSizeNumberRecord, 
                currentPageIndexRecord, 
                envDEV, envTEST, envUAT1, envUAT2, 
                currenUserV2.id, 
                false,
                false,
                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                currenUserV2.email, 
                true,
                isAllowTab, // isMyMeeting
                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
        ), 
            'TVS->FilterFindAllRecords-V3'.Run(
                resKeyOpenAll.open, resKeyOpenAll.close,
                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                PageSizeNumberRecord, 
                currentPageIndexRecord, 
                envDEV, envTEST, envUAT1, envUAT2, 
                currenUserV2.id, 
                false,
                false,
                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                isHeadDivision,
                currenUserV2.email, 
                true,
                isAllowTab, // isMyMeeting
                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
            )
        ))));
        
        If(TypeDivison = "Research", ClearCollect(colExternalRecord, colExternalRecordActioneed), ClearCollect(colExternalRecord, colExternalRecordMyMeeting));
        Set(isLoading, false);
        Set(isFromDetailCommunicationRecord, false);
        
        ClearCollect(listDivisionFilter, AddColumns(listDivisionFilterTemp, company_department, ""));
        UpdateIf(listDivisionFilter, true, {company_department: company_name & " - " & name});
        
        Set(pageCountRecord, First(colExternalRecord).pageCount); 
        //pageIndex
        Set(maxList,[1,2,3,4]);
        Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
        ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
        ForAll(maxList,If(Last(listPageIndexRecord).Value < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
        
        //UpdateContext({ShowNotification: false});
        ////Header
        //Set(MenuSelect,"Portal");
        //Set(MenuSelect2,"Communication Records");
        //Set(HeaderText,"");
        //
        ////Clear(position);
        //Reset(Timer1_18);
        //Reset(Search_Input_5);
        //Reset(DateFrom_Datepicker_7);
        //Reset(DateTo_DatePicker_7);
        //Set(reportDivisionCRValue, Blank());
        //
        //// Show notification
        //Set(IsError, false);
        //Switch(ShowNotificationCheck,
        //"CREATED_SUCCESS", Set(NoticationText,"Submitted successfully!");UpdateContext({ShowNotification: true}),
        //"UPDATED_SUCCESS", Set(NoticationText,"Submitted successfully!");UpdateContext({ShowNotification: true}),
        //"REJECTED_SUCCESS", Set(NoticationText,"Rejected successfully!");UpdateContext({ShowNotification: true}),
        //"REVISED_SUCCESS", Set(NoticationText,"Revised successfully!");UpdateContext({ShowNotification: true}),
        //"APPROVED_SUCCESS", Set(NoticationText,"Approved successfully!");UpdateContext({ShowNotification: true}),
        //"DELETED_SUCCESS", Set(NoticationText,"Deleted successfully!");UpdateContext({ShowNotification: true}),
        //"SYSTEM_ERROR", Set(IsError, true);Set(NoticationText,"The system is busy, please try again later!");UpdateContext({ShowNotification: true}),
        //"SYSTEM_ERROR_APPROVED", Set(IsError, true);Set(NoticationText,"This proposal has been approved, please check again.");UpdateContext({ShowNotification: true}),
        //"STATUS_CHANGED", Set(IsError, true);Set(NoticationText,"This proposal has been processed by another user, please reload this page.");UpdateContext({ShowNotification: true})
        //);
        //Set(ShowNotificationCheck, "");
        //
        //Set(isDisable, false );
        //Set(PageSizeNumberRecord,10);
        //Set(currentPageIndexRecord,0);
        //Set(isShowModifyModal, false);
        //Set(DealDetailTab, 1);
        //Set(isEditShowPopup, true);
        //Set(isAllowTab, true);
        //Set(isLoading, true);
        //
        ////Check division
        //If("Research" in LookUp(currenUserV2.permissionList,process_code = "Process1.1", division),
        //Set(TypeDivison, "Research"),
        //Set(TypeDivison, "IBPE")
        //);
        //
        //// Check status
        //Clear(proposalFilterStatus);
        //If(DealDetailTab = 1,
        //If("CREATE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action), Collect(proposalFilterStatus,{value: "DRAFT"}));
        //If("APPROVE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action), Collect(proposalFilterStatus,{value: "SUBMITTED"}));,
        //DealDetailTab = 2,
        //Collect(proposalFilterStatus,{value: "DRAFT"});
        //If(!("APPROVE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action)), Collect(proposalFilterStatus,{value: "SUBMITTED"}));,
        //Collect(proposalFilterStatus,{value: "APPROVED"});
        //Collect(proposalFilterStatus,{value: "REJECTED"});
        //);
        //
        ////Check Head Division
        //If("CREATE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action) && !("APPROVE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action)), Set(isHeadDivision, false), Set(isHeadDivision, true));
        //
        //Set(isFullPermission, "CREATE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action) && "APPROVE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action));
        //
        //Concurrent(
        //ClearCollect(listDivisionFilterTemp, 'TVS->GetLookUpDivisionFilter'.Run(envDEV, envTEST, envUAT1, envUAT2)),
        //If(TypeDivison <> "Research",
        //ClearCollect(colExternalRecord, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
        //resKeyOpenAll.open, resKeyOpenAll.close,
        //Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
        //Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
        //If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
        //PageSizeNumberRecord,
        //currentPageIndexRecord,
        //envDEV, envTEST, envUAT1, envUAT2,
        //currenUserV2.id,
        //currenUserV2.email,
        //isAllowTab, // isMyMeeting
        //If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
        //)),
        //ClearCollect(colExternalRecord, If(isFullPermission,
        //'TVS->FilterFindAllRecords_Both-V3'.Run(
        //resKeyOpenAll.open, resKeyOpenAll.close,
        //Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
        //Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
        //If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
        //PageSizeNumberRecord,
        //currentPageIndexRecord,
        //envDEV, envTEST, envUAT1, envUAT2,
        //currenUserV2.id,
        //If(DealDetailTab = 1, true, false), //actionneed
        //If(DealDetailTab = 2, true, false), //inprocess
        //If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
        //currenUserV2.email,
        //If(DealDetailTab = 3, true, false),
        //isAllowTab, // isMyMeeting
        //If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
        //),
        //'TVS->FilterFindAllRecords-V3'.Run(
        //resKeyOpenAll.open, resKeyOpenAll.close,
        //Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
        //Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
        //If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
        //PageSizeNumberRecord,
        //currentPageIndexRecord,
        //envDEV, envTEST, envUAT1, envUAT2,
        //currenUserV2.id,
        //If(DealDetailTab = 1, true, false), //actionneed
        //If(DealDetailTab = 2, true, false), //inprocess
        //If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
        //isHeadDivision,
        //currenUserV2.email,
        //If(DealDetailTab = 3, true, false),
        //isAllowTab, // isMyMeeting
        //If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
        //)
        //))
        //));
        //Set(isLoading, false);
        //
        //ClearCollect(listDivisionFilter, AddColumns(listDivisionFilterTemp, "company_department", ""));
        //UpdateIf(listDivisionFilter, true, {company_department: company_name & " - " & name});
        //
        //Set(pageCountRecord, First(colExternalRecord).pageCount);
        ////pageIndex
        //Set(maxList,[1,2,3,4]);
        //Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
        //ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
        //ForAll(maxList,If(Last(listPageIndexRecord).Value < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));

    RectQuickActionBar4 As rectangle:
        Height: =56
        Width: =Parent.Width
        ZIndex: =1

    Canvas6 As fluidGrid.fluidGridWithBlankCard:
        BorderThickness: =0
        Height: =Parent.Height - Self.Y
        Width: =Parent.Width
        Y: =RectQuickActionBar4.Y + RectQuickActionBar4.Height
        ZIndex: =2

        DataCard6 As dataCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            BorderThickness: =0
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =Parent.Height - 100
            Width: =Parent.Width
            X: =0
            Y: =0
            ZIndex: =1

            White_Background_7 As htmlViewer:
                Font: =Font.Arial
                Height: =TableHListEmp_1.Height + 70
                HtmlText: |-
                    ="<div style='width: calc(100% - 16px); height: "& Self.Height - 20 &"px; background-color: white;border-radius: 12px;box-shadow: "& If(Parent.Width > 600, "7px 5px 7px 0px rgba(0, 0, 0, 0.10)", "none") & ";
                    '></div>"
                PaddingRight: =5.00
                PaddingTop: =5.00
                Size: =14.00
                Width: =If(App.Width > 800, App.Width - If(MobileShowMenu, MenuItemsSideBar_IR.Width, MenuItemsSideBar_Small_IR.Width) - 20, App.Width + 5)
                X: =QT_Action.X
                Y: =QT_Action.Y + QT_Action.Height + 10
                ZIndex: =1

            ListOfEmployee_Title_2 As label:
                BorderColor: =RGBA(89, 0, 0, 1)
                Font: =Font.Arial
                FontWeight: =FontWeight.Bold
                Height: =33
                PaddingRight: =5.00
                PaddingTop: =5.00
                Size: =12
                Text: ="Communication records informations"
                Width: =300
                X: =White_Background_7.X + 10
                Y: =White_Background_7.Y + 10
                ZIndex: =2

            Hr_9 As rectangle:
                BorderColor: =RGBA(89, 0, 0, 1)
                BorderStyle: =BorderStyle.None
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(191, 191, 192, 1)
                Height: =2
                Width: =White_Background_7.Width - 35
                X: =ListOfEmployee_Title_2.X
                Y: =Division_Header_4.Y + Division_Header_4.Height + TableHListEmp_1.Y
                ZIndex: =3

            TableHListEmp_1 As groupContainer.horizontalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                Height: =Min(Max(FromListEmployee_4.AllItemsCount, 1), 10) * FromListEmployee_4.TemplateHeight + If(FromListEmployee_4.AllItemsCount > 10, 100, 70)
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowX: =LayoutOverflow.Scroll
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =If(App.Width > 600, Hr_9.Width, White_Background_7.Width - 40)
                X: =Hr_9.X
                Y: =White_Background_7.Y + 50
                ZIndex: =4

                Container3_1 As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =TableHListEmp_1.Height
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: =Updated_date_Header_9.X + Updated_date_Header_9.Width
                    ZIndex: =1

                    FromListEmployee_4 As gallery.galleryVertical:
                        '#CopilotOverlayLabel': ="Filtered"
                        BorderColor: =RGBA(255, 255, 255, 1)
                        DelayItemLoading: =true
                        Height: =Parent.Height - 50
                        Items: =First(colExternalRecord).listItem
                        Layout: =Layout.Vertical
                        LoadingSpinner: =LoadingSpinner.Data
                        OnSelect: =true
                        TemplateFill: =//If(Mod(Value(ThisItem.id), 2) = 0, RGBA(246,246,246,1), RGBA(0,0,0,0))
                        TemplatePadding: =0
                        TemplateSize: =40
                        Width: =Container3_1.Width
                        X: =No_Header_4.X
                        Y: =40
                        ZIndex: =1

                        Label_No_Employee_4 As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Fill: =If(Mod(Value(ThisItem.STT), 2) = 0, RGBA(246,246,246,1), RGBA(0,0,0,0))
                            Font: =Font.Arial
                            OnSelect: =Select(Parent)
                            PaddingRight: =5.00
                            PaddingTop: =10
                            Size: =10.5
                            Text: =ThisItem.STT
                            Width: =No_Header_4.Width
                            ZIndex: =1

                        data_divison As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Fill: =If(Mod(Value(ThisItem.STT), 2) = 0, RGBA(246,246,246,1), RGBA(0,0,0,0))
                            Font: =Font.Arial
                            OnSelect: =
                            PaddingRight: =5.00
                            PaddingTop: =10
                            Size: =10.5
                            Text: =LookUp(listDepartment, id = ThisItem.division).company_department
                            Width: =Division_Header_4.Width
                            X: =Label_No_Employee_4.X + Label_No_Employee_4.Width
                            ZIndex: =2

                        data_meeting_id As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Fill: =If(Mod(Value(ThisItem.STT), 2) = 0, RGBA(246,246,246,1), RGBA(0,0,0,0))
                            Font: =Font.Arial
                            OnSelect: =Select(Parent)
                            PaddingRight: =5.00
                            PaddingTop: =5.00
                            Size: =10.5
                            Text: =ThisItem.id
                            Width: =Meeting_id_Header_4.Width
                            X: =data_divison.X + data_divison.Width
                            ZIndex: =3

                        data_meeting_catrgory As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Fill: =If(Mod(Value(ThisItem.STT), 2) = 0, RGBA(246,246,246,1), RGBA(0,0,0,0))
                            Font: =Font.Arial
                            OnSelect: =Select(Parent)
                            PaddingRight: =5.00
                            PaddingTop: =5.00
                            Size: =10.5
                            Text: =Proper(ThisItem.meeting_nature)
                            Width: =Meeting_category_Header_4.Width
                            X: =data_meeting_id.X + data_meeting_id.Width
                            ZIndex: =4

                        data_meeting_title As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Fill: =If(Mod(Value(ThisItem.STT), 2) = 0, RGBA(246,246,246,1), RGBA(0,0,0,0))
                            Font: =Font.Arial
                            OnSelect: =Select(Parent)
                            PaddingRight: =5.00
                            PaddingTop: =5.00
                            Size: =10.5
                            Text: |-
                                =If(Len(If(IsBlank(ThisItem.meeting_title), If(IsBlank(ThisItem.meeting_title), "", ThisItem.meeting_title), ThisItem.meeting_title)) > 45,
                                    Left(If(IsBlank(ThisItem.meeting_title), If(IsBlank(ThisItem.meeting_title), "", ThisItem.meeting_title), ThisItem.meeting_title), 45) & "...",
                                    If(IsBlank(ThisItem.meeting_title), If(IsBlank(ThisItem.meeting_title), "", ThisItem.meeting_title), ThisItem.meeting_title)
                                )
                            Width: =Meeting_title_Header_4.Width
                            Wrap: =false
                            X: =data_meeting_catrgory.X + data_meeting_catrgory.Width
                            ZIndex: =5

                        data_date_of_meeting As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Fill: =If(Mod(Value(ThisItem.STT), 2) = 0, RGBA(246,246,246,1), RGBA(0,0,0,0))
                            Font: =Font.Arial
                            OnSelect: =Select(Parent)
                            PaddingRight: =5.00
                            PaddingTop: =5.00
                            Size: =10.5
                            Text: =Text(DateTimeValue(ThisItem.date_of_meeting), "dd/mm/yyyy")
                            Width: =Date_of_meeting_Header_4.Width
                            X: =data_meeting_title.X + data_meeting_title.Width
                            ZIndex: =6

                        data_hashtag As label:
                            Fill: =If(Mod(Value(ThisItem.STT), 2) = 0, RGBA(246,246,246,1), RGBA(0,0,0,0))
                            Font: =Font.Arial
                            OnSelect: =Select(Parent);
                            Size: =10.5
                            Text: |-
                                =// If(Len(Proper(ThisItem.hash_tag)) > 55, Left(Proper(ThisItem.hash_tag), 55) & "...", Proper(ThisItem.hash_tag))
                                Left(
                                If(Len(Proper(Concat(Distinct(Split(ThisItem.hash_tag, "/"), Value), Value & "/"))) > 55, Left(Proper(Concat(Distinct(Split(ThisItem.hash_tag, "/"), Value), Value & "/")), 55) & "...", Proper(Concat(Distinct(Split(ThisItem.hash_tag, "/"), Value), Value & "/"))),
                                Len(If(Len(Proper(Concat(Distinct(Split(ThisItem.hash_tag, "/"), Value), Value & "/"))) > 55, Left(Proper(Concat(Distinct(Split(ThisItem.hash_tag, "/"), Value), Value & "/")), 55) & "...", Proper(Concat(Distinct(Split(ThisItem.hash_tag, "/"), Value), Value & "/")))) - 1)
                            Width: =hash_tag_Header_5.Width
                            X: =data_date_of_meeting.X + data_date_of_meeting.Width
                            ZIndex: =7

                        data_summary As label:
                            Fill: =If(Mod(Value(ThisItem.STT), 2) = 0, RGBA(246,246,246,1), RGBA(0,0,0,0))
                            Font: =Font.Arial
                            OnSelect: =Select(Parent);
                            Size: =10.5
                            Text: |-
                                =If(Len(If(IsBlank(ThisItem.summary_on_the_meeting_notes), If(IsBlank(ThisItem.summary_on_the_meeting_notes), "", ThisItem.summary_on_the_meeting_notes), ThisItem.summary_on_the_meeting_notes)) > 45,
                                    Left(If(IsBlank(ThisItem.summary_on_the_meeting_notes), If(IsBlank(ThisItem.summary_on_the_meeting_notes), "", ThisItem.summary_on_the_meeting_notes), ThisItem.summary_on_the_meeting_notes), 45) & "...",
                                    If(IsBlank(ThisItem.summary_on_the_meeting_notes), If(IsBlank(ThisItem.summary_on_the_meeting_notes), "", ThisItem.summary_on_the_meeting_notes), ThisItem.summary_on_the_meeting_notes)
                                )
                            Width: =Summary_Header_6.Width
                            X: =data_hashtag.X + data_hashtag.Width
                            ZIndex: =8

                        data_status As label:
                            Color: |-
                                =If(
                                    Upper(ThisItem.status) = "DRAFT",
                                    RGBA(98,95,95,1),
                                    !IsBlank(Find("SUBMITTED",Upper(ThisItem.status))),
                                    RGBA(181,184,24,1),
                                    !IsBlank(Find("REJECTED",Upper(ThisItem.status))),
                                    RGBA(214,27,27,1),
                                    Upper(ThisItem.status) = "APPROVED",
                                    RGBA(11,201,75,1)
                                )
                            Fill: =If(Mod(Value(ThisItem.STT), 2) = 0, RGBA(246,246,246,1), RGBA(0,0,0,0))
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Bold
                            OnSelect: =Select(Parent);
                            PaddingLeft: =25
                            Size: =10.5
                            Text: =If(Upper(ThisItem.status) = "SUBMITTED", "Pending approval", Proper(ThisItem.status))
                            Width: =Status_Header_4.Width
                            X: =data_summary.X + data_summary.Width
                            ZIndex: =9

                        DotIcon_6 As label:
                            Color: =data_status.Color 
                            Font: =Font.Lato
                            OnSelect: =Select(Parent)
                            PaddingTop: =0
                            Size: =40
                            Text: ="."
                            VerticalAlign: =VerticalAlign.Bottom
                            Visible: =!IsEmpty(First(colEmployees).listItem)
                            Width: =20
                            X: =data_status.X
                            ZIndex: =10

                        data_create_by As label:
                            Fill: =If(Mod(Value(ThisItem.STT), 2) = 0, RGBA(246,246,246,1), RGBA(0,0,0,0))
                            Font: =Font.Arial
                            OnSelect: =Select(Parent);
                            Size: =10.5
                            Text: =Proper(ThisItem.created_by)
                            Width: =Created_by_Header_7.Width
                            X: =data_status.X + data_status.Width
                            ZIndex: =11

                        data_create_date As label:
                            Fill: =If(Mod(Value(ThisItem.STT), 2) = 0, RGBA(246,246,246,1), RGBA(0,0,0,0))
                            Font: =Font.Arial
                            OnSelect: =Select(Parent);
                            Size: =10.5
                            Text: =Text(DateTimeValue(ThisItem.created_date), "dd/mm/yyyy")
                            Width: =Created_date_Header_8.Width
                            X: =data_create_by.X + data_create_by.Width
                            ZIndex: =12

                        data_update_date As label:
                            Fill: =If(Mod(Value(ThisItem.STT), 2) = 0, RGBA(246,246,246,1), RGBA(0,0,0,0))
                            Font: =Font.Arial
                            OnSelect: =Select(Parent);
                            Size: =10.5
                            Text: =Text(DateTimeValue(ThisItem.write_date), "dd/mm/yyyy")
                            Width: =Updated_date_Header_9.Width
                            X: =data_create_date.X + data_create_date.Width
                            ZIndex: =13

                        Button_OverLay_6 As button:
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisabledColor: =RGBA(0, 0, 0, 0)
                            DisabledFill: =RGBA(0, 0, 0, 0)
                            Fill: =RGBA(0, 0, 0, 0)
                            Font: =Font.Arial
                            HoverFill: =Self.Fill
                            OnSelect: |-
                                =Set(isLoading, true);
                                Set(DealDetailTabOld, DealDetailTab);
                                Set(recordItemSelected, ThisItem);
                                If(recordItemSelected.meeting_nature = "EXTERNAL", Set(TypeNature, "External"), Set(TypeNature, "Internal"));
                                If(Upper(LookUp(listDepartment, id = recordItemSelected.division).name) = "RESEARCH", Set(TypeInformationNonList, "Research"));
                                Set(DivisionSelected, LookUp(listDepartment, id = recordItemSelected.division));
                                Set(childRecordSelected, Blank());
                                
                                ////---External
                                If(TypeNature = "External",
                                   Set(childRecordSelected, 'TVS->FindCommunicationRecordsByIdExternal'.Run(resKeyOpenAll.open, resKeyOpenAll.close, FromListEmployee_4.Selected.id, envDEV, envTEST, envUAT1, envUAT2));
                                    ClearCollect(HasTags, childRecordSelected.has_tag);
                                    ClearCollect(ShareTo, childRecordSelected.share_to);
                                    ClearCollect(colExternalFiles, RenameColumns(RenameColumns(RenameColumns(RenameColumns(childRecordSelected.attachment, created_date, Date), file_name, Name), created_by, By), id, Id));
                                    UpdateIf(colExternalFiles As f, true, {By: LookUp(allEmployeesNoPaging, id = f.By).name});
                                    Reset(AttachFile_3);
                                
                                    ////dynamic table
                                    Set(splitIssuer, RenameColumns(childRecordSelected.dynamic_table, col, Value));
                                    Set(header, Split(First(splitIssuer).Value, "<"));
                                    ClearCollect(splitIssuerNotFirst, Filter(splitIssuer, Value <> First(splitIssuer).Value));
                                
                                    ClearCollect(Quaters, RenameColumns(Filter(header, Upper(Value) <> "ITEM" && Upper(Value) <> "UNIT"), Value, value));
                                
                                    Clear(Values);
                                    ForAll(splitIssuerNotFirst As item, 
                                    RemoveIf(firstSlash, true);
                                    RemoveIf(secondSlash, true);
                                        Collect(firstSlash, {value: Find("<", item.Value)});
                                        Collect(secondSlash, {value: (Find("<", item.Value, First(firstSlash).value + 1))});
                                        Collect(Values, {items: Split(Mid(item.Value, First(secondSlash).value + 1, Len(item.Value) - First(secondSlash).value), "<")})
                                    );
                                    
                                    ClearCollect(ListPartyExternal, ShowColumns(RenameColumns(GroupBy(childRecordSelected.party, id, party_name, party_value, _data), party_value, value), id, party_name, value));
                                    UpdateIf(ListPartyExternal As item, true, {
                                    markId: GUID(),
                                    partyMembers: AddColumns(RenameColumns(
                                        ShowColumns(GroupBy(Filter(childRecordSelected.party, id = item.id && member_id <> Blank()), member_value, member_id, party_value, _data), member_value, member_id, party_value), member_value, email), id, GUID(), internal_email, "", name, "")
                                    });
                                    RenameColumns(ShowColumns(childRecordSelected.party, member_value), member_value, email);
                                    Clear(attachments);
                                    ForAll(Filter(GroupBy(childRecordSelected.party, file_id, file_name, id, _data), !IsBlank(file_id)) As p, Collect(attachments, {id: p.file_id, name: p.file_name, markId: LookUp(ListPartyExternal, id = p.id).markId}))
                                );
                                
                                ////---Internal
                                Clear(partyItems);
                                If(TypeNature = "Internal", 
                                    Set(recordInternalSelected, 'TVS->FindByIdInternalRecord'.Run(resKeyOpenAll.open, resKeyOpenAll.close, FromListEmployee_4.Selected.id, envDEV, envTEST, envUAT1, envUAT2));
                                    ClearCollect(partyGroup, GroupBy(recordInternalSelected.parties, id, party_name, value, created_date, partyMembers));
                                
                                    ForAll(partyGroup As data,
                                    Collect(partyItems, {id: data.id, party_name: data.party_name, value: data.value, created_date: data.created_date, 
                                    partyMembers: AddColumns(RenameColumns(Filter(data.partyMembers As item, item.member <> Blank()), member, email), id, GUID(), internal_email, "", name, "")
                                    }));
                                    ClearCollect(colExternalFiles, RenameColumns(RenameColumns(RenameColumns(RenameColumns(recordInternalSelected.attachments, created_date, Date), file_name, Name), created_by, By), id, Id));
                                    UpdateIf(colExternalFiles As f, true, {By: LookUp(allEmployeesNoPaging, id = f.By).name});
                                    ClearCollect(ListPartyExternal, partyItems);
                                    UpdateIf(ListPartyExternal, true, {markId: GUID()});
                                    ClearCollect(HasTags, recordInternalSelected.hasTags);
                                    ClearCollect(ShareTo, recordInternalSelected.shareTo)
                                );
                                
                                //Set dataCommon
                                If(!IsBlank(recordItemSelected),
                                    Set(meetingTypeValue, recordItemSelected.meeting_type);
                                );
                                
                                ClearCollect(colInternalFiles, RenameColumns(RenameColumns(RenameColumns(recordInternalSelected.attachments, file_name, Name), created_date, Date), created_by, By));
                                UpdateIf(colInternalFiles As f, true, {By: LookUp(allEmployeesNoPaging, id = f.By).name});
                                
                                
                                Set(isLoading, false);
                                Navigate(DetailCommunicationRecords);
                            PressedFill: =
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Text: =""
                            Width: =FromListEmployee_4.Width
                            ZIndex: =14

                        iconDeleterecord_9 As htmlViewer:
                            Fill: =If(Mod(Value(ThisItem.STT), 2) = 0, RGBA(246,246,246,1), RGBA(0,0,0,0))
                            Font: =Font.Arial
                            HtmlText: |-
                                ="<div style=""cursor: pointer""><svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 16 16"" fill=""none"">
                                  <path d=""M4.66683 2.66634C4.66683 2.31272 4.8073 1.97358 5.05735 1.72353C5.3074 1.47348 5.64654 1.33301 6.00016 1.33301H10.0002C10.3538 1.33301 10.6929 1.47348 10.943 1.72353C11.193 1.97358 11.3335 2.31272 11.3335 2.66634V3.99967H14.0002C14.177 3.99967 14.3465 4.06991 14.4716 4.19494C14.5966 4.31996 14.6668 4.48953 14.6668 4.66634C14.6668 4.84315 14.5966 5.01272 14.4716 5.13775C14.3465 5.26277 14.177 5.33301 14.0002 5.33301H13.2875L12.7095 13.4277C12.6856 13.7641 12.535 14.0789 12.2882 14.3087C12.0415 14.5386 11.7167 14.6663 11.3795 14.6663H4.62016C4.28292 14.6663 3.95821 14.5386 3.71142 14.3087C3.46463 14.0789 3.31411 13.7641 3.29016 13.4277L2.7135 5.33301H2.00016C1.82335 5.33301 1.65378 5.26277 1.52876 5.13775C1.40373 5.01272 1.3335 4.84315 1.3335 4.66634C1.3335 4.48953 1.40373 4.31996 1.52876 4.19494C1.65378 4.06991 1.82335 3.99967 2.00016 3.99967H4.66683V2.66634ZM6.00016 3.99967H10.0002V2.66634H6.00016V3.99967ZM4.0495 5.33301L4.62083 13.333H11.3802L11.9515 5.33301H4.0495ZM6.66683 6.66634C6.84364 6.66634 7.01321 6.73658 7.13823 6.8616C7.26326 6.98663 7.3335 7.1562 7.3335 7.33301V11.333C7.3335 11.5098 7.26326 11.6794 7.13823 11.8044C7.01321 11.9294 6.84364 11.9997 6.66683 11.9997C6.49002 11.9997 6.32045 11.9294 6.19542 11.8044C6.0704 11.6794 6.00016 11.5098 6.00016 11.333V7.33301C6.00016 7.1562 6.0704 6.98663 6.19542 6.8616C6.32045 6.73658 6.49002 6.66634 6.66683 6.66634ZM9.3335 6.66634C9.51031 6.66634 9.67988 6.73658 9.8049 6.8616C9.92992 6.98663 10.0002 7.1562 10.0002 7.33301V11.333C10.0002 11.5098 9.92992 11.6794 9.8049 11.8044C9.67988 11.9294 9.51031 11.9997 9.3335 11.9997C9.15668 11.9997 8.98712 11.9294 8.86209 11.8044C8.73707 11.6794 8.66683 11.5098 8.66683 11.333V7.33301C8.66683 7.1562 8.73707 6.98663 8.86209 6.8616C8.98712 6.73658 9.15668 6.66634 9.3335 6.66634Z"" fill=""#D00C0C""/>
                                </svg></div>"
                            OnSelect: |-
                                =Select(Parent);
                                Set(recordDelete, ThisItem.id);
                                //Set(varEncryptionDeleteSelectedName, ThisItem.name);
                                Set(isShowPopupDelete, true);
                            Tooltip: ="Delete"
                            Visible: =ThisItem.status in ["DRAFT"] && ThisItem.created_by_id = currenUserV2.id
                            Width: =40
                            X: =data_update_date.X + data_update_date.Width - Self.Width
                            ZIndex: =15

                    _Label1_3 As label:
                        Align: =Align.Center
                        Font: =Font.Arial
                        Size: =10.5
                        Text: ="Empty data."
                        Visible: =FromListEmployee_4.AllItemsCount = 0 && !isLoading
                        Width: =TableHListEmp_1.Width
                        Y: =45
                        ZIndex: =14

                    ListEmpHeader_1 As group:
                        Height: =5
                        Width: =5
                        X: =160
                        Y: =160
                        ZIndex: =14

                        No_Header_4 As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Semibold
                            PaddingRight: =5.00
                            PaddingTop: =5.00
                            Size: =10.5
                            Text: ="No"
                            Width: =40
                            ZIndex: =2

                        Division_Header_4 As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Semibold
                            PaddingRight: =5.00
                            PaddingTop: =5.00
                            Size: =10.5
                            Text: ="Division/Entity"
                            Width: =140
                            X: =No_Header_4.X + No_Header_4. Width
                            ZIndex: =3

                        Meeting_id_Header_4 As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Semibold
                            PaddingRight: =5.00
                            PaddingTop: =5.00
                            Size: =10.5
                            Text: ="Meeting ID"
                            Width: =130
                            X: =Division_Header_4.X + Division_Header_4.Width
                            ZIndex: =4

                        Meeting_category_Header_4 As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Semibold
                            PaddingRight: =5.00
                            PaddingTop: =5.00
                            Size: =10.5
                            Text: ="Meeting Category"
                            Width: =130
                            X: =Meeting_id_Header_4.X + Meeting_id_Header_4.Width
                            ZIndex: =5

                        Meeting_title_Header_4 As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Semibold
                            PaddingRight: =5.00
                            PaddingTop: =5.00
                            Size: =10.5
                            Text: ="Meeting Title"
                            Width: =Max(White_Background_7.Width * 0.15, 140)
                            X: =Meeting_category_Header_4.X + Meeting_category_Header_4.Width
                            ZIndex: =6

                        Date_of_meeting_Header_4 As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Semibold
                            PaddingRight: =5.00
                            PaddingTop: =5.00
                            Size: =10.5
                            Text: ="Date of meeting"
                            Width: =120
                            X: =Meeting_title_Header_4.X + Meeting_title_Header_4.Width
                            ZIndex: =7

                        hash_tag_Header_5 As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Semibold
                            PaddingRight: =5.00
                            PaddingTop: =5.00
                            Size: =10.5
                            Text: ="Hashtag"
                            Width: =Max(White_Background_7.Width * 0.15, 140) + If("CREATE" in LookUp(currenUserV2.permissionList, process_code = "Process1.1", action), 40, 0)
                            X: =Date_of_meeting_Header_4.X + Date_of_meeting_Header_4.Width
                            ZIndex: =8

                        Summary_Header_6 As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Semibold
                            PaddingRight: =5.00
                            PaddingTop: =5.00
                            Size: =10.5
                            Text: ="Summary of meeting notes"
                            Width: =200
                            X: =hash_tag_Header_5.X + hash_tag_Header_5.Width
                            ZIndex: =9

                        Status_Header_4 As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Semibold
                            PaddingTop: =5.00
                            Size: =10.5
                            Text: ="Status"
                            Width: =200
                            X: =Summary_Header_6.X + Summary_Header_6.Width
                            ZIndex: =10

                        Created_by_Header_7 As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Semibold
                            PaddingRight: =5.00
                            PaddingTop: =5.00
                            Size: =10.5
                            Text: ="Created by"
                            X: =Status_Header_4.X + Status_Header_4.Width
                            ZIndex: =11

                        Created_date_Header_8 As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Semibold
                            PaddingRight: =5.00
                            PaddingTop: =5.00
                            Size: =10.5
                            Text: ="Created date"
                            Width: =100
                            X: =Created_by_Header_7.X + Created_by_Header_7.Width
                            ZIndex: =12

                        Updated_date_Header_9 As label:
                            BorderColor: =RGBA(89, 0, 0, 1)
                            Font: =Font.Arial
                            FontWeight: =FontWeight.Semibold
                            PaddingRight: =5.00
                            PaddingTop: =5.00
                            Size: =10.5
                            Text: ="Updated date"
                            Width: =140
                            X: =Created_date_Header_8.X + Created_date_Header_8.Width
                            ZIndex: =13

            LabeError_6 As label:
                Align: =Align.Center
                Font: =Font.Arial
                Text: ="Empty data."
                Visible: =IsEmpty(First(colEmployees).listItem)
                Width: =FromListEmployee_4.Width
                X: =Hr_9.X
                Y: =Hr_9.Y + 2
                ZIndex: =5

            DateFrom_InputBack_7 As text:
                BorderColor: =RGBA(191, 191, 192, 1)
                BorderThickness: =1
                Default: ="u vao vn ban"
                FocusedBorderThickness: =2
                Font: =Font.Arial
                Height: =44
                HoverBorderColor: =RGBA(191, 191, 192, 1)
                HoverColor: =RGBA(0, 0, 0, 0)
                HoverFill: =RGBA(0, 0, 0, 0)
                PaddingRight: =5.00
                PaddingTop: =5.00
                Size: =13.00
                Width: =If(Parent.Width > 800, 216.00, (Parent.Width - 20) / 2 - 5)
                X: =DateFrom_Label_5.X
                Y: =DateFrom_Label_5.Y + DateFrom_Label_5.Height
                ZIndex: =6

            DateFrom_Datepicker_7 As datepicker:
                BorderThickness: =0
                DefaultDate: =
                FocusedBorderThickness: =0
                Font: =Font.Arial
                Format: ="dd/mm/yyyy"
                Height: =DateFrom_InputBack_7.Height - 6
                IconBackground: =RGBA(255, 255, 255, 1)
                IconFill: =RGBA(0, 0, 0, 1)
                InputTextPlaceholder: =If(IsBlank(Self.SelectedDate), Text("From", Self.Format, Self.Language))
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                Size: =10.5
                Width: =DateFrom_InputBack_7.Width - 6
                X: =DateFrom_InputBack_7.X + 3
                Y: =DateFrom_InputBack_7.Y + 3
                ZIndex: =7

            DateFrom_Label_5 As label:
                Color: =RGBA(82, 82, 82, 1)
                Font: =Font.Arial
                Height: =30
                PaddingLeft: =0
                PaddingRight: =5.00
                PaddingTop: =5.00
                Size: =10.5
                Text: ="Created date"
                Width: =150.00
                X: =Search_Input_5.X
                Y: =Search_Input_5.Y + Search_Input_5.Height + 10
                ZIndex: =8

            DateTo_InputBack_6 As text:
                BorderColor: =RGBA(191, 191, 192, 1)
                BorderThickness: =1
                Default: ="u vao vn ban"
                FocusedBorderThickness: =2
                Font: =Font.Arial
                Height: =44
                HoverBorderColor: =RGBA(191, 191, 192, 1)
                HoverColor: =RGBA(0, 0, 0, 0)
                HoverFill: =RGBA(0, 0, 0, 0)
                PaddingRight: =5.00
                PaddingTop: =5.00
                Size: =13.00
                Width: =If(Parent.Width > 800, 216.00, (Parent.Width - 20) / 2 - 5)
                X: =DateFrom_InputBack_7.X + DateFrom_InputBack_7.Width + 10
                Y: =DateFrom_Label_5.Y + DateFrom_Label_5.Height
                ZIndex: =9

            DateTo_DatePicker_7 As datepicker:
                BorderThickness: =0
                DefaultDate: =
                FocusedBorderThickness: =0
                Font: =Font.Arial
                Format: ="dd/mm/yyyy"
                Height: =DateTo_InputBack_6.Height - 6
                IconBackground: =RGBA(255, 255, 255, 1)
                IconFill: =RGBA(0, 0, 0, 1)
                InputTextPlaceholder: =If(IsBlank(Self.SelectedDate), Text("To", Self.Format, Self.Language))
                PaddingBottom: =10
                PaddingLeft: =10
                PaddingRight: =10
                PaddingTop: =10
                Size: =10.5
                Width: =DateTo_InputBack_6.Width - 6
                X: =DateTo_InputBack_6.X + 3
                Y: =DateTo_InputBack_6.Y + 3
                ZIndex: =10

            Group1_8 As group:
                Height: =5
                Width: =5
                X: =737
                Y: =332
                ZIndex: =22

                SearchAUMButton_12 As button:
                    BorderThickness: =0
                    DisabledColor: =Self.Color
                    DisabledFill: =Self.Fill
                    Fill: =RGBA(17, 79, 144, 1)
                    FocusedBorderThickness: =0
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Normal
                    Height: =44
                    OnSelect: |
                        =If(DateDiff(DateFrom_Datepicker_7.SelectedDate, DateTo_DatePicker_7.SelectedDate) < 0,
                        
                        Set(NoticationText, "The from date cannot be greater than the to date!"); Set(IsError, true); UpdateContext({ShowNotification: true}); Set(isLoading, false),
                        
                        Set(isLoading, true);
                        Set(ShowPageSizeSelectPopup, false);
                        Set(currentPageIndexRecord,0);
                        //Set(DealDetailTab, 1);
                        
                        Set(isLoading, true);
                        If(TypeDivison <> "Research",
                            Concurrent(ClearCollect(listDivisionFilterTemp, 'TVS->GetLookUpDivisionFilter'.Run(envDEV, envTEST, envUAT1, envUAT2)),
                            ClearCollect(colExternalRecordMyMeeting, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2,
                                currenUserV2.id,
                                currenUserV2.email,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id), //divison
                                isHeadDivision,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''")
                            )),
                            ClearCollect(colExternalRecordShareMeeting, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2,
                                currenUserV2.id,
                                currenUserV2.email,
                                false, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id), //divison
                                isHeadDivision,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''")
                            ))),
                            Concurrent(
                            ClearCollect(listDivisionFilterTemp, 'TVS->GetLookUpDivisionFilter'.Run(envDEV, envTEST, envUAT1, envUAT2)),
                            If(isFullPermission, ClearCollect(colExternalRecordShareMeetingFull, 'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                true,
                                isAllowTab,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                                false,
                                false, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        )),
                        ClearCollect(colExternalRecordShareMeetingNoFull, 'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                 true,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                isHeadDivision,
                                currenUserV2.email, 
                                false,
                                false, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ))),
                            ClearCollect(colExternalRecordActioneed, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                true,
                                false,
                        
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                              false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                true,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                                false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )
                        )),
                            //Inprocess
                            ClearCollect(colExternalRecordInProcess, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                10, 
                                0, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                false,
                                true,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                                false,
                              //  If(DealDetailTab = 3, true, false),
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                10, 
                                0, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                 false,
                                true,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                              //  If(DealDetailTab = 3, true, false),
                              false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )
                        )),
                            //Complete
                            ClearCollect(colExternalRecordComplete, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                false,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                                true,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                false,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                                true,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )
                        ))));
                        
                        If(TypeDivison <> "Research",
                            If(isAllowTab, ClearCollect(colExternalRecord, colExternalRecordMyMeeting), ClearCollect(colExternalRecord, colExternalRecordShareMeeting)));
                        
                        If(TypeDivison = "Research",
                        If(isAllowTab, Switch(DealDetailTab, 1, ClearCollect(colExternalRecord, colExternalRecordActioneed), 2, ClearCollect(colExternalRecord, colExternalRecordInProcess),
                        3, ClearCollect(colExternalRecord, colExternalRecordComplete))));
                        
                        If(TypeDivison = "Research",
                        If(!isAllowTab, If(isFullPermission, ClearCollect(colExternalRecord, colExternalRecordShareMeetingFull), ClearCollect(colExternalRecord, colExternalRecordShareMeetingNoFull))));
                        
                        
                        Set(isLoading, false);
                        Set(pageCountRecord, First(colExternalRecord).pageCount); 
                        //pageIndex
                        Set(maxList,[1,2,3,4]);
                        Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                        ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                        ForAll(maxList,If(Last(listPageIndexRecord).Value   < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                        );
                    PaddingBottom: =10
                    PaddingLeft: =30
                    PaddingRight: =10
                    PaddingTop: =10
                    PressedColor: =Self.Color 
                    PressedFill: =Self.Fill
                    Size: =10.5
                    Text: =""
                    Width: =44
                    X: =If(App.Width > 600, Search_Input_5.X + Search_Input_5.Width + 10, App.Width - btnRefresh_5.Width - 20 - Self.Width)
                    Y: =Search_Input_5.Y
                    ZIndex: =11

                SearchAUMIcon_10 As htmlViewer:
                    Font: =Font.Arial
                    Height: =35
                    HtmlText: |-
                        ="<div style=""display:flex;align-items:center; justify-content: center;; cursor: pointer; width: 30px; height: "&Self.Height - 2&"px""; padding: 5px""><svg xmlns=""http://www.w3.org/2000/svg"" width=""21"" height=""20"" viewBox=""0 0 21 20"" fill=""none"">
                          <path d=""M19.5002 19.0002L15.1572 14.6572M15.1572 14.6572C15.9001 13.9143 16.4894 13.0324 16.8914 12.0618C17.2935 11.0911 17.5004 10.0508 17.5004 9.00021C17.5004 7.9496 17.2935 6.90929 16.8914 5.93866C16.4894 4.96803 15.9001 4.08609 15.1572 3.34321C14.4143 2.60032 13.5324 2.01103 12.5618 1.60898C11.5911 1.20693 10.5508 1 9.50021 1C8.4496 1 7.40929 1.20693 6.43866 1.60898C5.46803 2.01103 4.58609 2.60032 3.84321 3.34321C2.34288 4.84354 1.5 6.87842 1.5 9.00021C1.5 11.122 2.34288 13.1569 3.84321 14.6572C5.34354 16.1575 7.37842 17.0004 9.50021 17.0004C11.622 17.0004 13.6569 16.1575 15.1572 14.6572Z"" stroke=""white"" stroke-width=""2"" stroke-linecap=""round"" stroke-linejoin=""round""/>
                        </svg><div>"
                    OnSelect: =Select(SearchAUMButton_12);
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Width: =30
                    X: =SearchAUMButton_12.X + 6
                    Y: =SearchAUMButton_12.Y + 4
                    ZIndex: =12

            Group17_5 As group:
                Height: =5
                Width: =5
                X: =791
                Y: =332
                ZIndex: =24

                btnRefresh_5 As button:
                    BorderThickness: =0
                    DisabledColor: =Self.Color
                    DisabledFill: =Self.Fill
                    Fill: =RGBA(17, 79, 144, 1)
                    FocusedBorderThickness: =0
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Normal
                    Height: =44
                    OnSelect: |+
                        =Set(isLoading, true);
                        Set(ShowPageSizeSelectPopup, false);
                        Set(currentPageIndexRecord,0);
                        Reset(Search_Input_5);
                        Reset(DateFrom_Datepicker_7);
                        Reset(DateTo_DatePicker_7);
                        Set(reportDivisionCRValue, Blank());
                        Set(isAllowTab, true);
                        Set(DealDetailTab, 1);
                        
                        Set(isLoading, true);
                        If(TypeDivison <> "Research",
                            Concurrent(ClearCollect(listDivisionFilterTemp, 'TVS->GetLookUpDivisionFilter'.Run(envDEV, envTEST, envUAT1, envUAT2)),
                            ClearCollect(colExternalRecordMyMeeting, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2,
                                currenUserV2.id,
                                currenUserV2.email,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id), //divison
                                isHeadDivision,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''")
                            )),
                            ClearCollect(colExternalRecordShareMeeting, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2,
                                currenUserV2.id,
                                currenUserV2.email,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id), //divison
                                isHeadDivision,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''")
                            ))),
                            Concurrent(
                            ClearCollect(listDivisionFilterTemp, 'TVS->GetLookUpDivisionFilter'.Run(envDEV, envTEST, envUAT1, envUAT2)),
                            If(isFullPermission, ClearCollect(colExternalRecordShareMeetingFull, 'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                true,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                                false,
                                false, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        )),
                        ClearCollect(colExternalRecordShareMeetingNoFull, 'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                 true,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                isHeadDivision,
                                currenUserV2.email, 
                                false,
                                false, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ))),
                            ClearCollect(colExternalRecordActioneed, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                true,
                                false,
                        
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                              false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                true,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                                false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )
                        )),
                            //Inprocess
                            ClearCollect(colExternalRecordInProcess, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                10, 
                                0, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                false,
                                true,
                                currenUserV2.id, 
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                                false,
                              //  If(DealDetailTab = 3, true, false),
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                10, 
                                0, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                 false,
                                true,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                              //  If(DealDetailTab = 3, true, false),
                              false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )
                        )),
                            //Complete
                            ClearCollect(colExternalRecordComplete, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                false,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                                true,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                false,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                                true,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )
                        ))));
                        If(TypeDivison = "Research",
                        Switch(DealDetailTab, 1, ClearCollect(colExternalRecord, colExternalRecordActioneed), 2, ClearCollect(colExternalRecord, colExternalRecordInProcess),
                        3, ClearCollect(colExternalRecord, colExternalRecordComplete)));
                        If(TypeDivison <> "Research",
                        Switch(DealDetailTab, 1, ClearCollect(colExternalRecord, colExternalRecordMyMeeting), 2, ClearCollect(colExternalRecord, colExternalRecordShareMeeting)));
                        Set(isLoading, false);
                        
                        Set(pageCountRecord, First(colExternalRecord).pageCount); 
                        //pageIndex
                        Set(maxList,[1,2,3,4]);
                        Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                        ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                        ForAll(maxList,If(Last(listPageIndexRecord).Value   < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                        
                    PaddingBottom: =10
                    PaddingLeft: =30
                    PaddingRight: =10
                    PaddingTop: =10
                    PressedColor: =Self.Color 
                    PressedFill: =Self.Fill
                    Size: =10.5
                    Text: =""
                    Tooltip: ="Click here to clear filters"
                    Width: =44
                    X: =SearchAUMButton_12.X + SearchAUMButton_12.Width + 10
                    Y: =SearchAUMButton_12.Y
                    ZIndex: =13

                RefreshListIcon_9 As icon.Reload:
                    Color: =RGBA(255, 255, 255, 1)
                    Height: =20
                    Icon: =Icon.Reload
                    OnSelect: |+
                        =Set(isLoading, true);
                        Set(ShowPageSizeSelectPopup, false);
                        Set(currentPageIndexRecord,0);
                        Reset(Search_Input_5);
                        Reset(DateFrom_Datepicker_7);
                        Reset(DateTo_DatePicker_7);
                        Set(reportDivisionCRValue, Blank());
                        Set(isAllowTab, true);
                        Set(DealDetailTab, 1);
                        
                        Set(isLoading, true);
                        If(TypeDivison <> "Research",
                            Concurrent(ClearCollect(listDivisionFilterTemp, 'TVS->GetLookUpDivisionFilter'.Run(envDEV, envTEST, envUAT1, envUAT2)),
                            ClearCollect(colExternalRecordMyMeeting, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2,
                                currenUserV2.id,
                                currenUserV2.email,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id), //divison
                                isHeadDivision,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''")
                            )),
                            ClearCollect(colExternalRecordShareMeeting, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2,
                                currenUserV2.id,
                                currenUserV2.email,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id), //divison
                                isHeadDivision,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''")
                            ))),
                            Concurrent(
                            ClearCollect(listDivisionFilterTemp, 'TVS->GetLookUpDivisionFilter'.Run(envDEV, envTEST, envUAT1, envUAT2)),
                            If(isFullPermission, ClearCollect(colExternalRecordShareMeetingFull, 'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                true,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                                false,
                                false, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        )),
                        ClearCollect(colExternalRecordShareMeetingNoFull, 'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                 true,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                isHeadDivision,
                                currenUserV2.email, 
                                false,
                                false, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ))),
                            ClearCollect(colExternalRecordActioneed, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                true,
                                false,
                        
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                              false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                true,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                                false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )
                        )),
                            //Inprocess
                            ClearCollect(colExternalRecordInProcess, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                10, 
                                0, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                false,
                                true,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                                false,
                              //  If(DealDetailTab = 3, true, false),
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                10, 
                                0, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                 false,
                                true,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                              //  If(DealDetailTab = 3, true, false),
                              false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )
                        )),
                            //Complete
                            ClearCollect(colExternalRecordComplete, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                false,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                                true,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                false,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                                true,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )
                        ))));
                        If(TypeDivison = "Research",
                        Switch(DealDetailTab, 1, ClearCollect(colExternalRecord, colExternalRecordActioneed), 2, ClearCollect(colExternalRecord, colExternalRecordInProcess),
                        3, ClearCollect(colExternalRecord, colExternalRecordComplete)));
                        If(TypeDivison <> "Research",
                        Switch(DealDetailTab, 1, ClearCollect(colExternalRecord, colExternalRecordMyMeeting), 2, ClearCollect(colExternalRecord, colExternalRecordShareMeeting)));
                        Set(isLoading, false);
                        
                        Set(pageCountRecord, First(colExternalRecord).pageCount); 
                        //pageIndex
                        Set(maxList,[1,2,3,4]);
                        Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                        ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                        ForAll(maxList,If(Last(listPageIndexRecord).Value   < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                        
                    Tooltip: ="Click here to clear filters"
                    Width: =20
                    X: =btnRefresh_5.X + btnRefresh_5.Width*0.5 - Self.Width*0.5
                    Y: =btnRefresh_5.Y + btnRefresh_5.Height*0.5 - Self.Height*0.5
                    ZIndex: =14

            DropdownDivision As button:
                Align: =Align.Left
                BorderColor: =If(reportWeekShowDropdown, RGBA(0, 18, 107, 1), ColorFade(Self.Fill, -15%))
                BorderThickness: =1
                Color: =RGBA(82, 82, 82, 1)
                Fill: =RGBA(255, 255, 255, 1)
                FocusedBorderThickness: =1
                Font: =Font.Arial
                FontWeight: =FontWeight.Normal
                Height: =44
                HoverColor: =RGBA(0, 0, 0, 1)
                HoverFill: =RGBA(241, 244, 249, 1)
                OnSelect: =Set(reportWeekShowDropdown, !reportWeekShowDropdown)
                PaddingLeft: =15
                PaddingRight: =40
                PaddingTop: =5.27
                PressedBorderColor: =
                PressedColor: =
                PressedFill: =
                RadiusBottomLeft: =5
                RadiusBottomRight: =5
                RadiusTopLeft: =5
                RadiusTopRight: =5
                Size: =10.5
                Text: =reportDivisionCRValue.company_department
                Width: =If(App.Width > 800, (WhiteBackground_6.Width - 120) * 1/5, Parent.Width - 20)
                X: =LabelDivision.X
                Y: =LabelDivision.Y + LabelDivision.Height
                ZIndex: =25

            iconDropdownDivision As htmlViewer:
                Fill: =RGBA(0, 0, 0, 0)
                Font: =Font.Arial
                Height: =44
                HtmlText: |-
                    ="<div style=""cursor: pointer""><svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"">
                    <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M12.7069 15.7071C12.5193 15.8946 12.265 15.9999 11.9999 15.9999C11.7347 15.9999 11.4804 15.8946 11.2929 15.7071L5.63585 10.0501C5.54034 9.95785 5.46416 9.84751 5.41175 9.7255C5.35934 9.6035 5.33176 9.47228 5.3306 9.3395C5.32945 9.20672 5.35475 9.07504 5.40503 8.95215C5.45531 8.82925 5.52957 8.7176 5.62346 8.6237C5.71735 8.52981 5.829 8.45556 5.9519 8.40528C6.0748 8.355 6.20648 8.32969 6.33926 8.33085C6.47204 8.332 6.60325 8.35959 6.72526 8.412C6.84726 8.46441 6.95761 8.54059 7.04985 8.6361L11.9999 13.5861L16.9499 8.6361C17.1385 8.45394 17.3911 8.35315 17.6533 8.35542C17.9155 8.3577 18.1663 8.46287 18.3517 8.64828C18.5371 8.83369 18.6423 9.0845 18.6445 9.3467C18.6468 9.60889 18.546 9.8615 18.3639 10.0501L12.7069 15.7071Z"" fill=""#525252""/>
                    </svg></div>"
                OnSelect: =Set(reportWeekShowDropdown, !reportWeekShowDropdown)
                PaddingRight: =5.27
                PaddingTop: =5.27
                Size: =11.60
                Width: =35
                X: =DropdownDivision.X + DropdownDivision.Width - 40
                Y: =DropdownDivision.Y + 5
                ZIndex: =26

            CreateButtonContainer_3 As group:
                Height: =5
                Width: =5
                X: =40
                Y: =40
                ZIndex: =26

                BtnCreateRecord As button:
                    BorderThickness: =0
                    Fill: =RGBA(17, 79, 144, 1)
                    FocusedBorderThickness: =0
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Normal
                    Height: =If("CREATE" in LookUp(currenUserV2.permissionList, process_code = "Process1.1", action), 44, 0)
                    OnSelect: |-
                        =Set(isSubmited, false);
                        Set(recordSelected, Blank());
                        Set(meetingSelectedValue, "");
                        Set(divisionSelectedValue, Blank());
                        Set(ShowMeetingSelectPopup, false);
                        Set(ShowDivisionSelectPopup, false);
                        Set(isShowCreateCRPopup, true);
                        Concurrent(
                        Set(ListItemUnitConfig, 'TVS->GetAllItemUnitConfig'.Run(resKeyOpenAll.open,resKeyOpenAll.close, envDEV, envTEST, envUAT1, envUAT2)),
                        ClearCollect(NonListPartyExternal, AddColumns('TVS->GetAllCompanyInformation'.Run(resKeyOpenAll.open,resKeyOpenAll.close, envDEV, envTEST, envUAT1, envUAT2), type, "company")));
                    PaddingBottom: =10
                    PaddingLeft: =40
                    PaddingRight: =10
                    PaddingTop: =10
                    PressedColor: =Self.Color 
                    PressedFill: =Self.Fill
                    Size: =10.5
                    Text: ="Create"
                    Visible: ="CREATE" in LookUp(currenUserV2.permissionList, process_code = "Process1.1", action)
                    Width: =120
                    X: =If(App.Width > 800, App.Width - 20 - Self.Width, App.Width - 15 - Self.Width)
                    Y: =If(App.Width > 800, btnRefresh_5.Y, DropdownDivision.Y + DropdownDivision.Height + 10)
                    ZIndex: =15

                iconCreateRecord As icon.AddDocument:
                    Color: =RGBA(255, 255, 255, 1)
                    Height: =27
                    Icon: =Icon.Add
                    OnSelect: |-
                        =Select(BtnCreateRecord);
                        Set(isSubmited, false);
                        Set(recordSelected, Blank());
                        Set(meetingSelectedValue, "");
                        Set(divisionSelectedValue, Blank());
                        Set(ShowMeetingSelectPopup, false);
                        Set(ShowDivisionSelectPopup, false);
                        Set(isShowCreateCRPopup, true);
                        Concurrent(
                        Set(ListItemUnitConfig, 'TVS->GetAllItemUnitConfig'.Run(resKeyOpenAll.open,resKeyOpenAll.close, envDEV, envTEST, envUAT1, envUAT2)),
                        ClearCollect(NonListPartyExternal, AddColumns('TVS->GetAllCompanyInformation'.Run(resKeyOpenAll.open,resKeyOpenAll.close, envDEV, envTEST, envUAT1, envUAT2), type, "company")));
                    PaddingRight: =0.00
                    PaddingTop: =0.00
                    Visible: ="CREATE" in LookUp(currenUserV2.permissionList, process_code = "Process1.1", action)
                    Width: =18
                    X: =BtnCreateRecord.X + 20
                    Y: =BtnCreateRecord.Y + BtnCreateRecord.Height*0.5 - Self.Height*0.5
                    ZIndex: =16

            LabelDivision As label:
                Color: =RGBA(82, 82, 82, 1)
                Font: =Font.Arial
                Height: =30
                PaddingLeft: =0
                PaddingRight: =5.00
                PaddingTop: =5.00
                Size: =10.5
                Text: ="Division/Entity"
                Width: =150.00
                X: =If(App.Width > 800, DateTo_InputBack_6.X + DateTo_InputBack_6.Width + 10, DateFrom_InputBack_7.X)
                Y: =If(App.Width > 800, DateFrom_Label_5.Y, DateFrom_InputBack_7.Y +DateFrom_InputBack_7.Height + 10)
                ZIndex: =27

            MyMeetingTab As button:
                BorderColor: =Self.Color
                BorderThickness: =1
                Color: =If(isAllowTab, RGBA(14, 63, 115, 1), RGBA(176, 176, 176, 1))
                Fill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =1
                Font: =Font.Arial
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: |
                    =Set(isAllowTab, true);
                    Set(DealDetailTab, 1);
                    Set(currentPageIndexRecord, 0);
                    Set(PageSizeNumberRecord, 10);
                    
                    // Check status
                    Clear(proposalFilterStatus);
                    If("CREATE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action), Collect(proposalFilterStatus,{value: "DRAFT"}));
                    If("APPROVE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action), Collect(proposalFilterStatus,{value: "SUBMITTED"}));
                    
                    If(TypeDivison <> "Research", ClearCollect(colExternalRecord, colExternalRecordMyMeeting);
                     Concurrent(ClearCollect(listDivisionFilterTemp, 'TVS->GetLookUpDivisionFilter'.Run(envDEV, envTEST, envUAT1, envUAT2)),
                        ClearCollect(colExternalRecordMyMeeting, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                            resKeyOpenAll.open, resKeyOpenAll.close,
                            Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            PageSizeNumberRecord, 
                            currentPageIndexRecord, 
                            envDEV, envTEST, envUAT1, envUAT2,
                            currenUserV2.id,
                            currenUserV2.email,
                            isAllowTab, // isMyMeeting
                            If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id), //divison
                            isHeadDivision,
                            If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''")
                        )),
                        ClearCollect(colExternalRecordShareMeeting, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                            resKeyOpenAll.open, resKeyOpenAll.close,
                            Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            PageSizeNumberRecord, 
                            currentPageIndexRecord, 
                            envDEV, envTEST, envUAT1, envUAT2,
                            currenUserV2.id,
                            currenUserV2.email,
                            false, // isMyMeeting
                            If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id), //divison
                            isHeadDivision,
                            If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''")
                        ))), ClearCollect(colExternalRecord, colExternalRecordActioneed));
                    
                    
                    Set(pageCountRecord, First(colExternalRecord).pageCount); 
                    //pageIndex
                    Set(maxList,[1,2,3,4]);
                    Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                    ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                    ForAll(maxList,If(Last(listPageIndexRecord).Value < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                    
                    // Set(isAllowTab, true);
                    // Set(DealDetailTab, 1);
                    //
                    // // Check status
                    // Clear(proposalFilterStatus);
                    // If(DealDetailTab = 1,
                    //     If("CREATE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action), Collect(proposalFilterStatus,{value: "DRAFT"}));
                    //     If("APPROVE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action), Collect(proposalFilterStatus,{value: "SUBMITTED"}));,
                    //     DealDetailTab = 2,
                    //     Collect(proposalFilterStatus,{value: "DRAFT"});
                    //     If(!("APPROVE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action)), Collect(proposalFilterStatus,{value: "SUBMITTED"}));,
                    //     Collect(proposalFilterStatus,{value: "APPROVED"});
                    //     Collect(proposalFilterStatus,{value: "REJECTED"});
                    // );
                    //
                    // Set(isLoading, true);
                    // //Concurrent(
                    // //ClearCollect(listDivisionFilterTemp, 'TVS->GetLookUpDivisionFilter'.Run(envDEV, envTEST, envUAT1, envUAT2)),
                    // If(TypeDivison <> "Research",
                    //     ClearCollect(colExternalRecord, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                    //         resKeyOpenAll.open, resKeyOpenAll.close,
                    //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                    //         PageSizeNumberRecord, 
                    //         currentPageIndexRecord, 
                    //         envDEV, envTEST, envUAT1, envUAT2,
                    //         currenUserV2.id,
                    //         currenUserV2.email,
                    //         isAllowTab, // isMyMeeting
                    //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                    //     )),
                    //     Concurrent(
                    //     ClearCollect(colExternalRecordActioneed, If(isFullPermission, 
                    //     'TVS->FilterFindAllRecords_Both-V3'.Run(
                    //         resKeyOpenAll.open, resKeyOpenAll.close,
                    //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                    //         PageSizeNumberRecord, 
                    //         currentPageIndexRecord, 
                    //         envDEV, envTEST, envUAT1, envUAT2, 
                    //         currenUserV2.id, 
                    //          true,
                    //         false,
                    //        // If(DealDetailTab = 1, true, false), //actionneed
                    //       //  If(DealDetailTab = 2, true, false), //inprocess
                    //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                    //         currenUserV2.email, 
                    //       //  If(DealDetailTab = 3, true, false),
                    //       false,
                    //         isAllowTab, // isMyMeeting
                    //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                    // ), 
                    //     'TVS->FilterFindAllRecords-V3'.Run(
                    //         resKeyOpenAll.open, resKeyOpenAll.close,
                    //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                    //         PageSizeNumberRecord, 
                    //         currentPageIndexRecord, 
                    //         envDEV, envTEST, envUAT1, envUAT2, 
                    //         currenUserV2.id, 
                    //         true,
                    //         false,
                    //        // If(DealDetailTab = 1, true, false), //actionneed
                    //        // If(DealDetailTab = 2, true, false), //inprocess
                    //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                    //         isHeadDivision,
                    //         currenUserV2.email, 
                    //         //  If(DealDetailTab = 3, true, false),
                    //         false,
                    //         isAllowTab, // isMyMeeting
                    //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                    //     )
                    // )),
                    //     //Inprocess
                    //     ClearCollect(colExternalRecordInProcess, If(isFullPermission, 
                    //     'TVS->FilterFindAllRecords_Both-V3'.Run(
                    //         resKeyOpenAll.open, resKeyOpenAll.close,
                    //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                    //         PageSizeNumberRecord, 
                    //         currentPageIndexRecord, 
                    //         envDEV, envTEST, envUAT1, envUAT2, 
                    //         false,
                    //         true,
                    //         currenUserV2.id, 
                    //        // If(DealDetailTab = 1, true, false), //actionneed
                    //       //  If(DealDetailTab = 2, true, false), //inprocess
                    //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                    //         currenUserV2.email, 
                    //         false,
                    //       //  If(DealDetailTab = 3, true, false),
                    //         isAllowTab, // isMyMeeting
                    //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                    // ), 
                    //     'TVS->FilterFindAllRecords-V3'.Run(
                    //         resKeyOpenAll.open, resKeyOpenAll.close,
                    //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                    //         PageSizeNumberRecord, 
                    //         currentPageIndexRecord, 
                    //         envDEV, envTEST, envUAT1, envUAT2, 
                    //         currenUserV2.id, 
                    //          false,
                    //         true,
                    //        // If(DealDetailTab = 1, true, false), //actionneed
                    //       //  If(DealDetailTab = 2, true, false), //inprocess
                    //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                    //         isHeadDivision,
                    //         currenUserV2.email, 
                    //       //  If(DealDetailTab = 3, true, false),
                    //       false,
                    //         isAllowTab, // isMyMeeting
                    //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                    //     )
                    // )),
                    //     //Complete
                    //     ClearCollect(colExternalRecordComplete, If(isFullPermission, 
                    //     'TVS->FilterFindAllRecords_Both-V3'.Run(
                    //         resKeyOpenAll.open, resKeyOpenAll.close,
                    //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                    //         PageSizeNumberRecord, 
                    //         currentPageIndexRecord, 
                    //         envDEV, envTEST, envUAT1, envUAT2, 
                    //         currenUserV2.id, 
                    //         false,
                    //         false,
                    //        // If(DealDetailTab = 1, true, false), //actionneed
                    //       //  If(DealDetailTab = 2, true, false), //inprocess
                    //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                    //         currenUserV2.email, 
                    //         true,
                    //       //  If(DealDetailTab = 3, true, false),
                    //         isAllowTab, // isMyMeeting
                    //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                    // ), 
                    //     'TVS->FilterFindAllRecords-V3'.Run(
                    //         resKeyOpenAll.open, resKeyOpenAll.close,
                    //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                    //         PageSizeNumberRecord, 
                    //         currentPageIndexRecord, 
                    //         envDEV, envTEST, envUAT1, envUAT2, 
                    //         currenUserV2.id, 
                    //         false,
                    //         false,
                    //       //  If(DealDetailTab = 1, true, false), //actionneed
                    //       //  If(DealDetailTab = 2, true, false), //inprocess
                    //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                    //         isHeadDivision,
                    //         currenUserV2.email, 
                    //         true,
                    //       //  If(DealDetailTab = 3, true, false),
                    //         isAllowTab, // isMyMeeting
                    //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                    //     )
                    // ))));
                    // Set(isLoading, false);
                    // ClearCollect(colExternalRecord, colExternalRecordActioneed);
                    // Set(pageCountRecord, First(colExternalRecord).pageCount); 
                    // //pageIndex
                    // Set(maxList,[1,2,3,4]);
                    // Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                    // ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                    // ForAll(maxList,If(Last(listPageIndexRecord).Value < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                PressedColor: =Self.Color
                PressedFill: =Self.Fill
                RadiusBottomLeft: =8
                RadiusBottomRight: =0
                RadiusTopLeft: =8
                RadiusTopRight: =0
                Size: =10.5
                Text: ="My Meeting"
                Width: =100
                X: =DateFrom_InputBack_7.X
                Y: =If(App.Width > 800, DropdownDivision.Y + DropdownDivision.Height + 10, BtnCreateRecord.Y + BtnCreateRecord.Height + 10)
                ZIndex: =28

            ShareMeetingTab As button:
                BorderColor: =Self.Color
                BorderThickness: =1
                Color: =If(!isAllowTab, RGBA(14, 63, 115, 1), RGBA(176, 176, 176, 1))
                Fill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =1
                Font: =Font.Arial
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: |-
                    =Set(isAllowTab, false);
                    Set(DealDetailTab, Blank());
                    Set(currentPageIndexRecord, 0);
                    Set(PageSizeNumberRecord, 10);
                    
                    // Check status
                    Clear(proposalFilterStatus);
                    If("CREATE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action), Collect(proposalFilterStatus,{value: "DRAFT"}));
                    If("APPROVE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action), Collect(proposalFilterStatus,{value: "SUBMITTED"}));
                    
                    If(TypeDivison <> "Research",
                        ClearCollect(colExternalRecord, colExternalRecordShareMeeting);
                        Set(pageCountRecord, First(colExternalRecord).pageCount); 
                    //pageIndex
                    Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                    ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                    ForAll(maxList,If(Last(listPageIndexRecord).Value < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                        ClearCollect(colExternalRecordShareMeeting, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                            resKeyOpenAll.open, resKeyOpenAll.close,
                            Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            PageSizeNumberRecord, 
                            currentPageIndexRecord, 
                            envDEV, envTEST, envUAT1, envUAT2,
                            currenUserV2.id,
                            currenUserV2.email,
                            isAllowTab, // isMyMeeting
                            If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id), //divison
                            isHeadDivision,
                            If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''")
                        ));
                        ClearCollect(colExternalRecord, colExternalRecordShareMeeting);
                        Set(pageCountRecord, First(colExternalRecord).pageCount); , 
                        If(isFullPermission, ClearCollect(colExternalRecord, colExternalRecordShareMeetingFull);
                        Set(pageCountRecord, First(colExternalRecord).pageCount); 
                    //pageIndex
                    Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                    ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                    ForAll(maxList,If(Last(listPageIndexRecord).Value < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                        ClearCollect(colExternalRecordShareMeetingFull, 'TVS->FilterFindAllRecords_Both-V3'.Run(
                            resKeyOpenAll.open, resKeyOpenAll.close,
                            Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            PageSizeNumberRecord, 
                            currentPageIndexRecord, 
                            envDEV, envTEST, envUAT1, envUAT2, 
                            currenUserV2.id, 
                            true,
                            false,
                            If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                            currenUserV2.email, 
                            false,
                            false, // isMyMeeting
                            If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                    )), ClearCollect(colExternalRecord, colExternalRecordShareMeetingNoFull);
                    Set(pageCountRecord, First(colExternalRecord).pageCount); 
                    //pageIndex
                    Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                    ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                    ForAll(maxList,If(Last(listPageIndexRecord).Value < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                        ClearCollect(colExternalRecordShareMeetingNoFull, 'TVS->FilterFindAllRecords-V3'.Run(
                            resKeyOpenAll.open, resKeyOpenAll.close,
                            Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            PageSizeNumberRecord, 
                            currentPageIndexRecord, 
                            envDEV, envTEST, envUAT1, envUAT2, 
                            currenUserV2.id, 
                             true,
                            false,
                            If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                            isHeadDivision,
                            currenUserV2.email, 
                            false,
                            false, // isMyMeeting
                            If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                    ))));
                    
                    Set(isLoading, false);
                    
                    Set(pageCountRecord, First(colExternalRecord).pageCount); 
                    //pageIndex
                    Set(maxList,[1,2,3,4]);
                    Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                    ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                    ForAll(maxList,If(Last(listPageIndexRecord).Value < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                    
                    //Set(isAllowTab, false);
                    //Set(DealDetailTab, Blank());
                    //
                    //// Check status
                    //Clear(proposalFilterStatus);
                    //If("CREATE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action), Collect(proposalFilterStatus,{value: "DRAFT"}));
                    //If("APPROVE" in LookUp(currenUserV2.permissionList,process_code = "Process1.1",action), Collect(proposalFilterStatus,{value: "SUBMITTED"}));
                    //
                    //Set(isLoading, true);
                    //Concurrent(
                    //ClearCollect(listDivisionFilterTemp, 'TVS->GetLookUpDivisionFilter'.Run(envDEV, envTEST, envUAT1, envUAT2)),
                    //If(TypeDivison <> "Research",
                    //ClearCollect(colExternalRecord, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                    //resKeyOpenAll.open, resKeyOpenAll.close,
                    //Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                    //PageSizeNumberRecord,
                    //currentPageIndexRecord,
                    //envDEV, envTEST, envUAT1, envUAT2,
                    //currenUserV2.id,
                    //currenUserV2.email,
                    //isAllowTab, // isMyMeeting
                    //If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                    //)),
                    //ClearCollect(colExternalRecord, If(isFullPermission,
                    //'TVS->FilterFindAllRecords_Both-V3'.Run(
                    //resKeyOpenAll.open, resKeyOpenAll.close,
                    //Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                    //PageSizeNumberRecord,
                    //currentPageIndexRecord,
                    //envDEV, envTEST, envUAT1, envUAT2,
                    //currenUserV2.id,
                    //If(DealDetailTab = 1, true, false), //actionneed
                    //If(DealDetailTab = 2, true, false), //inprocess
                    //If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                    //currenUserV2.email,
                    //If(DealDetailTab = 3, true, false),
                    //isAllowTab, // isMyMeeting
                    //If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                    //),
                    //'TVS->FilterFindAllRecords-V3'.Run(
                    //resKeyOpenAll.open, resKeyOpenAll.close,
                    //Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                    //If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                    //PageSizeNumberRecord,
                    //currentPageIndexRecord,
                    //envDEV, envTEST, envUAT1, envUAT2,
                    //currenUserV2.id,
                    //If(DealDetailTab = 1, true, false), //actionneed
                    //If(DealDetailTab = 2, true, false), //inprocess
                    //If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                    //isHeadDivision,
                    //currenUserV2.email,
                    //If(DealDetailTab = 3, true, false),
                    //isAllowTab, // isMyMeeting
                    //If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                    //)
                    //))
                    //));
                    //Set(isLoading, false);
                    //
                    //Set(pageCountRecord, First(colExternalRecord).pageCount);
                    ////pageIndex
                    //Set(maxList,[1,2,3,4]);
                    //Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                    //ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                    //ForAll(maxList,If(Last(listPageIndexRecord).Value < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                PressedColor: =Self.Color
                PressedFill: =Self.Fill
                RadiusBottomLeft: =0
                RadiusBottomRight: =8
                RadiusTopLeft: =0
                RadiusTopRight: =8
                Size: =10.5
                Text: ="Shared Meeting"
                Width: =120
                X: =MyMeetingTab.X + MyMeetingTab.Width + 1
                Y: =MyMeetingTab.Y
                ZIndex: =29

            ClearFormDateQT2_5 As icon.Cancel:
                Color: =RGBA(0, 0, 0, 1)
                Height: =15
                Icon: =Icon.Cancel
                OnSelect: =Reset(DateFrom_Datepicker_7);
                Visible: =!IsBlank(DateFrom_Datepicker_7.SelectedDate)
                Width: =15
                X: =DateFrom_Datepicker_7.X + DateFrom_Datepicker_7.Width - 50
                Y: =DateFrom_Datepicker_7.Y + 10
                ZIndex: =30

            ClearFormDateQT2_6 As icon.Cancel:
                Color: =RGBA(0, 0, 0, 1)
                Height: =15
                Icon: =Icon.Cancel
                OnSelect: =Reset(DateTo_DatePicker_7);
                Visible: =!IsBlank(DateTo_DatePicker_7.SelectedDate)
                Width: =15
                X: =DateTo_DatePicker_7.X + DateTo_DatePicker_7.Width - 50
                Y: =DateTo_DatePicker_7.Y + 10
                ZIndex: =31

            ClearStatusQT2_2 As icon.Cancel:
                Color: =RGBA(0, 0, 0, 1)
                Height: =15
                Icon: =Icon.Cancel
                OnSelect: =Set(reportDivisionCRValue, Blank());
                Visible: =!IsBlank(reportDivisionCRValue)
                Width: =15
                X: =DropdownDivision.X + DropdownDivision.Width - 55
                Y: =DropdownDivision.Y + 15
                ZIndex: =32

            SearchCloseDropdown_8 As rectangle:
                Fill: =RGBA(255, 255, 255, 0)
                Height: =App.Height - 100
                OnSelect: |-
                    =Set(reportTypeShowDropdown, false);
                    Set(reportYearShowDropdown, false);
                    Set(reportQuarterShowDropdown, false);
                    Set(reportMonthShowDropdown, false);
                    Set(reportWeekShowDropdown, false);
                    Set(reportPrivacyShowDropdown, false);
                Visible: =reportTypeShowDropdown || reportYearShowDropdown || reportQuarterShowDropdown || reportMonthShowDropdown || reportWeekShowDropdown || reportPrivacyShowDropdown
                Width: =Parent.Width
                ZIndex: =33

            Filter_Container_8 As group:
                Height: =5
                Width: =5
                X: =40
                Y: =40
                ZIndex: =33

                PreviousIcon_9 As icon.ChevronLeft:
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    Height: =15
                    Icon: =Icon.ChevronLeft
                    OnSelect: |
                        =Set(currentPageIndexRecord,currentPageIndexRecord -1);
                        Switch(DealDetailTab, 1, ClearCollect(colExternalRecord, colExternalRecordActioneed), 2, ClearCollect(colExternalRecord, colExternalRecordInProcess), 3, ClearCollect(colExternalRecord, colExternalRecordComplete));
                        If(TypeDivison <> "Research",
                            ClearCollect(colExternalRecord, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2,
                                currenUserV2.id,
                                currenUserV2.email,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id), //divison
                                isHeadDivision,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''")
                            )),
                            Concurrent(
                            ClearCollect(colExternalRecordActioneed, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                 true,
                                false,
                               // If(DealDetailTab = 1, true, false), //actionneed
                              //  If(DealDetailTab = 2, true, false), //inprocess
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                              //  If(DealDetailTab = 3, true, false),
                              false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                true,
                                false,
                               // If(DealDetailTab = 1, true, false), //actionneed
                               // If(DealDetailTab = 2, true, false), //inprocess
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                                //  If(DealDetailTab = 3, true, false),
                                false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )
                        )),
                            //Inprocess
                            ClearCollect(colExternalRecordInProcess, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                        currenUserV2.id, 
                                false,
                                true,
                               // If(DealDetailTab = 1, true, false), //actionneed
                              //  If(DealDetailTab = 2, true, false), //inprocess
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                                false,
                              //  If(DealDetailTab = 3, true, false),
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                 false,
                                true,
                               // If(DealDetailTab = 1, true, false), //actionneed
                              //  If(DealDetailTab = 2, true, false), //inprocess
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                              //  If(DealDetailTab = 3, true, false),
                              false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )
                        )),
                            //Complete
                            ClearCollect(colExternalRecordComplete, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                false,
                                false,
                               // If(DealDetailTab = 1, true, false), //actionneed
                              //  If(DealDetailTab = 2, true, false), //inprocess
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                                true,
                              //  If(DealDetailTab = 3, true, false),
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                false,
                                false,
                              //  If(DealDetailTab = 1, true, false), //actionneed
                              //  If(DealDetailTab = 2, true, false), //inprocess
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                                true,
                              //  If(DealDetailTab = 3, true, false),
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )
                        ))));
                        
                        Set(pageCountRecord, First(colExternalRecord).pageCount); 
                        //pageIndex
                        Set(maxList,[1,2,3,4]);
                        Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                        ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                        ForAll(maxList,If(Last(listPageIndexRecord).Value < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                    Tooltip: ="Previous page"
                    Visible: |
                        =If(currentPageIndexRecord<=0,false,true)
                    Width: =15
                    X: =PageNumbers_9.X - 20
                    Y: =NextIcon_9.Y
                    ZIndex: =17

                NextIcon_9 As icon.ChevronRight:
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    Height: =15
                    Icon: =Icon.ChevronRight
                    OnSelect: |
                        =
                        Set(currentPageIndexRecord,currentPageIndexRecord +1);
                        // ClearCollect(colRecord,'TVS->FilterFindAllRecords'.Run(resKeyOpenAll.open,resKeyOpenAll.close,"","","",PageSizeNumberRecord,currentPageIndexRecord,env, TypeInformationNonList));
                        
                        Switch(DealDetailTab, 1, ClearCollect(colExternalRecord, colExternalRecordActioneed), 2, ClearCollect(colExternalRecord, colExternalRecordInProcess), 3, ClearCollect(colExternalRecord, colExternalRecordComplete));
                        If(TypeDivison <> "Research",
                            ClearCollect(colExternalRecord, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2,
                                currenUserV2.id,
                                currenUserV2.email,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id), //divison
                                isHeadDivision,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''")
                            )),
                            Concurrent(
                            ClearCollect(colExternalRecordActioneed, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                 true,
                                false,
                               // If(DealDetailTab = 1, true, false), //actionneed
                              //  If(DealDetailTab = 2, true, false), //inprocess
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                              //  If(DealDetailTab = 3, true, false),
                              false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                true,
                                false,
                               // If(DealDetailTab = 1, true, false), //actionneed
                               // If(DealDetailTab = 2, true, false), //inprocess
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                                //  If(DealDetailTab = 3, true, false),
                                false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )
                        )),
                            //Inprocess
                            ClearCollect(colExternalRecordInProcess, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                false,
                                true,
                               // If(DealDetailTab = 1, true, false), //actionneed
                              //  If(DealDetailTab = 2, true, false), //inprocess
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                                false,
                              //  If(DealDetailTab = 3, true, false),
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                 false,
                                true,
                               // If(DealDetailTab = 1, true, false), //actionneed
                              //  If(DealDetailTab = 2, true, false), //inprocess
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                              //  If(DealDetailTab = 3, true, false),
                              false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )
                        )),
                            //Complete
                            ClearCollect(colExternalRecordComplete, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                false,
                                false,
                               // If(DealDetailTab = 1, true, false), //actionneed
                              //  If(DealDetailTab = 2, true, false), //inprocess
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                                true,
                              //  If(DealDetailTab = 3, true, false),
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                        ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                false,
                                false,
                              //  If(DealDetailTab = 1, true, false), //actionneed
                              //  If(DealDetailTab = 2, true, false), //inprocess
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                                true,
                              //  If(DealDetailTab = 3, true, false),
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )
                        ))));
                        
                        // Set(pageCountRecord,First(colRecord.pageCount).pageCount);
                        Set(pageCountRecord, First(colExternalRecord).pageCount);
                        //pageIndex
                        
                        Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                        ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                        ForAll(maxList,If(Last(listPageIndexRecord).Value   < pageCountRecord,Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                    Tooltip: ="Next page"
                    Visible: |
                        =If(currentPageIndexRecord>=pageCountRecord-1,false,true)
                    Width: =15
                    X: =WhiteBackground.X + WhiteBackground.Width - 50
                    Y: =PageNumbers_9.Y + 12.5
                    ZIndex: =18

                "PageNumbers_9 As gallery.'BrowseLayout_Horizontal_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    DelayItemLoading: =true
                    Height: =42
                    Items: =listPageIndexRecord
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =40
                    Width: =PageNumbers_9.AllItemsCount * 40
                    X: =NextIcon_9.X - PageNumbers_9.Width
                    Y: =White_Background_7.Y + White_Background_7.Height
                    ZIndex: =19

                    pageIndex_10 As htmlViewer:
                        DisabledFill: =RGBA(0, 0, 0, 0)
                        DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                        Font: =Font.Arial
                        HtmlText: |-
                            ="<div style='width: 15px; display: flex; justify-content: center; align-items: center; cursor: pointer; padding: 3px; background-color: transparent; border-radius: 5px; border: " & If(currentPageIndexRecord + 1 = ThisItem.Value, "1px solid #1890FF", "none")&";'><font color=" & If(currentPageIndexRecord + 1 = ThisItem.Value, "#1890FF", "black")&">" & (ThisItem.Value) & "</font></div>"
                        OnSelect: |
                            =Set(currentPageIndexRecord,ThisItem.Value-1);
                            Concurrent(
                            ClearCollect(listDivisionFilterTemp, 'TVS->GetLookUpDivisionFilter'.Run(envDEV, envTEST, envUAT1, envUAT2)),
                            If(TypeDivison <> "Research",
                                ClearCollect(colExternalRecord, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                                    resKeyOpenAll.open, resKeyOpenAll.close,
                                    Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                    Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                    If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                    PageSizeNumberRecord, 
                                    currentPageIndexRecord, 
                                    envDEV, envTEST, envUAT1, envUAT2,
                                    currenUserV2.id,
                                    currenUserV2.email,
                                    isAllowTab, // isMyMeeting
                                    If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id), //divison
                                    isHeadDivision,
                                    If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''")
                                )),
                                ClearCollect(colExternalRecord, If(isFullPermission, 
                                'TVS->FilterFindAllRecords_Both-V3'.Run(
                                    resKeyOpenAll.open, resKeyOpenAll.close,
                                    Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                    Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                    If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                    PageSizeNumberRecord, 
                                    currentPageIndexRecord, 
                                    envDEV, envTEST, envUAT1, envUAT2, 
                                    currenUserV2.id, 
                                    If(DealDetailTab = 1, true, false), //actionneed
                                    If(DealDetailTab = 2, true, false), //inprocess
                                    If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                    currenUserV2.email, 
                                    If(DealDetailTab = 3, true, false),
                                    isAllowTab, // isMyMeeting
                                    If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                            ), 
                                'TVS->FilterFindAllRecords-V3'.Run(
                                    resKeyOpenAll.open, resKeyOpenAll.close,
                                    Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                    Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                    If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                    PageSizeNumberRecord, 
                                    currentPageIndexRecord, 
                                    envDEV, envTEST, envUAT1, envUAT2, 
                                    currenUserV2.id, 
                                    If(DealDetailTab = 1, true, false), //actionneed
                                    If(DealDetailTab = 2, true, false), //inprocess
                                    If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                    isHeadDivision,
                                    currenUserV2.email, 
                                    If(DealDetailTab = 3, true, false),
                                    isAllowTab, // isMyMeeting
                                    If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                                )
                            ))
                            ));
                            
                            Set(pageCountRecord, First(colExternalRecord).pageCount); 
                            //pageIndex
                            Set(maxList,[1,2,3,4]);
                            Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                            ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                            ForAll(maxList,If(Last(listPageIndexRecord).Value   < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                            
                            
                            
                            
                            // Set(isLoading, true);
                            // Set(currentPageIndexRecord,ThisItem.Value-1);
                            // Set(isLoading, true);
                            // Switch(DealDetailTab, 1, ClearCollect(colExternalRecord, colExternalRecordActioneed), 2, ClearCollect(colExternalRecord, colExternalRecordInProcess), 3, ClearCollect(colExternalRecord, colExternalRecordComplete));
                            // If(TypeDivison <> "Research",
                            //     ClearCollect(colExternalRecord, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                            //         resKeyOpenAll.open, resKeyOpenAll.close,
                            //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            //         PageSizeNumberRecord, 
                            //         currentPageIndexRecord, 
                            //         envDEV, envTEST, envUAT1, envUAT2,
                            //         currenUserV2.id,
                            //         currenUserV2.email,
                            //         isAllowTab, // isMyMeeting
                            //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            //     )),
                            //     Concurrent(
                            //     ClearCollect(colExternalRecordActioneed, If(isFullPermission, 
                            //     'TVS->FilterFindAllRecords_Both-V3'.Run(
                            //         resKeyOpenAll.open, resKeyOpenAll.close,
                            //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            //         PageSizeNumberRecord, 
                            //         currentPageIndexRecord, 
                            //         envDEV, envTEST, envUAT1, envUAT2, 
                            //         currenUserV2.id, 
                            //          true,
                            //         false,
                            //        // If(DealDetailTab = 1, true, false), //actionneed
                            //       //  If(DealDetailTab = 2, true, false), //inprocess
                            //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                            //         currenUserV2.email, 
                            //       //  If(DealDetailTab = 3, true, false),
                            //       false,
                            //         isAllowTab, // isMyMeeting
                            //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                            // ), 
                            //     'TVS->FilterFindAllRecords-V3'.Run(
                            //         resKeyOpenAll.open, resKeyOpenAll.close,
                            //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            //         PageSizeNumberRecord, 
                            //         currentPageIndexRecord, 
                            //         envDEV, envTEST, envUAT1, envUAT2, 
                            //         currenUserV2.id, 
                            //         true,
                            //         false,
                            //        // If(DealDetailTab = 1, true, false), //actionneed
                            //        // If(DealDetailTab = 2, true, false), //inprocess
                            //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                            //         isHeadDivision,
                            //         currenUserV2.email, 
                            //         //  If(DealDetailTab = 3, true, false),
                            //         false,
                            //         isAllowTab, // isMyMeeting
                            //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            //     )
                            // )),
                            //     //Inprocess
                            //     ClearCollect(colExternalRecordInProcess, If(isFullPermission, 
                            //     'TVS->FilterFindAllRecords_Both-V3'.Run(
                            //         resKeyOpenAll.open, resKeyOpenAll.close,
                            //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            //         PageSizeNumberRecord, 
                            //         currentPageIndexRecord, 
                            //         envDEV, envTEST, envUAT1, envUAT2, 
                            //         false,
                            //         true,
                            //         currenUserV2.id, 
                            //        // If(DealDetailTab = 1, true, false), //actionneed
                            //       //  If(DealDetailTab = 2, true, false), //inprocess
                            //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                            //         currenUserV2.email, 
                            //         false,
                            //       //  If(DealDetailTab = 3, true, false),
                            //         isAllowTab, // isMyMeeting
                            //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                            // ), 
                            //     'TVS->FilterFindAllRecords-V3'.Run(
                            //         resKeyOpenAll.open, resKeyOpenAll.close,
                            //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            //         PageSizeNumberRecord, 
                            //         currentPageIndexRecord, 
                            //         envDEV, envTEST, envUAT1, envUAT2, 
                            //         currenUserV2.id, 
                            //          false,
                            //         true,
                            //        // If(DealDetailTab = 1, true, false), //actionneed
                            //       //  If(DealDetailTab = 2, true, false), //inprocess
                            //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                            //         isHeadDivision,
                            //         currenUserV2.email, 
                            //       //  If(DealDetailTab = 3, true, false),
                            //       false,
                            //         isAllowTab, // isMyMeeting
                            //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            //     )
                            // )),
                            //     //Complete
                            //     ClearCollect(colExternalRecordComplete, If(isFullPermission, 
                            //     'TVS->FilterFindAllRecords_Both-V3'.Run(
                            //         resKeyOpenAll.open, resKeyOpenAll.close,
                            //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            //         PageSizeNumberRecord, 
                            //         currentPageIndexRecord, 
                            //         envDEV, envTEST, envUAT1, envUAT2, 
                            //         currenUserV2.id, 
                            //         false,
                            //         false,
                            //        // If(DealDetailTab = 1, true, false), //actionneed
                            //       //  If(DealDetailTab = 2, true, false), //inprocess
                            //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                            //         currenUserV2.email, 
                            //         true,
                            //       //  If(DealDetailTab = 3, true, false),
                            //         isAllowTab, // isMyMeeting
                            //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                            // ), 
                            //     'TVS->FilterFindAllRecords-V3'.Run(
                            //         resKeyOpenAll.open, resKeyOpenAll.close,
                            //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            //         PageSizeNumberRecord, 
                            //         currentPageIndexRecord, 
                            //         envDEV, envTEST, envUAT1, envUAT2, 
                            //         currenUserV2.id, 
                            //         false,
                            //         false,
                            //       //  If(DealDetailTab = 1, true, false), //actionneed
                            //       //  If(DealDetailTab = 2, true, false), //inprocess
                            //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                            //         isHeadDivision,
                            //         currenUserV2.email, 
                            //         true,
                            //       //  If(DealDetailTab = 3, true, false),
                            //         isAllowTab, // isMyMeeting
                            //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            //     )
                            // ))));
                            // Set(isLoading, false);
                            //
                            // Set(pageCountRecord, First(colExternalRecord).pageCount); 
                            // //pageIndex
                            // Set(maxList,[1,2,3,4]);
                            // Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                            // ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                            // ForAll(maxList,If(Last(listPageIndexRecord).Value   < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                            //
                            //
                        PaddingRight: =0
                        Width: =40
                        ZIndex: =2

                PopupGreyBg_4 As rectangle:
                    Fill: =RGBA(166, 166, 166, 0.5)
                    Height: =App.Height
                    OnSelect: =Set(ShowPageSizeSelectPopup, false)
                    Visible: =isShowModifyModal
                    Width: =App.Width
                    ZIndex: =20

                PageDropdown_7 As button:
                    Align: =Align.Left
                    BorderThickness: =1
                    Color: =RGBA(82, 82, 82, 1)
                    DisabledFill: =RGBA(166, 166, 166, 0.5)
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    Fill: =RGBA(255, 255, 255, 1)
                    FocusedBorderThickness: =1
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Normal
                    Height: =32
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(241, 244, 249, 1)
                    OnSelect: =Set(ShowPageSizeSelectPopup, !ShowPageSizeSelectPopup)
                    PaddingLeft: =10
                    PaddingRight: =5.27
                    PaddingTop: =5.27
                    PressedBorderColor: =
                    PressedColor: =
                    PressedFill: =
                    Size: =10.5
                    Text: =PageSizeNumberRecord
                    Visible: =App.Width > 800
                    Width: =50
                    X: =PreviousIcon_9.X - 70
                    Y: =PageNumbers_9.Y + 2 
                    ZIndex: =21

                PageChevron_10 As htmlViewer:
                    Font: =Font.Arial
                    Height: =44
                    HtmlText: |
                        =If(ShowPageSizeSelectPopup, "<svg width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"" xmlns=""http://www.w3.org/2000/svg"">
                        <g clip-path=""url(#clip0_1760_3688)"">
                        <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M11.2682 8.62347C11.4558 8.436 11.7101 8.33068 11.9752 8.33068C12.2404 8.33068 12.4947 8.436 12.6822 8.62347L18.3392 14.2805C18.4348 14.3727 18.5109 14.4831 18.5633 14.6051C18.6158 14.7271 18.6433 14.8583 18.6445 14.9911C18.6456 15.1238 18.6203 15.2555 18.5701 15.3784C18.5198 15.5013 18.4455 15.613 18.3516 15.7069C18.2577 15.8008 18.1461 15.875 18.0232 15.9253C17.9003 15.9756 17.7686 16.0009 17.6358 15.9997C17.5031 15.9986 17.3718 15.971 17.2498 15.9186C17.1278 15.8662 17.0175 15.79 16.9252 15.6945L11.9752 10.7445L7.02524 15.6945C6.83664 15.8766 6.58404 15.9774 6.32184 15.9751C6.05965 15.9729 5.80883 15.8677 5.62342 15.6823C5.43802 15.4969 5.33285 15.2461 5.33057 14.9839C5.32829 14.7217 5.42908 14.4691 5.61124 14.2805L11.2682 8.62347Z"" fill=""#525252""/>
                        </g>
                        <defs>
                        <clipPath id=""clip0_1760_3688"">
                        <rect width=""24"" height=""24"" fill=""white""/>
                        </clipPath>
                        </defs>
                        </svg>",
                        "<svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"">
                        <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M12.7069 15.7071C12.5193 15.8946 12.265 15.9999 11.9999 15.9999C11.7347 15.9999 11.4804 15.8946 11.2929 15.7071L5.63585 10.0501C5.54034 9.95785 5.46416 9.84751 5.41175 9.7255C5.35934 9.6035 5.33176 9.47228 5.3306 9.3395C5.32945 9.20672 5.35475 9.07504 5.40503 8.95215C5.45531 8.82925 5.52957 8.7176 5.62346 8.6237C5.71735 8.52981 5.829 8.45556 5.9519 8.40528C6.0748 8.355 6.20648 8.32969 6.33926 8.33085C6.47204 8.332 6.60325 8.35959 6.72526 8.412C6.84726 8.46441 6.95761 8.54059 7.04985 8.6361L11.9999 13.5861L16.9499 8.6361C17.1385 8.45394 17.3911 8.35315 17.6533 8.35542C17.9155 8.3577 18.1663 8.46287 18.3517 8.64828C18.5371 8.83369 18.6423 9.0845 18.6445 9.3467C18.6468 9.60889 18.546 9.8615 18.3639 10.0501L12.7069 15.7071Z"" fill=""#525252""/>
                        </svg>"
                        )
                    OnSelect: =Set(ShowPageSizeSelectPopup, !ShowPageSizeSelectPopup)
                    PaddingRight: =5.27
                    PaddingTop: =5.27
                    Size: =11.60
                    Visible: =App.Width > 800
                    Width: =35
                    X: =PageDropdown_7.X + PageDropdown_7.Width - 28
                    Y: =PageDropdown_7.Y - 1
                    ZIndex: =22

                PageCloseDropdown_8 As rectangle:
                    Fill: =RGBA(255, 255, 255, 0)
                    Height: =794
                    OnSelect: =Set(ShowPageSizeSelectPopup, false)
                    Visible: =ShowPageSizeSelectPopup
                    Width: =Parent.Width
                    Y: =56
                    ZIndex: =23

                "PageItems_10 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    BorderColor: =RGBA(191, 191, 192, 1)
                    BorderThickness: =0.5
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =122
                    Items: |-
                        =[{value: 10}, {value: 20}, {value: 50}]
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =40
                    Visible: =ShowPageSizeSelectPopup
                    Width: =PageDropdown_7.Width
                    X: =PageDropdown_7.X
                    Y: =PageDropdown_7.Y - 130
                    ZIndex: =24

                    Button6_31 As button:
                        Align: =Align.Left
                        BorderThickness: =1
                        Color: =RGBA(82, 82, 82, 1)
                        Fill: =If(PageSizeNumberRole = ThisItem.value, RGBA(241, 244, 249, 1) , RGBA(0, 0, 0, 0))
                        FocusedBorderThickness: =2
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Normal
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(241, 244, 249, 1)
                        OnSelect: |+
                            =Set(PageSizeNumberRecord, ThisItem.value);
                            Set(ShowPageSizeSelectPopup, false);
                            Set(currentPageIndexRecord,0);
                            
                            Concurrent(
                            ClearCollect(listDivisionFilterTemp, 'TVS->GetLookUpDivisionFilter'.Run(envDEV, envTEST, envUAT1, envUAT2)),
                            If(TypeDivison <> "Research",
                                ClearCollect(colExternalRecord, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                                    resKeyOpenAll.open, resKeyOpenAll.close,
                                    Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                    Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                    If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                    PageSizeNumberRecord, 
                                    currentPageIndexRecord, 
                                    envDEV, envTEST, envUAT1, envUAT2,
                                    currenUserV2.id,
                                    currenUserV2.email,
                                    isAllowTab, // isMyMeeting
                                    If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id), //divison
                                    isHeadDivision,
                                    If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''")
                                )),
                                ClearCollect(colExternalRecord, If(isFullPermission, 
                                'TVS->FilterFindAllRecords_Both-V3'.Run(
                                    resKeyOpenAll.open, resKeyOpenAll.close,
                                    Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                    Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                    If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                    PageSizeNumberRecord, 
                                    currentPageIndexRecord, 
                                    envDEV, envTEST, envUAT1, envUAT2, 
                                    currenUserV2.id, 
                                    If(DealDetailTab = 1, true, false), //actionneed
                                    If(DealDetailTab = 2, true, false), //inprocess
                                    If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                    currenUserV2.email, 
                                    If(DealDetailTab = 3, true, false),
                                    isAllowTab, // isMyMeeting
                                    If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                            ), 
                                'TVS->FilterFindAllRecords-V3'.Run(
                                    resKeyOpenAll.open, resKeyOpenAll.close,
                                    Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                    Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                    If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                    PageSizeNumberRecord, 
                                    currentPageIndexRecord, 
                                    envDEV, envTEST, envUAT1, envUAT2, 
                                    currenUserV2.id, 
                                    If(DealDetailTab = 1, true, false), //actionneed
                                    If(DealDetailTab = 2, true, false), //inprocess
                                    If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                    isHeadDivision,
                                    currenUserV2.email, 
                                    If(DealDetailTab = 3, true, false),
                                    isAllowTab, // isMyMeeting
                                    If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                                )
                            ))
                            ));
                            
                            Set(pageCountRecord, First(colExternalRecord).pageCount); 
                            //pageIndex
                            Set(maxList,[1,2,3,4]);
                            Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                            ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                            ForAll(maxList,If(Last(listPageIndexRecord).Value   < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                            
                            
                            
                            // Set(isLoading, true);
                            // Set(PageSizeNumberRecord, ThisItem.value);
                            // Set(ShowPageSizeSelectPopup, false);
                            // Set(currentPageIndexRecord,0);
                            //
                            // Set(isLoading, true);
                            // Switch(DealDetailTab, 1, ClearCollect(colExternalRecord, colExternalRecordActioneed), 2, ClearCollect(colExternalRecord, colExternalRecordInProcess), 3, ClearCollect(colExternalRecord, colExternalRecordComplete));
                            // If(TypeDivison <> "Research",
                            //     ClearCollect(colExternalRecord, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                            //         resKeyOpenAll.open, resKeyOpenAll.close,
                            //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            //         PageSizeNumberRecord, 
                            //         currentPageIndexRecord, 
                            //         envDEV, envTEST, envUAT1, envUAT2,
                            //         currenUserV2.id,
                            //         currenUserV2.email,
                            //         isAllowTab, // isMyMeeting
                            //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            //     )),
                            //     Concurrent(
                            //     ClearCollect(colExternalRecordActioneed, If(isFullPermission, 
                            //     'TVS->FilterFindAllRecords_Both-V3'.Run(
                            //         resKeyOpenAll.open, resKeyOpenAll.close,
                            //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            //         PageSizeNumberRecord, 
                            //         currentPageIndexRecord, 
                            //         envDEV, envTEST, envUAT1, envUAT2, 
                            //         currenUserV2.id, 
                            //          true,
                            //         false,
                            //        // If(DealDetailTab = 1, true, false), //actionneed
                            //       //  If(DealDetailTab = 2, true, false), //inprocess
                            //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                            //         currenUserV2.email, 
                            //       //  If(DealDetailTab = 3, true, false),
                            //       false,
                            //         isAllowTab, // isMyMeeting
                            //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                            // ), 
                            //     'TVS->FilterFindAllRecords-V3'.Run(
                            //         resKeyOpenAll.open, resKeyOpenAll.close,
                            //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            //         PageSizeNumberRecord, 
                            //         currentPageIndexRecord, 
                            //         envDEV, envTEST, envUAT1, envUAT2, 
                            //         currenUserV2.id, 
                            //         true,
                            //         false,
                            //        // If(DealDetailTab = 1, true, false), //actionneed
                            //        // If(DealDetailTab = 2, true, false), //inprocess
                            //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                            //         isHeadDivision,
                            //         currenUserV2.email, 
                            //         //  If(DealDetailTab = 3, true, false),
                            //         false,
                            //         isAllowTab, // isMyMeeting
                            //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            //     )
                            // )),
                            //     //Inprocess
                            //     ClearCollect(colExternalRecordInProcess, If(isFullPermission, 
                            //     'TVS->FilterFindAllRecords_Both-V3'.Run(
                            //         resKeyOpenAll.open, resKeyOpenAll.close,
                            //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            //         PageSizeNumberRecord, 
                            //         currentPageIndexRecord, 
                            //         envDEV, envTEST, envUAT1, envUAT2, 
                            //         false,
                            //         true,
                            //         currenUserV2.id, 
                            //        // If(DealDetailTab = 1, true, false), //actionneed
                            //       //  If(DealDetailTab = 2, true, false), //inprocess
                            //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                            //         currenUserV2.email, 
                            //         false,
                            //       //  If(DealDetailTab = 3, true, false),
                            //         isAllowTab, // isMyMeeting
                            //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                            // ), 
                            //     'TVS->FilterFindAllRecords-V3'.Run(
                            //         resKeyOpenAll.open, resKeyOpenAll.close,
                            //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            //         PageSizeNumberRecord, 
                            //         currentPageIndexRecord, 
                            //         envDEV, envTEST, envUAT1, envUAT2, 
                            //         currenUserV2.id, 
                            //          false,
                            //         true,
                            //        // If(DealDetailTab = 1, true, false), //actionneed
                            //       //  If(DealDetailTab = 2, true, false), //inprocess
                            //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                            //         isHeadDivision,
                            //         currenUserV2.email, 
                            //       //  If(DealDetailTab = 3, true, false),
                            //       false,
                            //         isAllowTab, // isMyMeeting
                            //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            //     )
                            // )),
                            //     //Complete
                            //     ClearCollect(colExternalRecordComplete, If(isFullPermission, 
                            //     'TVS->FilterFindAllRecords_Both-V3'.Run(
                            //         resKeyOpenAll.open, resKeyOpenAll.close,
                            //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            //         PageSizeNumberRecord, 
                            //         currentPageIndexRecord, 
                            //         envDEV, envTEST, envUAT1, envUAT2, 
                            //         currenUserV2.id, 
                            //         false,
                            //         false,
                            //        // If(DealDetailTab = 1, true, false), //actionneed
                            //       //  If(DealDetailTab = 2, true, false), //inprocess
                            //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                            //         currenUserV2.email, 
                            //         true,
                            //       //  If(DealDetailTab = 3, true, false),
                            //         isAllowTab, // isMyMeeting
                            //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                            // ), 
                            //     'TVS->FilterFindAllRecords-V3'.Run(
                            //         resKeyOpenAll.open, resKeyOpenAll.close,
                            //         Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                            //         If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                            //         PageSizeNumberRecord, 
                            //         currentPageIndexRecord, 
                            //         envDEV, envTEST, envUAT1, envUAT2, 
                            //         currenUserV2.id, 
                            //         false,
                            //         false,
                            //       //  If(DealDetailTab = 1, true, false), //actionneed
                            //       //  If(DealDetailTab = 2, true, false), //inprocess
                            //         If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                            //         isHeadDivision,
                            //         currenUserV2.email, 
                            //         true,
                            //       //  If(DealDetailTab = 3, true, false),
                            //         isAllowTab, // isMyMeeting
                            //         If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            //     )
                            // ))));
                            // Set(isLoading, false);
                            //
                            // Set(pageCountRecord, First(colExternalRecord).pageCount); 
                            // //pageIndex
                            // Set(maxList,[1,2,3,4]);
                            // Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                            // ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                            // ForAll(maxList,If(Last(listPageIndexRecord).Value   < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                            
                        PaddingLeft: =15
                        PaddingRight: =5.27
                        PaddingTop: =5.27
                        PressedFill: =
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =10.5
                        Text: =ThisItem.value
                        Width: =50
                        X: =0.00
                        ZIndex: =1

            Search_Input_5 As text:
                BorderColor: =RGBA(191, 191, 192, 1)
                BorderThickness: =1
                Default: =
                DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                FocusedBorderColor: =Self.HoverBorderColor
                FocusedBorderThickness: =1
                Font: =Font.Arial
                Height: =44
                HintText: ="Search..."
                HoverFill: =
                LineHeight: =1.5
                MaxLength: =150
                Size: =If(App.Width > 800,10.5,12)
                Width: =If(App.Width > 800, DropdownDivision.X + DropdownDivision.Width - Self.X, App.Width - SearchAUMButton_12.Width - btnRefresh_5.Width - 40) - If(App.Width > 950 && App.Width < 1100 && MobileShowMenu, 150, 0)
                X: =If(Parent.Width > 800, If(MobileShowMenu, 258, 70), 5)
                Y: =12
                ZIndex: =34

            QT_Action As groupContainer.horizontalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                Height: =If(TypeDivison = "Research" && isAllowTab, If(CR_Tab1.Width + CR_Tab3.Width + CR_Tab2.Width + 20 > App.Width - 20, 52, 47), 0)
                LayoutMode: =LayoutMode.Auto
                LayoutOverflowX: =LayoutOverflow.Scroll
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =Min(CR_Tab1.Width + CR_Tab3.Width + CR_Tab2.Width, App.Width - 20)
                X: =MyMeetingTab.X
                Y: =MyMeetingTab.Y + MyMeetingTab.Height + 5
                ZIndex: =35

                CR_Tab1 As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    LayoutMinHeight: =47
                    LayoutMinWidth: =250
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: =120
                    ZIndex: =1

                    Button8_15 As button:
                        BorderStyle: =BorderStyle.None
                        Color: =If(DealDetailTab = 1, RGBA(14, 63, 115, 1), RGBA(176, 176, 176, 1))
                        DisabledColor: =Self.Color
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.Arial
                        Height: =35
                        HoverColor: =If(DealDetailTab = 1, RGBA(14, 63, 115, 1), RGBA(176, 176, 176, 1))
                        HoverFill: =RGBA(248, 248, 249, 1)
                        OnSelect: |-
                            =Set(DealDetailTab, 1);
                            Set(currentPageIndexRecord, 0);
                            Set(PageSizeNumberRecord, 10);
                            
                            Switch(DealDetailTab, 1, ClearCollect(colExternalRecord, colExternalRecordActioneed), 2, ClearCollect(colExternalRecord, colExternalRecordInProcess),
                            3, ClearCollect(colExternalRecord, colExternalRecordComplete));
                            Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                            ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                            ForAll(maxList,If(Last(listPageIndexRecord).Value < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                            
                            ClearCollect(colExternalRecordActioneed, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                true,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                                //  If(DealDetailTab = 3, true, false),
                                false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                            ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                true,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                                //  If(DealDetailTab = 3, true, false),
                                false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )));
                            Switch(DealDetailTab, 1, ClearCollect(colExternalRecord, colExternalRecordActioneed), 2, ClearCollect(colExternalRecord, colExternalRecordInProcess),
                            3, ClearCollect(colExternalRecord, colExternalRecordComplete));
                            
                            Set(pageCountRecord, First(colExternalRecord).pageCount); 
                            //pageIndex
                            Set(maxList,[1,2,3,4]);
                            Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                            ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                            ForAll(maxList,If(Last(listPageIndexRecord).Value < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                        PaddingLeft: =0
                        PaddingRight: =0
                        PressedBorderColor: =Self.Color
                        PressedColor: =Self.Color
                        PressedFill: =Self.Fill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =If(App.Width > 600, 10.5, 10.5)
                        Text: ="Action needed"
                        Tooltip: ="Action needed"
                        Width: =Parent.Width
                        Y: =3
                        ZIndex: =1

                    BottomBorder1_22 As rectangle:
                        BorderColor: =If(DealDetailTab = 1, RGBA(14,63,115,1),RGBA(176, 176, 176, 1))
                        BorderThickness: =If(DealDetailTab = 1, 2, 0)
                        Fill: =RGBA(246, 246, 246, 1)
                        Height: =If(DealDetailTab = 1, 2, 0)
                        Width: =Parent.Width
                        Y: =38
                        ZIndex: =2

                CR_Tab2 As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    LayoutMinHeight: =47
                    LayoutMinWidth: =250
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: =150
                    ZIndex: =2

                    Button8_17 As button:
                        BorderStyle: =BorderStyle.None
                        Color: =If(DealDetailTab = 2, RGBA(14, 63, 115, 1), RGBA(176, 176, 176, 1))
                        DisabledBorderColor: =Self.Color
                        DisabledColor: =Self.Color
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.Arial
                        Height: =35
                        HoverColor: =If(DealDetailTab = 3, RGBA(14, 63, 115, 1), RGBA(176, 176, 176, 1))
                        HoverFill: =RGBA(248, 248, 249, 1)
                        OnSelect: |-
                            =Set(DealDetailTab, 2);
                            Set(currentPageIndexRecord, 0);
                            Set(PageSizeNumberRecord, 10);
                            
                            Switch(DealDetailTab, 1, ClearCollect(colExternalRecord, colExternalRecordActioneed), 2, ClearCollect(colExternalRecord, colExternalRecordInProcess),
                            3, ClearCollect(colExternalRecord, colExternalRecordComplete));
                            Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                            ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                            ForAll(maxList,If(Last(listPageIndexRecord).Value < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                            
                            //Inprocess
                            ClearCollect(colExternalRecordInProcess, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                false,
                                true,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                                false,
                                //  If(DealDetailTab = 3, true, false),
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                            ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                    false,
                                true,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                                //  If(DealDetailTab = 3, true, false),
                                false,
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )));
                            Switch(DealDetailTab, 1, ClearCollect(colExternalRecord, colExternalRecordActioneed), 2, ClearCollect(colExternalRecord, colExternalRecordInProcess),
                            3, ClearCollect(colExternalRecord, colExternalRecordComplete));
                            
                            Set(pageCountRecord, First(colExternalRecord).pageCount); 
                            //pageIndex
                            Set(maxList,[1,2,3,4]);
                            Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                            ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                            ForAll(maxList,If(Last(listPageIndexRecord).Value < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                        PaddingLeft: =0
                        PaddingRight: =0
                        PressedBorderColor: =Self.Color
                        PressedColor: =Self.Color
                        PressedFill: =Self.Fill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =If(App.Width > 600, 10.5, 10.5)
                        Text: ="Under processing"
                        Tooltip: ="Under processing"
                        Width: =Parent.Width
                        ZIndex: =1

                    BottomBorder1_24 As rectangle:
                        BorderColor: =If(DealDetailTab = 2, RGBA(14,63,115,1),RGBA(176, 176, 176, 1))
                        BorderThickness: =If(DealDetailTab = 2, 2, 0)
                        Fill: =RGBA(246, 246, 246, 1)
                        Height: =If(DealDetailTab = 2, 2, 0)
                        Width: =Parent.Width
                        Y: =38
                        ZIndex: =2

                CR_Tab3 As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    LayoutMinHeight: =47
                    LayoutMinWidth: =250
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: =100
                    ZIndex: =3

                    Button8_18 As button:
                        BorderStyle: =BorderStyle.None
                        Color: =If(DealDetailTab = 3, RGBA(14, 63, 115, 1), RGBA(176, 176, 176, 1))
                        DisabledColor: =Self.Color
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.Arial
                        Height: =35
                        HoverColor: =If(DealDetailTab = 2, RGBA(14, 63, 115, 1), RGBA(176, 176, 176, 1))
                        HoverFill: =RGBA(248, 248, 249, 1)
                        OnSelect: |-
                            =Set(DealDetailTab, 3);
                            Set(currentPageIndexRecord, 0);
                            Set(PageSizeNumberRecord, 10);
                            
                            Switch(DealDetailTab, 1, ClearCollect(colExternalRecord, colExternalRecordActioneed), 2, ClearCollect(colExternalRecord, colExternalRecordInProcess),
                            3, ClearCollect(colExternalRecord, colExternalRecordComplete));
                            Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                            ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                            ForAll(maxList,If(Last(listPageIndexRecord).Value < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                            
                            //Complete
                            ClearCollect(colExternalRecordComplete, If(isFullPermission, 
                            'TVS->FilterFindAllRecords_Both-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                false,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                                currenUserV2.email, 
                                true,
                                //  If(DealDetailTab = 3, true, false),
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                            ), 
                            'TVS->FilterFindAllRecords-V3'.Run(
                                resKeyOpenAll.open, resKeyOpenAll.close,
                                Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                                If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                                PageSizeNumberRecord, 
                                currentPageIndexRecord, 
                                envDEV, envTEST, envUAT1, envUAT2, 
                                currenUserV2.id, 
                                false,
                                false,
                                If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                                isHeadDivision,
                                currenUserV2.email, 
                                true,
                                //  If(DealDetailTab = 3, true, false),
                                isAllowTab, // isMyMeeting
                                If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                            )));
                            Switch(DealDetailTab, 1, ClearCollect(colExternalRecord, colExternalRecordActioneed), 2, ClearCollect(colExternalRecord, colExternalRecordInProcess),
                            3, ClearCollect(colExternalRecord, colExternalRecordComplete));
                            
                            Set(pageCountRecord, First(colExternalRecord).pageCount); 
                            //pageIndex
                            Set(maxList,[1,2,3,4]);
                            Set(pageIndexFirstRecord, 5*RoundDown(currentPageIndexRecord/5, 0)+1);
                            ClearCollect(listPageIndexRecord, pageIndexFirstRecord);
                            ForAll(maxList,If(Last(listPageIndexRecord).Value < pageCountRecord, Collect(listPageIndexRecord,Last(listPageIndexRecord).Value + 1)));
                        PaddingLeft: =0
                        PaddingRight: =0
                        PressedBorderColor: =Self.Color
                        PressedColor: =Self.Color
                        PressedFill: =Self.Fill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =If(App.Width > 600, 10.5, 10.5)
                        Text: ="Completed"
                        Tooltip: ="Completed"
                        Width: =Parent.Width
                        ZIndex: =1

                    BottomBorder1_25 As rectangle:
                        BorderColor: =If(DealDetailTab = 3, RGBA(14,63,115,1),RGBA(176, 176, 176, 1))
                        BorderThickness: =If(DealDetailTab = 3, 2, 0)
                        Fill: =RGBA(246, 246, 246, 1)
                        Height: =If(DealDetailTab = 3, 2, 0)
                        Width: =Parent.Width
                        Y: =38
                        ZIndex: =2

            "Gl_DropdownDivision As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                '#CopilotOverlayLabel': ="Filtered"
                BorderColor: =RGBA(191, 191, 192, 1)
                BorderThickness: =0.5
                DisplayMode: =If(CountRows(listDivisionFilter) > 0, DisplayMode.Edit, DisplayMode.Disabled)
                Fill: =If(CountRows(listDivisionFilter) > 0, RGBA(255, 255, 255, 1), RGBA(244, 244, 244, 100))
                Height: =Min(Self.AllItemsCount, 4) * Self.TemplateHeight + 10
                Items: |-
                    =If(CountRows(listDivisionFilter) > 0, listDivisionFilter, [{code: "",id: "", name: "", company_permission_id: "", company_name: "", company_department: "There is no item"}])
                Layout: =Layout.Vertical
                LoadingSpinner: =LoadingSpinner.Data
                TemplatePadding: =0
                TemplateSize: =40
                Visible: =reportWeekShowDropdown
                Width: =DropdownDivision.Width
                X: =DropdownDivision.X
                Y: =DropdownDivision.Y + 50
                ZIndex: =36

                Button6_38 As button:
                    Align: =Align.Left
                    BorderThickness: =0
                    Color: =RGBA(82, 82, 82, 1)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    DisabledFill: =RGBA(244, 244, 244, 0)
                    Fill: =If(reportDivisionCRValue.id = ThisItem.id, RGBA(241, 244, 249, 1), RGBA(0, 0, 0, 0))
                    FocusedBorderColor: =If(meetingTypeValue = ThisItem.id, RGBA(241, 244, 249, 1), RGBA(0, 0, 0, 0))
                    FocusedBorderThickness: =0
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Normal
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(241, 244, 249, 1)
                    OnSelect: |
                        =If(reportDivisionCRValue.company_department = ThisItem.company_department, 
                            Set(reportDivisionCRValue, Blank()),
                            Set(reportDivisionCRValue, ThisItem);
                        );
                        Set(reportWeekShowDropdown, false);
                    PaddingLeft: =15
                    PaddingRight: =5.27
                    PaddingTop: =5.27
                    PressedColor: =Self.Color
                    PressedFill: =
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10.5
                    Text: =ThisItem.company_department
                    Width: =Parent.Width
                    X: =0.00
                    ZIndex: =1

    HeaderQT2List_5 As Header:
        ZIndex: =3

    MenuItemsSideBar_19 As MenuItemsSideBar:
        Height: =Parent.Height - Self.Y
        MenuItems: |-
            =Table(
                {
                    MenuLabel: "Dashboard",
                    MenuIcon: MenuItemsSideBar_19.IconDasboard,
                    MenuScreenNavigate: Dashboard,
                    MenuID: 1,
                    MenuIconDropDown: MenuItemsSideBar_19.IconDropDown,
                    MenuIconDropUp: MenuItemsSideBar_19.IconDropUp,
                    Submenu: []
                },
                {
                    MenuLabel: "Portal",
                    MenuIcon: MenuItemsSideBar_19.IconSettings,
                    MenuScreenNavigate: Dashboard,
                    MenuID: 2,
                    MenuIconDropDown: MenuItemsSideBar_19.IconDropDown,
                    MenuIconDropUp: MenuItemsSideBar_19.IconDropUp,
                    Submenu: Table(
                        {
                            MenuLabel: "'Information of non-listed compan",
                            MenuIcon: MenuItemsSideBar_19.IconDasboard,
                            MenuScreenNavigate: Portal,
                            MenuID: 2.1
                        },
                        {
                            MenuLabel: "Comunication Records (Minutes of meeting)",
                            MenuIcon: MenuItemsSideBar_19.IconDasboard,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 2.2
                        },
                        {
                            MenuLabel: "Investment Research",
                            MenuIcon: MenuItemsSideBar_19.IconDasboard,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 2.3
                        }
                    )
                },
                {
                    MenuLabel: "Business process",
                    MenuIcon: MenuItemsSideBar_19.IconFile,
                    MenuScreenNavigate: Dashboard,
                    MenuID: 3,
                    MenuIconDropDown: MenuItemsSideBar_19.IconDropDown,
                    MenuIconDropUp: MenuItemsSideBar_19.IconDropUp,
                    Submenu: Table(
                        {
                            MenuLabel: "M&A",
                            MenuIcon: MenuItemsSideBar_19.IconFile,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 3.1
                        },
                        {
                            MenuLabel: "Fixed Income Investment ProcessA",
                            MenuIcon: MenuItemsSideBar_19.IconFile,
                            MenuScreenNavigate: TableProposalQT2,
                            MenuID: 3.2
                        },
                        {
                            MenuLabel: "Margin limit approvalprocess (ad-hoc)",
                            MenuIcon: MenuItemsSideBar_19.IconFile,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 3.3
                        },
                        {
                            MenuLabel: "PEVC",
                            MenuIcon: MenuItemsSideBar_19.IconFile,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 3.4
                        }
                    )
                },
                {
                    MenuLabel: "Admin",
                    MenuIcon: MenuItemsSideBar_19.IconSettings,
                    MenuScreenNavigate: Dashboard,
                    MenuID: 4,
                    MenuIconDropDown: MenuItemsSideBar_19.IconDropDown,
                    MenuIconDropUp: MenuItemsSideBar_19.IconDropUp,
                    Submenu: Table(
                        {
                            MenuLabel: "Manager Authoration&A",
                            MenuIcon: MenuItemsSideBar_19.IconFile,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 4.1
                        },
                        {
                            MenuLabel: "Decentralization",
                            MenuIcon: MenuItemsSideBar_19.IconFile,
                            MenuScreenNavigate: TableProposalQT2,
                            MenuID: 4.2
                        }
                    )
                }
            )
        Visible: =MobileShowMenu
        Width: =If(App.Width > 800, 240, App.Width)
        Y: =56
        ZIndex: =4

    MenuItemsSideBar_Small_16 As MenuItemsSideBar_Small:
        Height: =Parent.Height - Self.Y
        MenuItems: |-
            =Table(
                {
                    MenuLabel: "Dashboard",
                    MenuIcon: MenuItemsSideBar_Small_16.IconDasboard,
                    MenuScreenNavigate: Dashboard,
                    MenuID: 1,
                    MenuIconDropDown: MenuItemsSideBar_Small_16.IconDropDown,
                    MenuIconDropUp: MenuItemsSideBar_Small_16.IconDropUp,
                    Submenu: []
                },
                {
                    MenuLabel: "Portal",
                    MenuIcon: MenuItemsSideBar_Small_16.IconSettings,
                    MenuScreenNavigate: Dashboard,
                    MenuID: 2,
                    MenuIconDropDown: MenuItemsSideBar_Small_16.IconDropDown,
                    MenuIconDropUp: MenuItemsSideBar_Small_16.IconDropUp,
                    Submenu: Table(
                        {
                            MenuLabel: "'Information of non-listed compan",
                            MenuIcon: MenuItemsSideBar_Small_16.IconDasboard,
                            MenuScreenNavigate: Portal,
                            MenuID: 2.1
                        },
                        {
                            MenuLabel: "Comunication Records (Minutes of meeting)",
                            MenuIcon: MenuItemsSideBar_Small_16.IconDasboard,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 2.2
                        },
                        {
                            MenuLabel: "Investment Research",
                            MenuIcon: MenuItemsSideBar_Small_16.IconDasboard,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 2.3
                        }
                    )
                },
                {
                    MenuLabel: "Business process",
                    MenuIcon: MenuItemsSideBar_Small_16.IconFile,
                    MenuScreenNavigate: Dashboard,
                    MenuID: 3,
                    MenuIconDropDown: MenuItemsSideBar_Small_16.IconDropDown,
                    MenuIconDropUp: MenuItemsSideBar_Small_16.IconDropUp,
                    Submenu: Table(
                        {
                            MenuLabel: "M&A",
                            MenuIcon: MenuItemsSideBar_Small_16.IconFile,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 3.1
                        },
                        {
                            MenuLabel: "Fixed Income Investment ProcessA",
                            MenuIcon: MenuItemsSideBar_Small_16.IconFile,
                            MenuScreenNavigate: TableProposalQT2,
                            MenuID: 3.2
                        },
                        {
                            MenuLabel: "Margin limit approvalprocess (ad-hoc)",
                            MenuIcon: MenuItemsSideBar_Small_16.IconFile,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 3.3
                        },
                        {
                            MenuLabel: "PEVC",
                            MenuIcon: MenuItemsSideBar_Small_16.IconFile,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 3.4
                        }
                    )
                },
                {
                    MenuLabel: "Admin",
                    MenuIcon: MenuItemsSideBar_Small_16.IconSettings,
                    MenuScreenNavigate: Dashboard,
                    MenuID: 4,
                    MenuIconDropDown: MenuItemsSideBar_Small_16.IconDropDown,
                    MenuIconDropUp: MenuItemsSideBar_Small_16.IconDropUp,
                    Submenu: Table(
                        {
                            MenuLabel: "Manager Authoiation&A",
                            MenuIcon: MenuItemsSideBar_Small_16.IconFile,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 4.1
                        },
                        {
                            MenuLabel: "Decentralization",
                            MenuIcon: MenuItemsSideBar_Small_16.IconFile,
                            MenuScreenNavigate: TableProposalQT2,
                            MenuID: 4.2
                        }
                    )
                }
            )
        Visible: =App.Width > 800 && !MobileShowMenu
        Y: =56
        ZIndex: =5

    Timer1_18 As timer:
        Duration: =3000
        Font: =Font.Arial
        OnTimerEnd: |-
            =Reset(Timer1_18); UpdateContext({ShowNotification: false}); Set(IsError, false);
        Start: =ShowNotification
        Visible: =false
        X: =60
        Y: =627
        ZIndex: =23

    NotificationBox_18 As button:
        Align: =Align.Left
        BorderColor: =RGBA(40, 167, 69, 1)
        BorderThickness: =0
        DisabledFill: =Self.Fill
        Fill: =If(IsError, RGBA(209, 50, 50, 1), RGBA(40, 167, 69, 1))
        FocusedBorderThickness: =0
        Font: =Font.Arial
        Height: =50
        HoverBorderColor: =Self.Fill
        HoverFill: =Self.Fill
        PaddingLeft: =15
        PaddingRight: =30
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =Self.Fill
        RadiusBottomLeft: =5
        RadiusBottomRight: =5
        RadiusTopLeft: =5
        RadiusTopRight: =5
        Size: =10.5
        Text: =NoticationText
        Visible: =Timer1_18.Value <> 0
        Width: =320
        X: =App.Width - Self.Width - 2
        Y: =60
        ZIndex: =24

    CloseNotiIcon_18 As icon.Cancel:
        Color: =RGBA(255, 255, 255, 1)
        Height: =15
        Icon: =Icon.Cancel
        OnSelect: =Reset(Timer1_18); Set(IsError, false);
        Visible: =NotificationBox_18.Visible
        Width: =15
        X: =NotificationBox_18.X + NotificationBox_18.Width - 25
        Y: =NotificationBox_18.Y + 17.5
        ZIndex: =25

    NotificationScreen_13 As NotificationScreen:
        Visible: =ShowNotificationPopup
        ZIndex: =26

    LoadingQT2List_13 As LoadingComponent_4:
        Visible: =isLoading
        ZIndex: =27

    CreateCREntity_InputBack_1 As button:
        Align: =Align.Left
        BorderColor: =If(IsBlank(Self.Text) && isSubmitedPopup, RGBA(214, 27, 27, 1), If(ShowDivisionSelectPopup, RGBA(0, 18, 107, 1), RGBA(191, 191, 192, 1)))
        BorderThickness: =1
        Color: =RGBA(82, 82, 82, 1)
        Fill: =RGBA(255, 255, 255, 1)
        FocusedBorderThickness: =1
        Font: =Font.Arial
        FontWeight: =FontWeight.Normal
        Height: =44
        HoverColor: =RGBA(0, 0, 0, 1)
        HoverFill: =RGBA(241, 244, 249, 1)
        OnSelect: =Set(ShowMeetingSelectPopup, !ShowMeetingSelectPopup)
        PaddingLeft: =15
        PaddingRight: =5.27
        PaddingTop: =5.27
        PressedBorderColor: =
        PressedColor: =
        PressedFill: =
        RadiusBottomLeft: =5
        RadiusBottomRight: =5
        RadiusTopLeft: =5
        RadiusTopRight: =5
        Size: =If(App.Width > 800,10.5,12)
        Text: =meetingSelectedValue
        Visible: =isShowCreateCRPopup
        Width: =Input_Select_Divison.Width
        X: =CreateCREntity_Title_1.X
        Y: =CreateCREntity_Title_1.Y + CreateCREntity_Title_1.Height
        ZIndex: =28

    MeetingNature_Chevron As htmlViewer:
        Font: =Font.Arial
        Height: =44
        HtmlText: |-
            ="<div style=""cursor: pointer""><svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"">
            <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M12.7069 15.7071C12.5193 15.8946 12.265 15.9999 11.9999 15.9999C11.7347 15.9999 11.4804 15.8946 11.2929 15.7071L5.63585 10.0501C5.54034 9.95785 5.46416 9.84751 5.41175 9.7255C5.35934 9.6035 5.33176 9.47228 5.3306 9.3395C5.32945 9.20672 5.35475 9.07504 5.40503 8.95215C5.45531 8.82925 5.52957 8.7176 5.62346 8.6237C5.71735 8.52981 5.829 8.45556 5.9519 8.40528C6.0748 8.355 6.20648 8.32969 6.33926 8.33085C6.47204 8.332 6.60325 8.35959 6.72526 8.412C6.84726 8.46441 6.95761 8.54059 7.04985 8.6361L11.9999 13.5861L16.9499 8.6361C17.1385 8.45394 17.3911 8.35315 17.6533 8.35542C17.9155 8.3577 18.1663 8.46287 18.3517 8.64828C18.5371 8.83369 18.6423 9.0845 18.6445 9.3467C18.6468 9.60889 18.546 9.8615 18.3639 10.0501L12.7069 15.7071Z"" fill=""#525252""/>
            </svg></div>"
        OnSelect: =Set(ShowMeetingSelectPopup, !ShowMeetingSelectPopup)
        PaddingRight: =5.27
        PaddingTop: =5.27
        Size: =11.60
        Visible: =isShowCreateCRPopup
        Width: =35
        X: =CreateCREntity_InputBack_1.X + CreateCREntity_InputBack_1.Width - 40
        Y: =CreateCREntity_InputBack_1.Y + 5
        ZIndex: =29

    SearchCloseDropdown_2 As rectangle:
        Fill: =RGBA(255, 255, 255, 0)
        Height: =App.Height - 100
        OnSelect: |-
            =Set(ShowMeetingSelectPopup, false);
            Set(ShowDivisionSelectPopup, false);
        Visible: =(ShowMeetingSelectPopup || ShowDivisionSelectPopup) && isShowCreateCRPopup
        Width: =Parent.Width
        Y: =40
        ZIndex: =30

    "MeetingNature_Items As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
        '#CopilotOverlayLabel': ="Filtered"
        BorderColor: =RGBA(191, 191, 192, 1)
        BorderThickness: =0.5
        Fill: =RGBA(255, 255, 255, 1)
        Height: =Self.AllItemsCount * Self.TemplateHeight + 10
        Items: |-
            =[{value:"External"},{value:"Internal"}]
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplatePadding: =0
        TemplateSize: =40
        Visible: =ShowMeetingSelectPopup && isShowCreateCRPopup
        Width: =CreateCREntity_InputBack_1.Width
        X: =CreateCREntity_InputBack_1.X
        Y: =CreateCREntity_InputBack_1.Y + CreateCREntity_InputBack_1.Height + 3
        ZIndex: =31

        Button6_19 As button:
            Align: =Align.Left
            BorderThickness: =0
            Color: =RGBA(82, 82, 82, 1)
            Fill: =If(meetingSelectedValue = ThisItem.value, RGBA(241, 244, 249, 1), RGBA(0, 0, 0, 0))
            FocusedBorderThickness: =0
            Font: =Font.Arial
            FontWeight: =FontWeight.Normal
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =RGBA(241, 244, 249, 1)
            OnSelect: |-
                =Set(meetingSelectedValue, ThisItem.value);
                Set(ShowMeetingSelectPopup, false);
            PaddingLeft: =15
            PaddingRight: =5.27
            PaddingTop: =5.27
            PressedColor: =Self.Color
            PressedFill: =
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =10.5
            Text: =ThisItem.value
            Width: =Parent.Width
            X: =0.00
            ZIndex: =1

    "Division_Items As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
        '#CopilotOverlayLabel': ="Filtered"
        BorderColor: =RGBA(191, 191, 192, 1)
        BorderThickness: =0.5
        DisplayMode: =If(CountRows(Sort(Filter(listDepartment, If(IsBlank(Input_Select_Divison.Text), true, Input_Select_Divison.Text in company_department) && company_department in recorDivision.division), company_department)) > 0, DisplayMode.Edit, DisplayMode.Disabled)
        Fill: =RGBA(255, 255, 255, 1)
        Height: =Min(Self.AllItemsCount, 6) * Self.TemplateHeight + If(Self.DisplayMode.Edit, 10, 2)
        Items: |
            =If(CountRows(Sort(Filter(listDepartment, If(IsBlank(Input_Select_Divison.Text), true, Input_Select_Divison.Text in company_department) && company_department in recorDivision.division), company_department)) > 0, Sort(Filter(listDepartment, If(IsBlank(Input_Select_Divison.Text), true, Input_Select_Divison.Text in company_department) && company_department in recorDivision.division), company_department), [{code: "", company_department: "No item", company_name:"", company_permission_id: "", external: "", id: "", name: ""}])
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplatePadding: =0
        TemplateSize: =40
        Visible: =ShowDivisionSelectPopup && isShowCreateCRPopup && Self.AllItemsCount > 0
        Width: =CreateCREntity_InputBack_1.Width
        X: =CreateCREntity_InputBack_1.X
        Y: =Input_Select_Divison.Y + Input_Select_Divison.Height + 3
        ZIndex: =32

        Button6_39 As button:
            Align: =Align.Left
            BorderThickness: =0
            Color: =RGBA(82, 82, 82, 1)
            DisabledColor: =Self.Color
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =0
            Font: =Font.Arial
            FontWeight: =FontWeight.Normal
            HoverColor: =Self.Color
            HoverFill: =RGBA(241, 244, 249, 1)
            OnSelect: |-
                =Set(divisionSelectedValue, ThisItem);
                Set(ShowDivisionSelectPopup, false);
            PaddingLeft: =15
            PaddingRight: =0
            PaddingTop: =5.27
            PressedBorderColor: =Self.Color
            PressedColor: =Self.Color
            PressedFill: =
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Size: =10.5
            Text: =Substitute(ThisItem.company_department, Char(10), " ")
            Width: =Parent.Width
            X: =0.00
            ZIndex: =1

    GroupDeleteConfirm As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =33

        RejectPopupBack_12 As rectangle:
            Fill: =RGBA(0.3, 0.3, 0.3, 0.3)
            Height: =Parent.Height
            Visible: =isShowPopupDelete
            Width: =Parent.Width
            ZIndex: =6

        DeleteConfirmBg_9 As htmlViewer:
            Font: =Font.Arial
            Height: =If(Parent.Width > 600, 200, 200)
            HtmlText: |-
                ="<div style='margin-left: 8px; width: calc(100% - 16px); height: "& Self.Height - 20 &"px; background-color: white; border-radius: 12px;box-shadow: 5px 4px 8px 0px rgba(0, 0, 0, 0.10);
                '></div>"
            PaddingRight: =5.00
            PaddingTop: =5.00
            Size: =11.00
            Visible: =isShowPopupDelete
            Width: =If(App.Width > 600, 550, App.Width + 5)
            X: =If(App.Width > 600, App.Width * 0.5 - DeleteConfirmBg_9.Width *0.5, 0)
            Y: =App.Height / 2 - Self.Height
            ZIndex: =7

        CancelResearchOpinionButton_7 As button:
            BorderColor: =Self.Color
            BorderThickness: =1
            Color: =RGBA(214, 27, 27, 1)
            DisabledBorderColor: =RGBA(214, 27, 27, 1)
            DisabledColor: =RGBA(214, 27, 27, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =1
            Font: =Font.Arial
            Height: =44
            HoverColor: =globalVariables.button.redButtonHoverFill
            HoverFill: =ColorFade(Self.Fill , -15%)
            OnSelect: |-
                =Set(varEncryptionDeleteSelectedId, Blank());
                Set(isShowPopupDelete, false);
            PressedBorderColor: =RGBA(214, 27, 27, 1)
            PressedColor: =RGBA(214, 27, 27, 1)
            PressedFill: =
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Size: =10.5
            Text: ="Cancel"
            Visible: =isShowPopupDelete
            Width: =120
            X: =DeleteConfirmBg_9.X + DeleteConfirmBg_9.Width - 280
            Y: =DeleteConfirmBg_9.Y + DeleteConfirmBg_9.Height - 70
            ZIndex: =8

        DeleteResearchOpinionButton_7 As button:
            BorderThickness: =
            DisabledBorderColor: =RGBA(214, 27, 27, 1)
            DisabledColor: =RGBA(255, 255, 255, 1)
            DisabledFill: =RGBA(214, 27, 27, 1)
            Fill: =RGBA(214, 27, 27, 1)
            FocusedBorderThickness: =
            Font: =Font.Arial
            Height: =44
            HoverFill: =ColorFade(Self.Fill , -15%)
            OnSelect: |-
                =Set(isLoading, true);
                UpdateContext({ShowNotification: false});
                'TVS->Delete-Communication-Records-V1'.Run(resKeyOpenAll.open,
                        resKeyOpenAll.close,currenUserV2.id,recordDelete,envDEV, envTEST, envUAT1, envUAT2);
                //If(IsBlank(statusFilterVar),Set(statusFilterVar, ""),Set(statusFilterVar, StatusSelectedValue));
                
                // ClearCollect(colRecord,'TVS->FilterFindAllRecords'.Run(resKeyOpenAll.open,resKeyOpenAll.close,"","","",PageSizeNumberRecord,currentPageIndexRecord,env,TypeInformationNonList));
                
                Concurrent(
                ClearCollect(listDivisionFilterTemp, 'TVS->GetLookUpDivisionFilter'.Run(envDEV, envTEST, envUAT1, envUAT2)),
                If(TypeDivison <> "Research",
                    ClearCollect(colExternalRecord, 'TVS->FilterFindAllRecords_NoBoth-V3'.Run(
                        resKeyOpenAll.open, resKeyOpenAll.close,
                        Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                        Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                        If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                        PageSizeNumberRecord, 
                        currentPageIndexRecord, 
                        envDEV, envTEST, envUAT1, envUAT2,
                        currenUserV2.id,
                        currenUserV2.email,
                        isAllowTab, // isMyMeeting
                        If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id), //divison
                        isHeadDivision,
                        If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''")
                    )),
                    ClearCollect(colExternalRecord, If(isFullPermission, 
                    'TVS->FilterFindAllRecords_Both-V3'.Run(
                        resKeyOpenAll.open, resKeyOpenAll.close,
                        Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                        Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                        If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                        PageSizeNumberRecord, 
                        currentPageIndexRecord, 
                        envDEV, envTEST, envUAT1, envUAT2, 
                        currenUserV2.id, 
                        If(DealDetailTab = 1, true, false), //actionneed
                        If(DealDetailTab = 2, true, false), //inprocess
                        If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"),
                        currenUserV2.email, 
                        If(DealDetailTab = 3, true, false),
                        isAllowTab, // isMyMeeting
                        If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id)
                ), 
                    'TVS->FilterFindAllRecords-V3'.Run(
                        resKeyOpenAll.open, resKeyOpenAll.close,
                        Text(DateFrom_Datepicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                        Text(DateTo_DatePicker_7.SelectedDate, "yyyy-mm-dd hh:mm:ss"),
                        If(IsBlank(Search_Input_5.Text), "", Trim(Text(Search_Input_5.Text))),
                        PageSizeNumberRecord, 
                        currentPageIndexRecord, 
                        envDEV, envTEST, envUAT1, envUAT2, 
                        currenUserV2.id, 
                        If(DealDetailTab = 1, true, false), //actionneed
                        If(DealDetailTab = 2, true, false), //inprocess
                        If(Len(Concat(currentUserV2Res, "," & division_id)) > 0, Right(Concat(currentUserV2Res, "," & division_id), Len(Concat(currentUserV2Res, "," & division_id)) - 1), "''"), 
                        isHeadDivision,
                        currenUserV2.email, 
                        If(DealDetailTab = 3, true, false),
                        isAllowTab, // isMyMeeting
                        If(IsBlank(reportDivisionCRValue), "", reportDivisionCRValue.id) //divison
                    )
                ))
                ));
                Set(isShowPopupDelete, false);
                Set(isLoading, false);
                Set(NoticationText,"Delete successfully!");
                UpdateContext({ShowNotification: true});
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(214, 27, 27, 1)
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Size: =10.5
            Text: ="Yes"
            Visible: =isShowPopupDelete
            Width: =120
            X: =DeleteConfirmBg_9.X + DeleteConfirmBg_9.Width - 150
            Y: =DeleteConfirmBg_9.Y + DeleteConfirmBg_9.Height - 70
            ZIndex: =9

        DeleteConfirmCloseIcon_11 As icon.Cancel:
            Color: =RGBA(26, 26, 26, 1)
            Height: =20
            Icon: =Icon.Cancel
            OnSelect: |-
                =Set(varEncryptionDeleteSelectedId, Blank());
                Set(isShowPopupDelete, false);
            Visible: =isShowPopupDelete
            Width: =20
            X: =DeleteConfirmBg_9. X + DeleteConfirmBg_9.Width -50
            Y: =DeleteConfirmBg_9.Y + 20
            ZIndex: =10

        DeleteConfirmLabel_11 As label:
            Font: =Font.Arial
            Size: =12
            Text: ="Are you sure to delete this record?"
            Visible: =isShowPopupDelete
            Width: =DeleteConfirmBg_9.Width - 100 - DeleteConfirmCloseIcon_11.Width
            X: =Label2_7.X
            Y: =Label2_7.Y + Label2_7.Height
            ZIndex: =11

        Label2_7 As label:
            Font: =Font.Arial
            FontWeight: =FontWeight.Bold
            Size: =14
            Text: ="Delete"
            Visible: =isShowPopupDelete
            X: =DeleteConfirmBg_9.X + 30
            Y: =DeleteConfirmBg_9.Y + 10
            ZIndex: =12

    CreateCRPopupGroup As group:
        Height: =5
        Width: =5
        X: =80
        Y: =80
        ZIndex: =33

        CreateCRPopupBack As rectangle:
            Fill: =RGBA(0, 0, 0, 0.6)
            Height: =App.Height
            Visible: =isShowCreateCRPopup
            Width: =App.Width
            ZIndex: =13

        CreateCRPopupBg As htmlViewer:
            Font: =Font.Arial
            Height: =340
            HtmlText: |-
                ="<div style='height: "& Self.Height - 20 &"px; background-color: white; border-radius: 12px;box-shadow: 5px 4px 8px 0px rgba(0, 0, 0, 0.10);
                '></div>"
            PaddingRight: =5.00
            PaddingTop: =5.00
            Size: =11.00
            Visible: =isShowCreateCRPopup
            Width: =If(Parent.Width > 600, 600, Parent.Width - 20)
            X: =If(App.Width > 600, App.Width * 0.5 - Self.Width *0.5, 10)
            Y: =App.Height / 2 - Self.Height*0.5
            ZIndex: =14

        CreateCR_Title As label:
            Font: =Font.Arial
            FontWeight: =FontWeight.Bold
            Height: =43
            LineHeight: =2.2
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =12
            Text: ="Select your meeting category"
            Visible: =isShowCreateCRPopup
            Width: =299
            X: =CreateCRPopupBg.X + 30
            Y: =CreateCRPopupBg.Y + 10
            ZIndex: =15

        Label_Select_Divison As label:
            Font: =Font.Arial
            FontWeight: =FontWeight.Bold
            Height: =43
            LineHeight: =2.2
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10.5
            Text: ="Select Division"
            Visible: =isShowCreateCRPopup
            Width: =299
            X: =CreateCR_Title.X
            Y: =CreateCR_Title.Y + CreateCR_Title.Height
            ZIndex: =16

        Input_Select_Divison As text:
            BorderColor: =If(IsBlank(Self.Text) && isSubmitedPopup, RGBA(214, 27, 27, 1), If(ShowDivisionSelectPopup, RGBA(0, 18, 107, 1), RGBA(191, 191, 192, 1)))
            BorderThickness: =1
            Default: =divisionSelectedValue.company_department
            DisabledBorderColor: =Self.BorderColor
            FocusedBorderThickness: =1
            Font: =Font.Arial
            Height: =44
            HintText: =""
            HoverBorderColor: =Self.BorderColor
            HoverFill: =RGBA(186, 202, 226, 0)
            OnChange: =//Reset(Input_Select_Divison)
            OnSelect: |-
                =Set(divisionSelectedValue, {});
                Set(ShowDivisionSelectPopup, !ShowDivisionSelectPopup);
            PressedBorderColor: =Self.BorderColor
            Size: =If(App.Width > 800,10.5,12)
            Visible: =isShowCreateCRPopup
            Width: =CreateCRPopupBg.Width - 70
            X: =CreateCR_Title.X
            Y: =Label_Select_Divison.Y + Label_Select_Divison.Height
            ZIndex: =17

        CreateCRCreateButton As button:
            BorderThickness: =0
            Fill: =RGBA(17, 79, 144, 1)
            FocusedBorderThickness: =0
            Font: =Font.Arial
            FontWeight: =FontWeight.Normal
            Height: =44
            HoverFill: =ColorFade(Self.Fill , 5%)
            OnSelect: |-
                =Set(isSubmitedPopup, true);
                Clear(checkList);
                Set(divison_name_popup, Blank());
                Set(companny_name, Blank());
                Set(divison_name, Blank());
                UpdateContext({ShowNotification: false});
                If(
                    IsBlank(divisionSelectedValue.company_department), Set(IsError, true); Set(NoticationText,"Divison is required!"); UpdateContext({ShowNotification: true}),
                    IsBlank(Trim(CreateCREntity_InputBack_1.Text)), Set(IsError, true); Set(NoticationText,"Meeting category is required!"); UpdateContext({ShowNotification: true}),
                Set(isSubmitedPopup, false);
                Set(isLoading, true);
                Set(divison_name_popup, Input_Select_Divison.Text);
                Set(TypeInformationNonList, divisionSelectedValue.name);
                Set(companny_name, divisionSelectedValue.company_name);
                Set(divison_name, divisionSelectedValue.name);
                Set(DivisionSelected, divisionSelectedValue);
                Set(isShowCreateCRPopup, false);
                Set(TypeNature, meetingSelectedValue);
                
                Set(isLoading, false);
                Navigate(DetailCommunicationRecords);
                
                ClearCollect(ListPartyExternal, [
                    {markId: GUID(), party_name: "A", value: If(DivisionSelected.id = rsTVS.id, rsTVS.company_name & " - " & rsTVS.name, DivisionSelected.company_name & " - " & DivisionSelected.name), partyMembers: Filter(allEmployeesNoPaging, id = Blank()), files: []},
                {markId: GUID(), party_name: "B", value: "", partyMembers: Filter(allEmployeesNoPaging, id = Blank()), files: []}
                ]);
                
                ForAll(Filter(ListPartyExternal, party_name <> "A") As ThisItem,
                Collect(checkList, {markId: ThisItem.markId, stage: true}));
                
                Set(meeting1,divisionSelectedValue);
                
                Set(meetingTypeValue, Blank());
                Clear(attachments);
                ClearCollect(headerData, First(DataTableDetail).header);
                Clear(HasTags);
                Clear(ShareTo);
                Set(recordItemSelected, Blank());
                Set(childRecordSelected, Blank());
                Set(resExternal, Blank());
                Set(resInternal, Blank());
                Set(header, []);
                ClearCollect(invalidValue, []);
                ClearCollect(splitIssuerNotFirst, []);
                );
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedColor: =Self.Color 
            PressedFill: =Self.Fill
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Size: =10.5
            Text: ="Continue"
            Visible: =isShowCreateCRPopup
            Width: =120
            X: =Input_Select_Divison.X + Input_Select_Divison.Width - Self.Width
            Y: =CreateCRPopupBg.Y + CreateCRPopupBg.Height - 70
            ZIndex: =18

        CreateCRCancelButton As button:
            BorderThickness: =0
            DisabledFill: =Self.Fill
            Fill: =RGBA(214, 27, 27, 1)
            FocusedBorderThickness: =0
            Font: =Font.Arial
            FontWeight: =FontWeight.Normal
            Height: =44
            HoverFill: =ColorFade(Self.Fill , 5%)
            OnSelect: |-
                =Set(isShowCreateCRPopup, false);
                Set(isSubmitedPopup, false);
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedColor: =Self.Color 
            PressedFill: =Self.Fill
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Size: =10.5
            Text: ="Cancel"
            Visible: =isShowCreateCRPopup
            Width: =120
            X: =CreateCRCreateButton.X - 10 - Self.Width
            Y: =CreateCRPopupBg.Y + CreateCRPopupBg.Height - 70
            ZIndex: =19

        CreateCRPopupCloseIcon As icon.Cancel:
            Color: =RGBA(0, 0, 0, 1)
            Height: =20
            Icon: =Icon.Cancel
            OnSelect: |-
                =Set(isShowCreateCRPopup, false);
                Set(isSubmitedPopup, false);
            Visible: =isShowCreateCRPopup
            Width: =20
            X: =CreateCRPopupBg.X + CreateCRPopupBg.Width - Self.Width - 30
            Y: =CreateCR_Title.Y + 10
            ZIndex: =20

        CreateCREntity_Title_1 As label:
            Font: =Font.Arial
            FontWeight: =FontWeight.Bold
            Height: =43
            LineHeight: =2.2
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10.5
            Text: ="Meeting category"
            Visible: =isShowCreateCRPopup
            Width: =299
            X: =Input_Select_Divison.X
            Y: =Input_Select_Divison.Y + Input_Select_Divison.Height + 10
            ZIndex: =21

        Division_Chevron As htmlViewer:
            Font: =Font.Arial
            Height: =44
            HtmlText: |-
                ="<div style=""cursor: pointer""><svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"">
                <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M12.7069 15.7071C12.5193 15.8946 12.265 15.9999 11.9999 15.9999C11.7347 15.9999 11.4804 15.8946 11.2929 15.7071L5.63585 10.0501C5.54034 9.95785 5.46416 9.84751 5.41175 9.7255C5.35934 9.6035 5.33176 9.47228 5.3306 9.3395C5.32945 9.20672 5.35475 9.07504 5.40503 8.95215C5.45531 8.82925 5.52957 8.7176 5.62346 8.6237C5.71735 8.52981 5.829 8.45556 5.9519 8.40528C6.0748 8.355 6.20648 8.32969 6.33926 8.33085C6.47204 8.332 6.60325 8.35959 6.72526 8.412C6.84726 8.46441 6.95761 8.54059 7.04985 8.6361L11.9999 13.5861L16.9499 8.6361C17.1385 8.45394 17.3911 8.35315 17.6533 8.35542C17.9155 8.3577 18.1663 8.46287 18.3517 8.64828C18.5371 8.83369 18.6423 9.0845 18.6445 9.3467C18.6468 9.60889 18.546 9.8615 18.3639 10.0501L12.7069 15.7071Z"" fill=""#525252""/>
                </svg></div>"
            OnSelect: |-
                =Set(divisionSelectedValue, {});
                Set(ShowDivisionSelectPopup, !ShowDivisionSelectPopup);
            PaddingRight: =5.27
            PaddingTop: =5.27
            Size: =11.60
            Visible: =isShowCreateCRPopup
            Width: =35
            X: =Input_Select_Divison.X + Input_Select_Divison.Width - 40
            Y: =Input_Select_Divison.Y + 5
            ZIndex: =22


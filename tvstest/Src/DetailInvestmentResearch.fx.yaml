DetailInvestmentResearch As screen:
    Fill: =RGBA(248, 248, 249, 1)
    OnHidden: |-
        =Set(showRejectPopup, false);
        Set(showApprovePopup, false);
        Set(showRevisePopup, false);
        Set(showPublishPopup, false);
        Set(IsFromDetailInvesmentResearch, true)
    OnVisible: |-
        =If(IsBlank(currenUserV2),
            If(IsBlank(env), Set(env, "TEST");Set(envDEV, false);Set(envTEST, true);Set(envUAT1, false);Set(envUAT2, false););
            If(IsBlank(resKeyOpenAll),Set(resKeyOpenAll,'TVS->GetOpenAndCloseFinal-V1'.Run(envDEV,envTEST, envUAT1, envUAT2)));
            If(!IsBlank(resKeyOpenAll), ClearCollect(currentUserV2Res,'TVS->GetCurrentUser-V1'.Run(resKeyOpenAll.open, resKeyOpenAll.close, User().Email, envDEV,envTEST, envUAT1, envUAT2)));
            Clear(permissionLst);
            ForAll(currentUserV2Res,Collect(permissionLst,{
                process_code:ThisRecord.process_code,
                role:Distinct(Split(ThisRecord.role,"#"),Value),
                company:Distinct(Split(ThisRecord.company,"#"),Value),
                division:Distinct(Split(ThisRecord.division,"#"),Value),
                action:Distinct(Split(ThisRecord.action,"#"),Value),
                name_team:Distinct(Split(ThisRecord.name_team,"#"),Value)
            }));
            Set(currenUserV2,{
                id:First(currentUserV2Res).id,
                name:First(currentUserV2Res).name,
                email:First(currentUserV2Res).email,
                internal_email:First(currentUserV2Res).internal_email,
                phone_number:First(currentUserV2Res).phone_number,
                permissionList:permissionLst,
                status:First(currentUserV2Res).status
            });
        );
        // Go from Link but not have permission 
        If(!("VIEW" in LookUp(currenUserV2.permissionList, process_code = "Process1.3", action) && currenUserV2.status = "ACTIVE"), Select(Button2_2));
        
        //Header
        Set(MenuSelect,"Portal");
        Set(MenuSelect2,"Investment research");
        Set(HeaderText,
            If(IsError(investmentDetail) || IsBlank(investmentDetail),"Create",
                (investmentDetail.status="DRAFT"||investmentDetail.status = "REVISED") && "CREATE" in LookUp(currenUserV2.permissionList, process_code="Process1.3", action),
                "Update","View "
            )
        );
        
        // Setup
        UpdateContext({ShowNotification: false});
        Reset(Timer1_15);
        Reset(ReportAttachFile);
        Reset(OthersAttachFile);
        Set(isSubmited,false);
        Set(canEdit, true);
        Set(Language, If(IsBlank(investmentDetail) || IsBlank(investmentDetail.type), "En", investmentDetail.type));
        Set(isShowPreviewPopup, false);
        Set(investmentId, Blank());
        
        Set(frequencyShowDropdown, false);
        Set(reportTypeShowDropdown, false);
        Set(reportYearShowDropdown, false);
        Set(reportQuarterShowDropdown, false);
        Set(reportMonthShowDropdown, false);
        Set(reportWeekShowDropdown, false);
        Set(reportPrivacyShowDropdown, false);
        ClearCollect(listReportAttachDelete, []);
        ClearCollect(listReportAttachDeleteVn, []);
        ClearCollect(listOthersAttachDelete, []);
        ClearCollect(listOthersAttachDeleteVn, []);
        
        Set(isDisable,
            !(
                (IsBlank(investmentDetail) || (investmentDetail.status in ["DRAFT", "REVISED"] && investmentDetail.created_id = currenUserV2.id && "EDIT" in LookUp(currenUserV2.permissionList,process_code = "Process1.3",action))) ||
                (!IsBlank(investmentDetail) && investmentDetail.status in ["PENDING"] && "APPROVE" in LookUp(currenUserV2.permissionList, process_code = "Process1.3", action))
            )
        );
        
        // Setup date detail
        If(!IsBlank(investmentDetail),
            Set(frequencyValue, investmentDetail.frequency); // need to fill data from BE
            Set(reportTypeValue, investmentDetail.report_type);
            Set(reportWeekValue, investmentDetail.week_report);
            Set(reportQuarterValue, investmentDetail.quarterly_report);
            Set(reportMonthValue, investmentDetail.monthly_report);
            Set(reportYearValue, investmentDetail.annaul_report);
            Set(reportPrivacyValue, investmentDetail.allow_access);
            ,
            Reset(ReportName_Input);
            Reset(Note_Input);
            Reset(ReportName_Input_Vn);
            Reset(Note_Input_Vn);
            Clear(listReportAttachFile);
            Clear(listOthersAttachFile);
            Clear(listReportAttachFileVn);
            Clear(listOthersAttachFileVn);
            Set(frequencyValue, Blank());
            Set(reportTypeValue, Blank());
            Set(reportPrivacyValue, First(reportPrivacyArray).value);
            Set(reportWeekValue, Text(WeekNum(Today())));
            Set(reportQuarterValue, Text(RoundUp(Month(Today()) / 3, 0)));
            Set(reportMonthValue, Text(Month(Today())));
            Set(reportYearValue, Text(Year(Today())));
        );

    Canvas1_5 As fluidGrid.fluidGridWithBlankCard:
        BorderThickness: =0
        Height: =App.Height
        Width: =Parent.Width
        Y: =HeaderQT2List_2.Y + HeaderQT2List_2.Height
        ZIndex: =1

        DataCard1_5 As dataCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            BorderThickness: =0
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =WhiteBackground_6.Y + WhiteBackground_6.Height + 70
            Width: =Parent.Width
            X: =0.00
            Y: =0
            ZIndex: =1

            WhiteBackground_6 As htmlViewer:
                Font: =Font.Arial
                Height: =btnPreview.Y + btnPreview.Height
                HtmlText: |-
                    ="<div style='width: calc(100% - 10px); height: "& Self.Height - 20 &"px; background-color: white; border-radius: 12px;box-shadow: 5px 4px 8px 0px rgba(0, 0, 0, 0.10);
                    '></div>"
                PaddingRight: =5.00
                PaddingTop: =5.00
                Size: =11.00
                Width: =If(Parent.Width > 800, Parent.Width - If(MobileShowMenu, 285, 100), Parent.Width + 10)
                X: =If(Parent.Width > 800, If(MobileShowMenu, 270, 75), 0)
                Y: =66
                ZIndex: =1

            PreviewButtonGroup As group:
                Height: =5
                Width: =5
                X: =60
                Y: =60
                ZIndex: =47

                btnPreview As button:
                    BorderColor: =Self.Fill
                    BorderThickness: =0
                    DisabledFill: =Self.Fill
                    Fill: =RGBA(17, 79, 144, 1)
                    FocusedBorderThickness: =0
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Normal
                    HoverColor: =Self.Color
                    HoverFill: =Self.Fill
                    OnSelect: =Set(isShowPreviewPopup, true);
                    PaddingLeft: =30
                    PressedColor: =Self.Color
                    PressedFill: =Self.Fill
                    RadiusBottomLeft: =8
                    RadiusBottomRight: =8
                    RadiusTopLeft: =8
                    RadiusTopRight: =8
                    Size: =10.5
                    Text: = If(Language = "Vn", "Xem trước", "Preview")
                    Visible: =canEdit
                    Width: =110
                    X: =ReportAttachment_Label.X + 5
                    Y: |-
                        =If(Language = "Vn",
                        Max(OthersFileList_Vn.Y + OthersFileList_Vn.Height, ReportFileList_Vn.Y + ReportFileList_Vn.Height) + 10,
                        Max(OthersFileList.Y + OthersFileList.Height, ReportFileList.Y + ReportFileList.Height) + 10)
                    ZIndex: =38

                btnPreviewIcon As htmlViewer:
                    Font: =Font.Arial
                    HtmlText: |-
                        ="<div style=""width: 40px; height: 38px; display: flex; justify-content: center; align-items: center; cursor: pointer""><svg xmlns=""http://www.w3.org/2000/svg"" width=""25"" height=""24"" viewBox=""0 0 25 24"" fill=""none"">
                          <path d=""M5 2.25V21.75H20V7.2L19.775 6.975L15.275 2.475L15.05 2.25H5ZM6.5 3.75H14V8.25H18.5V20.25H6.5V3.75ZM15.5 4.8L17.45 6.75H15.5V4.8ZM12.5 9.75L9.5 12.75H11.75V16.5H13.25V12.75H15.5L12.5 9.75ZM9.5 17.25V18.75H15.5V17.25H9.5Z"" fill=""#FEFEFE""/>
                        </svg></div>"
                    OnSelect: =Set(isShowPreviewPopup, true);
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Visible: =canEdit
                    Width: =40
                    X: =btnPreview.X
                    Y: =btnPreview.Y
                    ZIndex: =39

            IRAttachmentGroup As group:
                Height: =5
                Width: =5
                X: =60
                Y: =60
                ZIndex: =53

                ReportAttachment_Label As label:
                    Color: =RGBA(14, 63, 115, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Semibold
                    Height: =42
                    Size: =12
                    Text: =If(Language = "Vn", "Files báo cáo", "Report")
                    X: =Note_Input.X
                    Y: =Note_Input.Y + Note_Input.Height + 30
                    ZIndex: =48

                OthersAttachment_Label As label:
                    Color: =RGBA(14, 63, 115, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Semibold
                    Height: =42
                    Size: =12
                    Text: =If(Language = "Vn", "Files khác", "Others")
                    Width: =120
                    X: =If(App.Width > 800, ReportAttachFile.X + ReportAttachFile.Width, ReportAttachFile.X)
                    Y: =If(App.Width > 800, Note_Input.Y + Note_Input.Height + 30, If(Language = "Vn", ReportFileList_Vn.Y + ReportFileList_Vn.Height, ReportFileList.Y + ReportFileList.Height))
                    ZIndex: =49

                ReportAttachFile As attachments:
                    AddAttachmentText: =If(Language = "Vn", "Nhấn để chọn file ", "Click here to attach file")
                    BorderColor: =
                    BorderThickness: =0
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    DropTargetBorderThickness: =0
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderThickness: =0
                    Font: =Font.Arial
                    Height: =If(isDisable, 0, 75 + Max(If(CountRows(Self.Attachments) = 1, 0, CountRows(Self.Attachments) * 15)))
                    IsInDataCard: =true
                    Items: =
                    MaxAttachments: =99
                    MaxAttachmentSize: =maxSizeFile
                    MaxAttachmentsText: =If(Language = "Vn", "Vượt quá số lượng file cho phép", "Max. number files reached.")
                    NoAttachmentsText: =If(CountRows(Filter(listReportAttachFile, !IsDeleted)) = 0, If(Language = "Vn", "Chưa có file nào được chọn", "There is nothing attached."))
                    OnAddFile: |-
                        =UpdateContext(
                           {
                              varJSON: 
                              JSON(
                                 Image2.Image,
                                 JSONFormat.IncludeBinaryData
                              )
                           }
                        )
                    OnRemoveFile: |-
                        =UpdateContext(
                           {
                              varJSON: 
                             Blank()
                           }
                        )
                    OnUndoRemoveFile: =Set(varJSON,"")
                    PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                    PaddingRight: =5
                    Size: =10.5
                    Tooltip: =
                    Visible: =Language <> "Vn"
                    Width: =If(App.Width > 800, (WhiteBackground_6.Width - 60) / 2 - 10, Note_Input.Width)
                    X: =Note_Input.X
                    Y: =ReportAttachment_Label.Y + ReportAttachment_Label.Height - If(CountRows(Filter(listReportAttachFile, !IsDeleted)) > 0 && CountRows(Self.Attachments) = 0, 35, 0)
                    ZIndex: =50

                OthersAttachFile As attachments:
                    AddAttachmentText: =If(Language = "Vn", "Nhấn để chọn file ", "Click here to attach file")
                    BorderColor: =
                    BorderThickness: =0
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    DropTargetBorderThickness: =0
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderThickness: =0
                    Font: =Font.Arial
                    Height: =If(isDisable, 0, 75 + Max(If(CountRows(Self.Attachments) = 1, 0, CountRows(Self.Attachments) * 15)))
                    IsInDataCard: =true
                    Items: =
                    MaxAttachments: =99
                    MaxAttachmentSize: =maxSizeFile
                    MaxAttachmentsText: =If(Language = "Vn", "Vượt quá số lượng file cho phép", "Max. number files reached.")
                    NoAttachmentsText: =If(CountRows(Filter(listOthersAttachFile, !IsDeleted)) = 0, If(Language = "Vn", "Chưa có file nào được chọn", "There is nothing attached."))
                    OnAddFile: |-
                        =UpdateContext(
                           {
                              varJSON: 
                              JSON(
                                 Image2.Image,
                                 JSONFormat.IncludeBinaryData
                              )
                           }
                        )
                    OnRemoveFile: |-
                        =UpdateContext(
                           {
                              varJSON: 
                             Blank()
                           }
                        )
                    OnUndoRemoveFile: =Set(varJSON,"")
                    PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                    PaddingRight: =5
                    Size: =10.5
                    Tooltip: =
                    Visible: =Language <> "Vn"
                    Width: =If(App.Width > 800, (WhiteBackground_6.Width - 60) / 2 - 10, Note_Input.Width)
                    X: =OthersAttachment_Label.X
                    Y: =OthersAttachment_Label.Y + OthersAttachment_Label.Height - If(CountRows(Filter(listOthersAttachFile, !IsDeleted)) > 0 && CountRows(Self.Attachments) = 0, 35, 0)
                    ZIndex: =51

                ReportAttachFile_Vn As attachments:
                    AddAttachmentText: =If(Language = "Vn", "Nhấn để chọn file ", "Click here to attach file")
                    BorderColor: =
                    BorderThickness: =0
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    DropTargetBorderThickness: =0
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderThickness: =0
                    Font: =Font.Arial
                    Height: =If(isDisable, 0, 75 + Max(If(CountRows(Self.Attachments) = 1, 0, CountRows(Self.Attachments) * 15)))
                    IsInDataCard: =true
                    Items: =
                    MaxAttachments: =99
                    MaxAttachmentSize: =maxSizeFile
                    MaxAttachmentsText: =If(Language = "Vn", "Vượt quá số lượng file cho phép", "Max. number files reached.")
                    NoAttachmentsText: =If(CountRows(Filter(listReportAttachFileVn, !IsDeleted)) = 0, If(Language = "Vn", "Chưa có file nào được chọn", "There is nothing attached."))
                    OnAddFile: |-
                        =UpdateContext(
                           {
                              varJSON: 
                              JSON(
                                 Image2.Image,
                                 JSONFormat.IncludeBinaryData
                              )
                           }
                        )
                    OnRemoveFile: |-
                        =UpdateContext(
                           {
                              varJSON: 
                             Blank()
                           }
                        )
                    OnUndoRemoveFile: =Set(varJSON,"")
                    PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                    PaddingRight: =5
                    Size: =10.5
                    Tooltip: =
                    Visible: =Language = "Vn"
                    Width: =If(App.Width > 800, (WhiteBackground_6.Width - 60) / 2 - 10, Note_Input.Width)
                    X: =Note_Input.X
                    Y: =ReportAttachment_Label.Y + ReportAttachment_Label.Height - If(CountRows(Filter(listReportAttachFileVn, !IsDeleted)) > 0 && CountRows(Self.Attachments) = 0, 35, 0)
                    ZIndex: =52

                OthersAttachFile_Vn As attachments:
                    AddAttachmentText: =If(Language = "Vn", "Nhấn để chọn file ", "Click here to attach file")
                    BorderColor: =
                    BorderThickness: =0
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    DropTargetBorderThickness: =0
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderThickness: =0
                    Font: =Font.Arial
                    Height: =If(isDisable, 0, 75 + Max(If(CountRows(Self.Attachments) = 1, 0, CountRows(Self.Attachments) * 15)))
                    IsInDataCard: =true
                    Items: =
                    MaxAttachments: =99
                    MaxAttachmentSize: =maxSizeFile
                    MaxAttachmentsText: =If(Language = "Vn", "Vượt quá số lượng file cho phép", "Max. number files reached.")
                    NoAttachmentsText: =If(CountRows(Filter(listOthersAttachFileVn, !IsDeleted)) = 0, If(Language = "Vn", "Chưa có file nào được chọn", "There is nothing attached."))
                    OnAddFile: |-
                        =UpdateContext(
                           {
                              varJSON: 
                              JSON(
                                 Image2.Image,
                                 JSONFormat.IncludeBinaryData
                              )
                           }
                        )
                    OnRemoveFile: |-
                        =UpdateContext(
                           {
                              varJSON: 
                             Blank()
                           }
                        )
                    OnUndoRemoveFile: =Set(varJSON,"")
                    PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                    PaddingRight: =5
                    Size: =10.5
                    Tooltip: =
                    Visible: =Language = "Vn"
                    Width: =If(App.Width > 800, (WhiteBackground_6.Width - 60) / 2 - 10, Note_Input.Width)
                    X: =OthersAttachment_Label.X
                    Y: =OthersAttachment_Label.Y + OthersAttachment_Label.Height - If(CountRows(Filter(listOthersAttachFileVn, !IsDeleted)) > 0 && CountRows(Self.Attachments) = 0, 35, 0)
                    ZIndex: =53

                "ReportFileList As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    DelayItemLoading: =true
                    Height: =Self.AllItemsCount * Self.TemplateHeight
                    Items: =Filter(listReportAttachFile, !IsDeleted)
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =40
                    Visible: =Language <> "Vn"
                    Width: =ReportAttachFile.Width
                    X: =ReportAttachFile.X
                    Y: =ReportAttachFile.Y + ReportAttachFile.Height + If(ReportAttachFile.Height = 0, 35, 0)
                    ZIndex: =54

                    Button1_2 As button:
                        Align: =Align.Left
                        BorderThickness: =0
                        Color: =RGBA(0, 0, 0, 1)
                        DisabledColor: =RGBA(202, 202, 202, 1)
                        DisabledFill: =RGBA(244, 244, 244, 0)
                        DisplayMode: =If("DOWNLOADFILE" in LookUp(currenUserV2.permissionList, process_code = "Process1.3", action), DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Normal
                        HoverColor: =RGBA(56, 96, 178, 1)
                        HoverFill: =
                        OnSelect: |-
                            =Set(urlRS,'TVS->DownloadFileExpTime-V1'.Run(bucketRSAttach,ThisItem.file_name).url);
                            Launch(urlRS);
                        PaddingLeft: =2
                        PressedColor: =Self.Color
                        PressedFill: =
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =10.5
                        Text: =If(Len(ThisItem.file_name) < If(App.Width > 800, 150, 60), ThisItem.file_name, Left(ThisItem.file_name, If(App.Width > 800, 150, 60)) & "...")
                        Width: =Parent.Width - 65
                        X: =30
                        ZIndex: =2

                    HtmlText7_3 As htmlViewer:
                        Font: =Font.Arial
                        HtmlText: |-
                            ="<svg xmlns=""http://www.w3.org/2000/svg"" width=""16"" height=""20"" viewBox=""0 0 16 20"" fill=""none"">
                              <path d=""M10.7503 2.66732H2.50033V17.334H13.5003V5.41732H10.7503V2.66732ZM2.50033 0.833984H11.667L15.3337 4.50065V17.334C15.3337 17.8202 15.1405 18.2865 14.7967 18.6303C14.4529 18.9742 13.9866 19.1673 13.5003 19.1673H2.50033C2.0141 19.1673 1.54778 18.9742 1.20396 18.6303C0.860146 18.2865 0.666992 17.8202 0.666992 17.334V2.66732C0.666992 2.18109 0.860146 1.71477 1.20396 1.37096C1.54778 1.02714 2.0141 0.833984 2.50033 0.833984ZM4.33366 9.08398H11.667V10.9173H4.33366V9.08398ZM4.33366 12.7507H11.667V14.584H4.33366V12.7507Z"" fill=""#114F90""/>
                            </svg>"
                        OnSelect: |-
                            =// Patch(listReportAttachFile, ThisItem, {IsDeleted: true});
                            // If(!IsBlank(ThisItem.Id),Collect(listReportAttachDelete,ThisItem))
                        PaddingBottom: =0
                        PaddingRight: =0
                        PaddingTop: =10
                        Width: =30
                        ZIndex: =3

                    RemoveIConReportEN As icon.Cancel:
                        Color: =RGBA(0, 0, 0, 1)
                        FocusedBorderThickness: =3
                        Height: =18
                        Icon: =Icon.Cancel
                        OnSelect: |-
                            =UpdateIf(listReportAttachFile, file_name = ThisItem.file_name, {IsDeleted: true});
                        Visible: =!isDisable && !IsBlank(ThisItem.id)
                        Width: =18
                        X: =Parent.Width - If(App.Width > 800, 33, 30)
                        Y: =If(App.Width > 600, 11, 11)
                        ZIndex: =4

                "OthersFileList As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    DelayItemLoading: =true
                    Height: =Self.AllItemsCount * Self.TemplateHeight
                    Items: =Filter(listOthersAttachFile, !IsDeleted)
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =40
                    Visible: =Language <> "Vn"
                    Width: =OthersAttachFile.Width
                    X: =OthersAttachFile.X
                    Y: =OthersAttachFile.Y + OthersAttachFile.Height + If(OthersAttachFile.Height = 0, 35, 0)
                    ZIndex: =55

                    Button1_6 As button:
                        Align: =Align.Left
                        BorderThickness: =0
                        Color: =RGBA(0, 0, 0, 1)
                        DisabledColor: =RGBA(202, 202, 202, 1)
                        DisabledFill: =RGBA(244, 244, 244, 0)
                        DisplayMode: =If("DOWNLOADFILE" in LookUp(currenUserV2.permissionList, process_code = "Process1.3", action), DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Normal
                        HoverColor: =RGBA(56, 96, 178, 1)
                        HoverFill: =
                        OnSelect: |-
                            =Set(urlRS,'TVS->DownloadFileExpTime-V1'.Run(bucketRSAttach,ThisItem.file_name).url);
                            Launch(urlRS);
                        PaddingLeft: =2
                        PressedColor: =Self.Color
                        PressedFill: =
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =10.5
                        Text: =If(Len(ThisItem.file_name) < If(App.Width > 800, 150, 60), ThisItem.file_name, Left(ThisItem.file_name, If(App.Width > 800, 150, 60)) & "...")
                        Width: =Parent.Width - 65
                        X: =30
                        ZIndex: =2

                    HtmlText7_4 As htmlViewer:
                        Font: =Font.Arial
                        HtmlText: |-
                            ="<svg xmlns=""http://www.w3.org/2000/svg"" width=""16"" height=""20"" viewBox=""0 0 16 20"" fill=""none"">
                              <path d=""M10.7503 2.66732H2.50033V17.334H13.5003V5.41732H10.7503V2.66732ZM2.50033 0.833984H11.667L15.3337 4.50065V17.334C15.3337 17.8202 15.1405 18.2865 14.7967 18.6303C14.4529 18.9742 13.9866 19.1673 13.5003 19.1673H2.50033C2.0141 19.1673 1.54778 18.9742 1.20396 18.6303C0.860146 18.2865 0.666992 17.8202 0.666992 17.334V2.66732C0.666992 2.18109 0.860146 1.71477 1.20396 1.37096C1.54778 1.02714 2.0141 0.833984 2.50033 0.833984ZM4.33366 9.08398H11.667V10.9173H4.33366V9.08398ZM4.33366 12.7507H11.667V14.584H4.33366V12.7507Z"" fill=""#114F90""/>
                            </svg>"
                        OnSelect: |-
                            =// Patch(listOthersAttachFile, ThisItem, {IsDeleted: true});
                            // If(!IsBlank(ThisItem.Id),Collect(listOthersAttachDelete,ThisItem));
                        PaddingBottom: =0
                        PaddingRight: =0
                        PaddingTop: =10
                        Width: =30
                        ZIndex: =3

                    RemoveIConOthersEN As icon.Cancel:
                        Color: =RGBA(0, 0, 0, 1)
                        FocusedBorderThickness: =3
                        Height: =18
                        Icon: =Icon.Cancel
                        OnSelect: |-
                            =UpdateIf(listOthersAttachFile, file_name = ThisItem.file_name, {IsDeleted: true});
                        Visible: =!isDisable && !IsBlank(ThisItem.id)
                        Width: =18
                        X: =Parent.Width - If(App.Width > 800, 33, 30)
                        Y: =If(App.Width > 600, 11, 11)
                        ZIndex: =4

                "ReportFileList_Vn As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    DelayItemLoading: =true
                    Height: =Self.AllItemsCount * Self.TemplateHeight
                    Items: =Filter(listReportAttachFileVn, !IsDeleted)
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =40
                    Visible: =Language = "Vn"
                    Width: =ReportAttachFile.Width
                    X: =ReportAttachFile.X
                    Y: =ReportAttachFile_Vn.Y + ReportAttachFile_Vn.Height + If(ReportAttachFile_Vn.Height = 0, 35, 0)
                    ZIndex: =56

                    Button1_7 As button:
                        Align: =Align.Left
                        BorderThickness: =0
                        Color: =RGBA(0, 0, 0, 1)
                        DisabledColor: =RGBA(202, 202, 202, 1)
                        DisabledFill: =RGBA(244, 244, 244, 0)
                        DisplayMode: =If("DOWNLOADFILE" in LookUp(currenUserV2.permissionList, process_code = "Process1.3", action), DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Normal
                        HoverColor: =RGBA(56, 96, 178, 1)
                        HoverFill: =
                        OnSelect: |-
                            =Set(urlRS,'TVS->DownloadFileExpTime-V1'.Run(bucketRSAttach,ThisItem.file_name).url);
                            Launch(urlRS);
                        PaddingLeft: =2
                        PressedColor: =Self.Color
                        PressedFill: =
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =10.5
                        Text: =If(Len(ThisItem.file_name) < If(App.Width > 800, 150, 60), ThisItem.file_name, Left(ThisItem.file_name, If(App.Width > 800, 150, 60)) & "...")
                        Width: =Parent.Width - 65
                        X: =30
                        ZIndex: =2

                    HtmlText7_6 As htmlViewer:
                        Font: =Font.Arial
                        HtmlText: |-
                            ="<svg xmlns=""http://www.w3.org/2000/svg"" width=""16"" height=""20"" viewBox=""0 0 16 20"" fill=""none"">
                              <path d=""M10.7503 2.66732H2.50033V17.334H13.5003V5.41732H10.7503V2.66732ZM2.50033 0.833984H11.667L15.3337 4.50065V17.334C15.3337 17.8202 15.1405 18.2865 14.7967 18.6303C14.4529 18.9742 13.9866 19.1673 13.5003 19.1673H2.50033C2.0141 19.1673 1.54778 18.9742 1.20396 18.6303C0.860146 18.2865 0.666992 17.8202 0.666992 17.334V2.66732C0.666992 2.18109 0.860146 1.71477 1.20396 1.37096C1.54778 1.02714 2.0141 0.833984 2.50033 0.833984ZM4.33366 9.08398H11.667V10.9173H4.33366V9.08398ZM4.33366 12.7507H11.667V14.584H4.33366V12.7507Z"" fill=""#114F90""/>
                            </svg>"
                        OnSelect: |-
                            =//Patch(listReportAttachFile, ThisItem, {IsDeleted: true});
                            //If(!IsBlank(ThisItem.Id),Collect(listReportAttachDelete,ThisItem))
                        PaddingBottom: =0
                        PaddingRight: =0
                        PaddingTop: =10
                        Width: =30
                        ZIndex: =3

                    RemoveIConReport_VN As icon.Cancel:
                        Color: =RGBA(0, 0, 0, 1)
                        FocusedBorderThickness: =3
                        Height: =18
                        Icon: =Icon.Cancel
                        OnSelect: |-
                            =UpdateIf(listReportAttachFileVn, file_name = ThisItem.file_name, {IsDeleted: true});
                        Visible: =!isDisable && !IsBlank(ThisItem.id)
                        Width: =18
                        X: =Parent.Width - If(App.Width > 800, 33, 30)
                        Y: =If(App.Width > 600, 11, 11)
                        ZIndex: =4

                "OthersFileList_Vn As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    DelayItemLoading: =true
                    Height: =Self.AllItemsCount * Self.TemplateHeight
                    Items: =Filter(listOthersAttachFileVn, !IsDeleted)
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =40
                    Visible: =Language = "Vn"
                    Width: =OthersAttachFile.Width
                    X: =OthersAttachFile.X
                    Y: =OthersAttachFile_Vn.Y + OthersAttachFile_Vn.Height + If(OthersAttachFile_Vn.Height = 0, 35, 0)
                    ZIndex: =57

                    Button1_8 As button:
                        Align: =Align.Left
                        BorderThickness: =0
                        Color: =RGBA(0, 0, 0, 1)
                        DisabledColor: =RGBA(202, 202, 202, 1)
                        DisabledFill: =RGBA(244, 244, 244, 0)
                        DisplayMode: =If("DOWNLOADFILE" in LookUp(currenUserV2.permissionList, process_code = "Process1.3", action), DisplayMode.Edit, DisplayMode.Disabled)
                        Fill: =RGBA(0, 0, 0, 0)
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Normal
                        HoverColor: =RGBA(56, 96, 178, 1)
                        HoverFill: =
                        OnSelect: |-
                            =Set(urlRS,'TVS->DownloadFileExpTime-V1'.Run(bucketRSAttach,ThisItem.file_name).url);
                            Launch(urlRS);
                        PaddingLeft: =2
                        PressedColor: =Self.Color
                        PressedFill: =
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =10.5
                        Text: =If(Len(ThisItem.file_name) < If(App.Width > 800, 150, 60), ThisItem.file_name, Left(ThisItem.file_name, If(App.Width > 800, 150, 60)) & "...")
                        Width: =Parent.Width - 65
                        X: =30
                        ZIndex: =2

                    HtmlText7_7 As htmlViewer:
                        Font: =Font.Arial
                        HtmlText: |-
                            ="<svg xmlns=""http://www.w3.org/2000/svg"" width=""16"" height=""20"" viewBox=""0 0 16 20"" fill=""none"">
                              <path d=""M10.7503 2.66732H2.50033V17.334H13.5003V5.41732H10.7503V2.66732ZM2.50033 0.833984H11.667L15.3337 4.50065V17.334C15.3337 17.8202 15.1405 18.2865 14.7967 18.6303C14.4529 18.9742 13.9866 19.1673 13.5003 19.1673H2.50033C2.0141 19.1673 1.54778 18.9742 1.20396 18.6303C0.860146 18.2865 0.666992 17.8202 0.666992 17.334V2.66732C0.666992 2.18109 0.860146 1.71477 1.20396 1.37096C1.54778 1.02714 2.0141 0.833984 2.50033 0.833984ZM4.33366 9.08398H11.667V10.9173H4.33366V9.08398ZM4.33366 12.7507H11.667V14.584H4.33366V12.7507Z"" fill=""#114F90""/>
                            </svg>"
                        OnSelect: |-
                            =//Patch(listOthersAttachFile, ThisItem, {IsDeleted: true});
                            //If(!IsBlank(ThisItem.Id),Collect(listOthersAttachDelete,ThisItem));
                        PaddingBottom: =0
                        PaddingRight: =0
                        PaddingTop: =10
                        Width: =30
                        ZIndex: =3

                    RemoveIConReport_VN_1 As icon.Cancel:
                        Color: =RGBA(0, 0, 0, 1)
                        FocusedBorderThickness: =3
                        Height: =18
                        Icon: =Icon.Cancel
                        OnSelect: |-
                            =UpdateIf(listOthersAttachFileVn, file_name = ThisItem.file_name, {IsDeleted: true});
                        Visible: =!isDisable && !IsBlank(ThisItem.id)
                        Width: =18
                        X: =Parent.Width - If(App.Width > 800, 33, 30)
                        Y: =If(App.Width > 600, 11, 11)
                        ZIndex: =4

            OnlyShowInMobile As group:
                Height: =5
                Width: =5
                X: =60
                Y: =60
                ZIndex: =58

                ReportName_InputMobile As label:
                    Color: =RGBA(166, 166, 166, 1)
                    Font: =Font.Arial
                    Height: =ReportName_Input.Height
                    PaddingLeft: =input_issuerName.PaddingLeft
                    PaddingTop: =input_issuerName.PaddingTop
                    Size: =input_issuerName.Size
                    Text: =ReportName_Input.Text
                    VerticalAlign: =VerticalAlign.Top
                    Visible: =isDisable && App.Width < 600 && ReportName_Input.Visible
                    Width: =ReportName_Input.Width
                    X: =ReportName_Input.X
                    Y: =ReportName_Input.Y
                    ZIndex: =58

                ReportName_Input_VnMobile As label:
                    Color: =RGBA(166, 166, 166, 1)
                    Font: =Font.Arial
                    Height: =ReportName_Input.Height
                    PaddingLeft: =input_issuerName.PaddingLeft
                    PaddingTop: =input_issuerName.PaddingTop
                    Size: =input_issuerName.Size
                    Text: =ReportName_Input_Vn.Text
                    VerticalAlign: =VerticalAlign.Top
                    Visible: =isDisable && App.Width < 600 && ReportName_Input_Vn.Visible
                    Width: =ReportName_Input.Width
                    X: =ReportName_Input.X
                    Y: =ReportName_Input.Y
                    ZIndex: =59

                Note_InputMobile As label:
                    Color: =RGBA(166, 166, 166, 1)
                    Font: =Font.Arial
                    Height: =Note_Input.Height
                    Overflow: =Overflow.Scroll
                    PaddingLeft: =Note_Input.PaddingLeft
                    PaddingTop: =Note_Input.PaddingTop
                    Size: =input_issuerName.Size
                    Text: =Note_Input.Text
                    VerticalAlign: =VerticalAlign.Top
                    Visible: =isDisable && App.Width < 600 && Note_Input.Visible
                    Width: =Note_Input.Width
                    X: =Note_Input.X
                    Y: =Note_Input.Y
                    ZIndex: =60

                Note_Input_VnMobile As label:
                    Color: =RGBA(166, 166, 166, 1)
                    Font: =Font.Arial
                    Height: =Note_Input.Height
                    Overflow: =Overflow.Scroll
                    PaddingLeft: =Note_Input.PaddingLeft
                    PaddingTop: =Note_Input.PaddingTop
                    Size: =input_issuerName.Size
                    Text: =Note_Input_Vn.Text
                    VerticalAlign: =VerticalAlign.Top
                    Visible: =isDisable && App.Width < 600 && Note_Input_Vn.Visible
                    Width: =Note_Input.Width
                    X: =Note_Input.X
                    Y: =Note_Input.Y
                    ZIndex: =61

                Date_Input_Mobile As label:
                    Color: =RGBA(166, 166, 166, 1)
                    Font: =Font.Arial
                    Height: =Date_Datepicker.Height
                    PaddingLeft: =Date_Datepicker.PaddingLeft
                    PaddingTop: =Date_Datepicker.PaddingTop
                    Size: =input_issuerName.Size
                    Text: =Text(Date_Datepicker.SelectedDate, "dd/mm/yyyy")
                    VerticalAlign: =VerticalAlign.Top
                    Visible: =isDisable && App.Width < 600
                    Width: =Date_Datepicker.Width
                    X: =Date_Datepicker.X
                    Y: =Date_Datepicker.Y
                    ZIndex: =62

            IRDropdownGroup As group:
                Height: =5
                Width: =5
                X: =60
                Y: =60
                ZIndex: =62

                SearchCloseDropdown_5 As rectangle:
                    Fill: =RGBA(255, 255, 255, 0)
                    Height: =App.Height
                    OnSelect: |-
                        =Set(reportTypeShowDropdown, false);
                        Set(reportYearShowDropdown, false);
                        Set(reportQuarterShowDropdown, false);
                        Set(reportMonthShowDropdown, false);
                        Set(reportWeekShowDropdown, false);
                        Set(reportPrivacyShowDropdown, false);
                        Set(frequencyShowDropdown, false);
                    Visible: =reportTypeShowDropdown || reportYearShowDropdown || reportQuarterShowDropdown || reportMonthShowDropdown || reportWeekShowDropdown || reportPrivacyShowDropdown || frequencyShowDropdown
                    Width: =Parent.Width
                    ZIndex: =40

                "FrequencyItems As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    BorderColor: =RGBA(191, 191, 192, 1)
                    BorderThickness: =0.5
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =Min(Self.AllItemsCount, 4) * Self.TemplateHeight + 10
                    Items: =frequencyArray
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =40
                    Visible: =frequencyShowDropdown
                    Width: =FrequencyDropdown.Width
                    X: =FrequencyDropdown.X
                    Y: =FrequencyDropdown.Y + 50
                    ZIndex: =41

                    Button6_68 As button:
                        Align: =Align.Left
                        BorderThickness: =0
                        Color: =RGBA(82, 82, 82, 1)
                        Fill: =If(reportTypeValue = ThisItem.value, RGBA(241, 244, 249, 1), RGBA(0, 0, 0, 0))
                        FocusedBorderThickness: =0
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Normal
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(241, 244, 249, 1)
                        OnSelect: |-
                            =Set(frequencyValue, ThisItem.value);
                            Set(frequencyShowDropdown, false);
                        PaddingLeft: =15
                        PaddingRight: =5.27
                        PaddingTop: =5.27
                        PressedColor: =Self.Color
                        PressedFill: =
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =10.5
                        Text: =If(Language = "Vn", ThisItem.vn, ThisItem.en)
                        Width: =Parent.Width
                        X: =0.00
                        ZIndex: =1

                "ReportTypeItems_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    BorderColor: =RGBA(191, 191, 192, 1)
                    BorderThickness: =0.5
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =Min(Self.AllItemsCount, 4) * Self.TemplateHeight + 10
                    Items: =reportTypeArray
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =40
                    Visible: =reportTypeShowDropdown
                    Width: =ReportTypeDropdown_1.Width
                    X: =ReportTypeDropdown_1.X
                    Y: =ReportTypeDropdown_1.Y + 50
                    ZIndex: =42

                    Button6_20 As button:
                        Align: =Align.Left
                        BorderThickness: =0
                        Color: =RGBA(82, 82, 82, 1)
                        Fill: =If(reportTypeValue = ThisItem.value, RGBA(241, 244, 249, 1), RGBA(0, 0, 0, 0))
                        FocusedBorderThickness: =0
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Normal
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(241, 244, 249, 1)
                        OnSelect: |-
                            =Set(reportTypeValue, ThisItem.value);
                            Set(reportTypeShowDropdown, false);
                        PaddingLeft: =15
                        PaddingRight: =5.27
                        PaddingTop: =5.27
                        PressedColor: =Self.Color
                        PressedFill: =
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =10.5
                        Text: =If(Language = "Vn", ThisItem.vn, ThisItem.en)
                        Width: =Parent.Width
                        X: =0.00
                        ZIndex: =1

                "PrivacyItems As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    BorderColor: =RGBA(191, 191, 192, 1)
                    BorderThickness: =0.5
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =Min(Self.AllItemsCount, 4) * Self.TemplateHeight + 10
                    Items: =reportPrivacyArray
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =40
                    Visible: =reportPrivacyShowDropdown
                    Width: =PrivacyDropdown.Width
                    X: =PrivacyDropdown.X
                    Y: =PrivacyDropdown.Y + 50
                    ZIndex: =43

                    Button6_25 As button:
                        Align: =Align.Left
                        BorderThickness: =0
                        Color: =RGBA(82, 82, 82, 1)
                        Fill: =If(reportPrivacyValue = ThisItem.value, RGBA(241, 244, 249, 1), RGBA(0, 0, 0, 0))
                        FocusedBorderThickness: =0
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Normal
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(241, 244, 249, 1)
                        OnSelect: |-
                            =Set(reportPrivacyValue, ThisItem.value);
                            Set(reportPrivacyShowDropdown, false);
                        PaddingLeft: =15
                        PaddingRight: =5.27
                        PaddingTop: =5.27
                        PressedColor: =Self.Color
                        PressedFill: =
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =10.5
                        Text: =If(Language = "Vn", ThisItem.vn, ThisItem.en)
                        Width: =Parent.Width
                        X: =0.00
                        ZIndex: =1

                "WeekItems As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    BorderColor: =RGBA(191, 191, 192, 1)
                    BorderThickness: =0.5
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =Min(Self.AllItemsCount, 4) * Self.TemplateHeight + 10
                    Items: =reportWeekArray
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =40
                    Visible: =reportWeekShowDropdown
                    Width: =WeekDropdown.Width
                    X: =WeekDropdown.X
                    Y: =WeekDropdown.Y + 50
                    ZIndex: =44

                    Button6_26 As button:
                        Align: =Align.Left
                        BorderThickness: =0
                        Color: =RGBA(82, 82, 82, 1)
                        Fill: =If(reportWeekValue = ThisItem.value, RGBA(241, 244, 249, 1), RGBA(0, 0, 0, 0))
                        FocusedBorderThickness: =0
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Normal
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(241, 244, 249, 1)
                        OnSelect: |-
                            =Set(reportWeekValue, ThisItem.value);
                            Set(reportWeekShowDropdown, false);
                        PaddingLeft: =15
                        PaddingRight: =5.27
                        PaddingTop: =5.27
                        PressedColor: =Self.Color
                        PressedFill: =
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =10.5
                        Text: =ThisItem.value
                        Width: =Parent.Width
                        X: =0.00
                        ZIndex: =1

                "MonthItems As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    BorderColor: =RGBA(191, 191, 192, 1)
                    BorderThickness: =0.5
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =Min(Self.AllItemsCount, 4) * Self.TemplateHeight + 10
                    Items: =reportMonthArray
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =40
                    Visible: =reportMonthShowDropdown
                    Width: =MonthDropdown.Width
                    X: =MonthDropdown.X
                    Y: =MonthDropdown.Y + 50
                    ZIndex: =45

                    Button6_27 As button:
                        Align: =Align.Left
                        BorderThickness: =0
                        Color: =RGBA(82, 82, 82, 1)
                        Fill: =If(reportMonthValue = ThisItem.value, RGBA(241, 244, 249, 1), RGBA(0, 0, 0, 0))
                        FocusedBorderThickness: =0
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Normal
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(241, 244, 249, 1)
                        OnSelect: |-
                            =Set(reportMonthValue, ThisItem.value);
                            Set(reportMonthShowDropdown, false);
                        PaddingLeft: =15
                        PaddingRight: =5.27
                        PaddingTop: =5.27
                        PressedColor: =Self.Color
                        PressedFill: =
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =10.5
                        Text: =ThisItem.value
                        Width: =Parent.Width
                        X: =0.00
                        ZIndex: =1

                "QuarterItems As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    BorderColor: =RGBA(191, 191, 192, 1)
                    BorderThickness: =0.5
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =Min(Self.AllItemsCount, 4) * Self.TemplateHeight + 10
                    Items: =reportQuarterArray
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =40
                    Visible: =reportQuarterShowDropdown
                    Width: =QuarterDropdown.Width
                    X: =QuarterDropdown.X
                    Y: =QuarterDropdown.Y + 50
                    ZIndex: =46

                    Button6_28 As button:
                        Align: =Align.Left
                        BorderThickness: =0
                        Color: =RGBA(82, 82, 82, 1)
                        Fill: =If(reportQuarterValue = ThisItem.value, RGBA(241, 244, 249, 1), RGBA(0, 0, 0, 0))
                        FocusedBorderThickness: =0
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Normal
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(241, 244, 249, 1)
                        OnSelect: |-
                            =Set(reportQuarterValue, ThisItem.value);
                            Set(reportQuarterShowDropdown, false);
                        PaddingLeft: =15
                        PaddingRight: =5.27
                        PaddingTop: =5.27
                        PressedColor: =Self.Color
                        PressedFill: =
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =10.5
                        Text: =ThisItem.value
                        Width: =Parent.Width
                        X: =0.00
                        ZIndex: =1

                "YearItems As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                    '#CopilotOverlayLabel': ="Filtered"
                    BorderColor: =RGBA(191, 191, 192, 1)
                    BorderThickness: =0.5
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =Min(Self.AllItemsCount, 4) * Self.TemplateHeight + 10
                    Items: =reportYearArray
                    Layout: =Layout.Vertical
                    LoadingSpinner: =LoadingSpinner.Data
                    TemplatePadding: =0
                    TemplateSize: =40
                    Visible: =reportYearShowDropdown
                    Width: =YearDropdown.Width
                    X: =YearDropdown.X
                    Y: =YearDropdown.Y + 50
                    ZIndex: =47

                    Button6_29 As button:
                        Align: =Align.Left
                        BorderThickness: =0
                        Color: =RGBA(82, 82, 82, 1)
                        Fill: =If(reportYearValue = ThisItem.value, RGBA(241, 244, 249, 1), RGBA(0, 0, 0, 0))
                        FocusedBorderThickness: =0
                        Font: =Font.Arial
                        FontWeight: =FontWeight.Normal
                        HoverColor: =RGBA(0, 0, 0, 1)
                        HoverFill: =RGBA(241, 244, 249, 1)
                        OnSelect: |-
                            =Set(reportYearValue, ThisItem.value);
                            Set(reportYearShowDropdown, false);
                        PaddingLeft: =15
                        PaddingRight: =5.27
                        PaddingTop: =5.27
                        PressedColor: =Self.Color
                        PressedFill: =
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =10.5
                        Text: =ThisItem.value
                        Width: =Parent.Width
                        X: =0.00
                        ZIndex: =1

            IR_Form_Group As group:
                Height: =5
                Width: =5
                X: =60
                Y: =60
                ZIndex: =63

                RequireStar_Frequency As label:
                    Color: =RGBA(255, 0, 0, 1)
                    Font: =Font.Arial
                    Height: =30
                    PaddingLeft: =0
                    Size: =15
                    Text: ="*"
                    Width: =40
                    X: =Frequency_Label.X + If(Language = "Vn", 60, 70)
                    Y: =Frequency_Label.Y
                    ZIndex: =2

                BasicInformation_Label As label:
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Semibold
                    PaddingLeft: =0
                    Size: =12
                    Text: =If(Language = "Vn", "Thông tin cơ bản", "Basic information")
                    Width: =200
                    X: =WhiteBackground_6.X + If(App.Width > 800, 45, 30 )
                    Y: =WhiteBackground_6.Y + 30
                    ZIndex: =3

                RequireStar_ReportName As label:
                    Color: =RGBA(255, 0, 0, 1)
                    Font: =Font.Arial
                    Height: =30
                    PaddingLeft: =0
                    Size: =15
                    Text: ="*"
                    Width: =40
                    X: =ReportName_Label.X + 82
                    Y: =ReportName_Label.Y
                    ZIndex: =4

                RequireStar_ReportType As label:
                    Color: =RGBA(255, 0, 0, 1)
                    Font: =Font.Arial
                    Height: =30
                    PaddingLeft: =0
                    Size: =15
                    Text: ="*"
                    Width: =40
                    X: =ReportType_Label_1.X + If(Language = "En", 75, 80)
                    Y: =ReportType_Label_1.Y
                    ZIndex: =5

                btnLanguage As button:
                    BorderColor: =RGBA(191, 191, 192, 1)
                    BorderThickness: =1
                    Color: =RGBA(0, 0, 0, 1)
                    DisabledFill: =Self.Fill
                    Fill: =RGBA(0, 0, 0, 0)
                    FocusedBorderThickness: =1
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Normal
                    Height: =39
                    HoverColor: =Self.Color
                    HoverFill: =Self.Fill
                    OnSelect: =Set(Language, If(Language = "Vn", "En", "Vn"));
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    PressedColor: =Self.Color
                    PressedFill: =Self.Fill
                    RadiusBottomLeft: =5
                    RadiusBottomRight: =5
                    RadiusTopLeft: =5
                    RadiusTopRight: =5
                    Size: =10.5
                    TabIndex: =-1
                    Text: =If(Language = "Vn", "En", "Vn")
                    Visible: =canEdit
                    Width: =40
                    X: =PrivacyDropdown.X + PrivacyDropdown.Width - Self.Width
                    Y: =BasicInformation_Label.Y + If(App.Width > 800, 5, 0)
                    ZIndex: =6

                ReportName_Label As label:
                    Font: =Font.Arial
                    Height: =30
                    PaddingLeft: =0
                    Size: =10.5
                    Text: =If(Language = "Vn", "Tên báo cáo", "Report name")
                    Width: =120
                    X: =BasicInformation_Label.X
                    Y: =BasicInformation_Label.Y + BasicInformation_Label.Height
                    ZIndex: =7

                Date_InputNack As text:
                    BorderColor: =RGBA(191, 191, 192, 1)
                    BorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Default: =
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    FocusedBorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Font: =Font.Arial
                    Height: =44
                    HoverFill: =RGBA(186, 202, 226, 0)
                    Size: =10.5
                    TabIndex: =-1
                    Width: =If(App.Width > 800, (WhiteBackground_6.Width - 260) * 1/5, ReportName_Input.Width)
                    X: =Date_Label.X
                    Y: =Date_Label.Y + Date_Label.Height
                    ZIndex: =8

                ReportName_Input As text:
                    BorderColor: =If(IsBlank(Self.Text) && isSubmited, RGBA(214, 27, 27, 1), RGBA(191, 191, 192, 1))
                    BorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Default: =If(IsBlank(investmentDetail), "", investmentDetail.report_name_en)
                    DisabledColor: =If(App.Width > 600, RGBA(166, 166, 166, 1), RGBA(166, 166, 166, 0))
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    FocusedBorderColor: =RGBA(0, 18, 107, 1)
                    FocusedBorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Font: =Font.Arial
                    Height: =If(App.Width > 800 && Len(Self.Text) > 100, 70, 85)
                    HoverFill: =RGBA(186, 202, 226, 0)
                    MaxLength: =150
                    Mode: =TextMode.MultiLine
                    PressedBorderColor: =RGBA(0, 18, 107, 1)
                    Size: =If(App.Width > 600, 10.5, 12)
                    Visible: =Language <> "Vn"
                    Width: =If(App.Width > 800, (WhiteBackground_6.Width - 260) * 2/5 + 40, (WhiteBackground_6.Width - 70))
                    X: =ReportName_Label.X
                    Y: =ReportName_Label.Y + ReportName_Label.Height
                    ZIndex: =9

                ReportName_Input_Vn As text:
                    BorderColor: =If(IsBlank(Self.Text) && isSubmited, RGBA(214, 27, 27, 1), RGBA(191, 191, 192, 1))
                    BorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Default: =If(IsBlank(investmentDetail), "", investmentDetail.report_name)
                    DisabledColor: =If(App.Width > 600, RGBA(166, 166, 166, 1), RGBA(166, 166, 166, 0))
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    FocusedBorderColor: =RGBA(0, 18, 107, 1)
                    FocusedBorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Font: =Font.Arial
                    Height: =If(App.Width > 800 && Len(Self.Text) > 100, 70, 85)
                    HoverFill: =RGBA(186, 202, 226, 0)
                    MaxLength: =150
                    Mode: =TextMode.MultiLine
                    PressedBorderColor: =RGBA(0, 18, 107, 1)
                    Size: =If(App.Width > 600, 10.5, 12)
                    Visible: =Language = "Vn"
                    Width: =ReportName_Input.Width 
                    X: =ReportName_Label.X
                    Y: =ReportName_Label.Y + ReportName_Label.Height
                    ZIndex: =10

                Frequency_Label As label:
                    Color: =RGBA(82, 82, 82, 1)
                    Font: =Font.Arial
                    Height: =30
                    PaddingLeft: =0
                    PaddingRight: =5.00
                    PaddingTop: =5.00
                    Size: =10.5
                    Text: =If(Language = "Vn", "Tần suất", "Frequency")
                    Width: =150.00
                    X: =If(App.Width > 800, ReportName_Input.X + ReportName_Input.Width + If(App.Width > 800, 40, 10), ReportName_Input.X)
                    Y: =If(App.Width > 800, ReportName_Label.Y, ReportName_Input.Y + ReportName_Input.Height + 10)
                    ZIndex: =11

                FrequencyDropdown As button:
                    Align: =Align.Left
                    BorderColor: =If(IsBlank(Self.Text) && isSubmited, RGBA(214, 27, 27, 1), If(frequencyShowDropdown, RGBA(0, 18, 107, 1), ColorFade(Self.Fill, -15%)))
                    BorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Color: =RGBA(82, 82, 82, 1)
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    Fill: =RGBA(255, 255, 255, 1)
                    FocusedBorderColor: =RGBA(0, 18, 107, 1)
                    FocusedBorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Normal
                    Height: =44
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(241, 244, 249, 1)
                    OnSelect: =Set(frequencyShowDropdown, !frequencyShowDropdown)
                    PaddingLeft: =15
                    PaddingRight: =30
                    PaddingTop: =5.27
                    PressedBorderColor: =
                    PressedColor: =
                    PressedFill: =
                    RadiusBottomLeft: =5
                    RadiusBottomRight: =5
                    RadiusTopLeft: =5
                    RadiusTopRight: =5
                    Size: =10.5
                    Text: =If(Language = "Vn", First(Filter(frequencyArray, frequencyValue = value)).vn, First(Filter(frequencyArray, frequencyValue = value)).en)
                    Width: =If(App.Width > 800, (WhiteBackground_6.Width - 260) * 1/5, ReportName_Input.Width )
                    X: =Frequency_Label.X
                    Y: =Frequency_Label.Y + Frequency_Label.Height
                    ZIndex: =12

                FrequencyChevron As htmlViewer:
                    Font: =Font.Arial
                    Height: =44
                    HtmlText: |-
                        =If(frequencyShowDropdown,
                        "<div style="""&If(!isDisable, "cursor: pointer")&"""><svg width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"" xmlns=""http://www.w3.org/2000/svg"">
                        <g clip-path=""url(#clip0_1760_3688)"">
                        <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M11.2682 8.62347C11.4558 8.436 11.7101 8.33068 11.9752 8.33068C12.2404 8.33068 12.4947 8.436 12.6822 8.62347L18.3392 14.2805C18.4348 14.3727 18.5109 14.4831 18.5633 14.6051C18.6158 14.7271 18.6433 14.8583 18.6445 14.9911C18.6456 15.1238 18.6203 15.2555 18.5701 15.3784C18.5198 15.5013 18.4455 15.613 18.3516 15.7069C18.2577 15.8008 18.1461 15.875 18.0232 15.9253C17.9003 15.9756 17.7686 16.0009 17.6358 15.9997C17.5031 15.9986 17.3718 15.971 17.2498 15.9186C17.1278 15.8662 17.0175 15.79 16.9252 15.6945L11.9752 10.7445L7.02524 15.6945C6.83664 15.8766 6.58404 15.9774 6.32184 15.9751C6.05965 15.9729 5.80883 15.8677 5.62342 15.6823C5.43802 15.4969 5.33285 15.2461 5.33057 14.9839C5.32829 14.7217 5.42908 14.4691 5.61124 14.2805L11.2682 8.62347Z"" fill=""#525252""/>
                        </g>
                        <defs>
                        <clipPath id=""clip0_1760_3688"">
                        <rect width=""24"" height=""24"" fill=""white""/>
                        </clipPath>
                        </defs>
                        </svg></div>"
                        , "<div style="""&If(!isDisable, "cursor: pointer")&"""><svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"">
                        <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M12.7069 15.7071C12.5193 15.8946 12.265 15.9999 11.9999 15.9999C11.7347 15.9999 11.4804 15.8946 11.2929 15.7071L5.63585 10.0501C5.54034 9.95785 5.46416 9.84751 5.41175 9.7255C5.35934 9.6035 5.33176 9.47228 5.3306 9.3395C5.32945 9.20672 5.35475 9.07504 5.40503 8.95215C5.45531 8.82925 5.52957 8.7176 5.62346 8.6237C5.71735 8.52981 5.829 8.45556 5.9519 8.40528C6.0748 8.355 6.20648 8.32969 6.33926 8.33085C6.47204 8.332 6.60325 8.35959 6.72526 8.412C6.84726 8.46441 6.95761 8.54059 7.04985 8.6361L11.9999 13.5861L16.9499 8.6361C17.1385 8.45394 17.3911 8.35315 17.6533 8.35542C17.9155 8.3577 18.1663 8.46287 18.3517 8.64828C18.5371 8.83369 18.6423 9.0845 18.6445 9.3467C18.6468 9.60889 18.546 9.8615 18.3639 10.0501L12.7069 15.7071Z"" fill=""#525252""/>
                        </svg></div>")
                    OnSelect: =If(!isDisable, Select(FrequencyDropdown))
                    PaddingRight: =5.27
                    PaddingTop: =5.27
                    Size: =11.60
                    Width: =35
                    X: =FrequencyDropdown.X + FrequencyDropdown.Width - If(App.Width > 800, 40, 30)
                    Y: =FrequencyDropdown.Y + 5
                    ZIndex: =13

                ReportType_Label_1 As label:
                    Color: =RGBA(82, 82, 82, 1)
                    Font: =Font.Arial
                    Height: =30
                    PaddingLeft: =0
                    PaddingRight: =5.00
                    PaddingTop: =5.00
                    Size: =10.5
                    Text: =If(Language = "Vn", "Loại báo cáo ", "Report type")
                    Width: =150.00
                    X: =If(App.Width > 800, FrequencyDropdown.X + FrequencyDropdown.Width + If(App.Width > 800, 40, 10), ReportName_Input.X)
                    Y: =If(App.Width > 800, ReportName_Label.Y, FrequencyDropdown.Y + FrequencyDropdown.Height + 10)
                    ZIndex: =14

                ReportTypeDropdown_1 As button:
                    Align: =Align.Left
                    BorderColor: =If(IsBlank(Self.Text) && isSubmited, RGBA(214, 27, 27, 1), If(reportTypeShowDropdown, RGBA(0, 18, 107, 1), ColorFade(Self.Fill, -15%)))
                    BorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Color: =RGBA(82, 82, 82, 1)
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    Fill: =RGBA(255, 255, 255, 1)
                    FocusedBorderColor: =RGBA(0, 18, 107, 1)
                    FocusedBorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Normal
                    Height: =44
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(241, 244, 249, 1)
                    OnSelect: =Set(reportTypeShowDropdown, !reportTypeShowDropdown)
                    PaddingLeft: =15
                    PaddingRight: =30
                    PaddingTop: =5.27
                    PressedBorderColor: =
                    PressedColor: =
                    PressedFill: =
                    RadiusBottomLeft: =5
                    RadiusBottomRight: =5
                    RadiusTopLeft: =5
                    RadiusTopRight: =5
                    Size: =10.5
                    Text: =If(Language = "Vn", First(Filter(reportTypeArray, reportTypeValue = value)).vn, First(Filter(reportTypeArray, reportTypeValue = value)).en)
                    Width: =If(App.Width > 800, (WhiteBackground_6.Width - 260) * 1/5, (WhiteBackground_6.Width - 80) * 1/2)
                    X: =ReportType_Label_1.X
                    Y: =ReportType_Label_1.Y + ReportType_Label_1.Height
                    ZIndex: =15

                ReportTypeChevron_1 As htmlViewer:
                    Font: =Font.Arial
                    Height: =44
                    HtmlText: |-
                        =If(reportTypeShowDropdown,
                        "<div style="""&If(!isDisable, "cursor: pointer")&"""><svg width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"" xmlns=""http://www.w3.org/2000/svg"">
                        <g clip-path=""url(#clip0_1760_3688)"">
                        <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M11.2682 8.62347C11.4558 8.436 11.7101 8.33068 11.9752 8.33068C12.2404 8.33068 12.4947 8.436 12.6822 8.62347L18.3392 14.2805C18.4348 14.3727 18.5109 14.4831 18.5633 14.6051C18.6158 14.7271 18.6433 14.8583 18.6445 14.9911C18.6456 15.1238 18.6203 15.2555 18.5701 15.3784C18.5198 15.5013 18.4455 15.613 18.3516 15.7069C18.2577 15.8008 18.1461 15.875 18.0232 15.9253C17.9003 15.9756 17.7686 16.0009 17.6358 15.9997C17.5031 15.9986 17.3718 15.971 17.2498 15.9186C17.1278 15.8662 17.0175 15.79 16.9252 15.6945L11.9752 10.7445L7.02524 15.6945C6.83664 15.8766 6.58404 15.9774 6.32184 15.9751C6.05965 15.9729 5.80883 15.8677 5.62342 15.6823C5.43802 15.4969 5.33285 15.2461 5.33057 14.9839C5.32829 14.7217 5.42908 14.4691 5.61124 14.2805L11.2682 8.62347Z"" fill=""#525252""/>
                        </g>
                        <defs>
                        <clipPath id=""clip0_1760_3688"">
                        <rect width=""24"" height=""24"" fill=""white""/>
                        </clipPath>
                        </defs>
                        </svg></div>"
                        , "<div style="""&If(!isDisable, "cursor: pointer")&"""><svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"">
                        <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M12.7069 15.7071C12.5193 15.8946 12.265 15.9999 11.9999 15.9999C11.7347 15.9999 11.4804 15.8946 11.2929 15.7071L5.63585 10.0501C5.54034 9.95785 5.46416 9.84751 5.41175 9.7255C5.35934 9.6035 5.33176 9.47228 5.3306 9.3395C5.32945 9.20672 5.35475 9.07504 5.40503 8.95215C5.45531 8.82925 5.52957 8.7176 5.62346 8.6237C5.71735 8.52981 5.829 8.45556 5.9519 8.40528C6.0748 8.355 6.20648 8.32969 6.33926 8.33085C6.47204 8.332 6.60325 8.35959 6.72526 8.412C6.84726 8.46441 6.95761 8.54059 7.04985 8.6361L11.9999 13.5861L16.9499 8.6361C17.1385 8.45394 17.3911 8.35315 17.6533 8.35542C17.9155 8.3577 18.1663 8.46287 18.3517 8.64828C18.5371 8.83369 18.6423 9.0845 18.6445 9.3467C18.6468 9.60889 18.546 9.8615 18.3639 10.0501L12.7069 15.7071Z"" fill=""#525252""/>
                        </svg></div>")
                    OnSelect: =If(!isDisable, Set(reportTypeShowDropdown, !reportTypeShowDropdown))
                    PaddingRight: =5.27
                    PaddingTop: =5.27
                    Size: =11.60
                    Width: =35
                    X: =ReportTypeDropdown_1.X + ReportTypeDropdown_1.Width - If(App.Width > 800, 40, 30)
                    Y: =ReportTypeDropdown_1.Y + 5
                    ZIndex: =16

                Privacy_Label As label:
                    Color: =RGBA(82, 82, 82, 1)
                    Font: =Font.Arial
                    Height: =30
                    PaddingLeft: =0
                    PaddingRight: =5.00
                    PaddingTop: =5.00
                    Size: =10.5
                    Text: =If(Language = "Vn", "Bảo mật ", "Privacy")
                    Width: =150.00
                    X: =ReportTypeDropdown_1.X + ReportTypeDropdown_1.Width + If(App.Width > 800, 40, 10)
                    Y: =ReportType_Label_1.Y
                    ZIndex: =17

                PrivacyDropdown As button:
                    Align: =Align.Left
                    BorderColor: =If(reportPrivacyShowDropdown, RGBA(0, 18, 107, 1), ColorFade(Self.Fill, -15%))
                    BorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Color: =RGBA(82, 82, 82, 1)
                    DisplayMode: =DisplayMode.Disabled
                    Fill: =RGBA(255, 255, 255, 1)
                    FocusedBorderColor: =RGBA(0, 18, 107, 1)
                    FocusedBorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Normal
                    Height: =44
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(241, 244, 249, 1)
                    OnSelect: =Set(reportPrivacyShowDropdown, !reportPrivacyShowDropdown)
                    PaddingLeft: =15
                    PaddingRight: =5.27
                    PaddingTop: =5.27
                    PressedBorderColor: =
                    PressedColor: =
                    PressedFill: =
                    RadiusBottomLeft: =5
                    RadiusBottomRight: =5
                    RadiusTopLeft: =5
                    RadiusTopRight: =5
                    Size: =10.5
                    Text: =If(Language = "Vn", First(Filter(reportPrivacyArray, Lower(reportPrivacyValue) = Lower(value))).vn, First(Filter(reportPrivacyArray, Lower(reportPrivacyValue) = Lower(value))).en)
                    Width: =If(App.Width > 800, (WhiteBackground_6.Width - 260) * 1/5, (WhiteBackground_6.Width - 80) * 1/2)
                    X: =Privacy_Label.X
                    Y: =Privacy_Label.Y + Privacy_Label.Height
                    ZIndex: =18

                PrivacyChevron As htmlViewer:
                    Font: =Font.Arial
                    Height: =44
                    HtmlText: |-
                        ="<div><svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"">
                        <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M12.7069 15.7071C12.5193 15.8946 12.265 15.9999 11.9999 15.9999C11.7347 15.9999 11.4804 15.8946 11.2929 15.7071L5.63585 10.0501C5.54034 9.95785 5.46416 9.84751 5.41175 9.7255C5.35934 9.6035 5.33176 9.47228 5.3306 9.3395C5.32945 9.20672 5.35475 9.07504 5.40503 8.95215C5.45531 8.82925 5.52957 8.7176 5.62346 8.6237C5.71735 8.52981 5.829 8.45556 5.9519 8.40528C6.0748 8.355 6.20648 8.32969 6.33926 8.33085C6.47204 8.332 6.60325 8.35959 6.72526 8.412C6.84726 8.46441 6.95761 8.54059 7.04985 8.6361L11.9999 13.5861L16.9499 8.6361C17.1385 8.45394 17.3911 8.35315 17.6533 8.35542C17.9155 8.3577 18.1663 8.46287 18.3517 8.64828C18.5371 8.83369 18.6423 9.0845 18.6445 9.3467C18.6468 9.60889 18.546 9.8615 18.3639 10.0501L12.7069 15.7071Z"" fill=""#525252""/>
                        </svg></div>"
                    OnSelect: =//If(!isDisable, Set(reportPrivacyShowDropdown, !reportPrivacyShowDropdown))
                    PaddingRight: =5.27
                    PaddingTop: =5.27
                    Size: =11.60
                    Width: =35
                    X: =PrivacyDropdown.X + PrivacyDropdown.Width - If(App.Width > 800, 40, 30)
                    Y: =PrivacyDropdown.Y + 5
                    ZIndex: =19

                PeriodOfReport_Label As label:
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Semibold
                    PaddingLeft: =0
                    Size: =12
                    Text: =If(Language = "Vn", "Kì báo cáo ", "Period of report")
                    Width: =200
                    X: =BasicInformation_Label.X
                    Y: =If(App.Width > 800, ReportName_Input.Y + ReportName_Input.Height + 30, PrivacyDropdown.Y + PrivacyDropdown.Height + 30)
                    ZIndex: =20

                Date_Label As label:
                    Font: =Font.Arial
                    Height: =30
                    PaddingLeft: =0
                    Size: =10.5
                    Text: =If(Language = "Vn", "Ngày", "Date")
                    Width: =120
                    X: =BasicInformation_Label.X
                    Y: =PeriodOfReport_Label.Y + PeriodOfReport_Label.Height
                    ZIndex: =21

                Date_Datepicker As datepicker:
                    BorderThickness: =0
                    DefaultDate: =If(IsBlank(investmentDetail), Today(), DateValue(investmentDetail.report_date))
                    DisabledColor: =If(App.Width > 600, RGBA(166, 166, 166, 1), RGBA(166, 166, 166, 0))
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    FocusedBorderThickness: =0
                    Font: =Font.Arial
                    Format: ="dd/mm/yyyy"
                    Height: =Date_InputNack.Height - 6
                    IconBackground: =RGBA(255, 255, 255, 1)
                    IconFill: =RGBA(0, 0, 0, 1)
                    InputTextPlaceholder: =If(IsBlank(Self.SelectedDate), Text("", Self.Format, Self.Language))
                    OnChange: |-
                        =Set(reportWeekValue, Text(WeekNum(Self.SelectedDate)));
                        Set(reportQuarterValue, Text(RoundUp (Month(Self.SelectedDate) / 3, 0)));
                        Set(reportMonthValue, Text(Month(Self.SelectedDate)));
                        Set(reportYearValue, Text(Year(Self.SelectedDate)));
                    PaddingBottom: =10
                    PaddingLeft: =10
                    PaddingRight: =50
                    PaddingTop: =10
                    Size: =10.5
                    Width: =Date_InputNack.Width - 6
                    X: =Date_InputNack.X + 3
                    Y: =Date_InputNack.Y + 3
                    ZIndex: =22

                Week_Label As label:
                    Color: =RGBA(82, 82, 82, 1)
                    Font: =Font.Arial
                    Height: =30
                    PaddingLeft: =0
                    PaddingRight: =5.00
                    PaddingTop: =5.00
                    Size: =10.5
                    Text: =If(Language = "Vn", "Tuần", "Week")
                    Width: =150.00
                    X: =If(App.Width > 800, Date_InputNack.X + Date_InputNack.Width + If(App.Width > 800, 40, 10), Date_InputNack.X)
                    Y: =If(App.Width > 800, Date_Label.Y, Date_InputNack.Y + Date_InputNack.Height + 10)
                    ZIndex: =23

                WeekDropdown As button:
                    Align: =Align.Left
                    BorderColor: =If(reportWeekShowDropdown, RGBA(0, 18, 107, 1), ColorFade(Self.Fill, -15%))
                    BorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Color: =RGBA(82, 82, 82, 1)
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    Fill: =RGBA(255, 255, 255, 1)
                    FocusedBorderColor: =RGBA(0, 18, 107, 1)
                    FocusedBorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Normal
                    Height: =44
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(241, 244, 249, 1)
                    OnSelect: =Set(reportWeekShowDropdown, !reportWeekShowDropdown)
                    PaddingLeft: =15
                    PaddingRight: =5.27
                    PaddingTop: =5.27
                    PressedBorderColor: =
                    PressedColor: =
                    PressedFill: =
                    RadiusBottomLeft: =5
                    RadiusBottomRight: =5
                    RadiusTopLeft: =5
                    RadiusTopRight: =5
                    Size: =10.5
                    Text: =reportWeekValue
                    Width: =If(App.Width > 800, (WhiteBackground_6.Width - 260) * 1/5, ReportTypeDropdown_1.Width)
                    X: =Week_Label.X
                    Y: =Week_Label.Y + Week_Label.Height
                    ZIndex: =24

                WeekChevron As htmlViewer:
                    Font: =Font.Arial
                    Height: =44
                    HtmlText: |-
                        =If(reportWeekShowDropdown,
                        "<div style="""&If(!isDisable, "cursor: pointer")&"""><svg width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"" xmlns=""http://www.w3.org/2000/svg"">
                        <g clip-path=""url(#clip0_1760_3688)"">
                        <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M11.2682 8.62347C11.4558 8.436 11.7101 8.33068 11.9752 8.33068C12.2404 8.33068 12.4947 8.436 12.6822 8.62347L18.3392 14.2805C18.4348 14.3727 18.5109 14.4831 18.5633 14.6051C18.6158 14.7271 18.6433 14.8583 18.6445 14.9911C18.6456 15.1238 18.6203 15.2555 18.5701 15.3784C18.5198 15.5013 18.4455 15.613 18.3516 15.7069C18.2577 15.8008 18.1461 15.875 18.0232 15.9253C17.9003 15.9756 17.7686 16.0009 17.6358 15.9997C17.5031 15.9986 17.3718 15.971 17.2498 15.9186C17.1278 15.8662 17.0175 15.79 16.9252 15.6945L11.9752 10.7445L7.02524 15.6945C6.83664 15.8766 6.58404 15.9774 6.32184 15.9751C6.05965 15.9729 5.80883 15.8677 5.62342 15.6823C5.43802 15.4969 5.33285 15.2461 5.33057 14.9839C5.32829 14.7217 5.42908 14.4691 5.61124 14.2805L11.2682 8.62347Z"" fill=""#525252""/>
                        </g>
                        <defs>
                        <clipPath id=""clip0_1760_3688"">
                        <rect width=""24"" height=""24"" fill=""white""/>
                        </clipPath>
                        </defs>
                        </svg></div>"
                        , "<div style="""&If(!isDisable, "cursor: pointer")&"""><svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"">
                        <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M12.7069 15.7071C12.5193 15.8946 12.265 15.9999 11.9999 15.9999C11.7347 15.9999 11.4804 15.8946 11.2929 15.7071L5.63585 10.0501C5.54034 9.95785 5.46416 9.84751 5.41175 9.7255C5.35934 9.6035 5.33176 9.47228 5.3306 9.3395C5.32945 9.20672 5.35475 9.07504 5.40503 8.95215C5.45531 8.82925 5.52957 8.7176 5.62346 8.6237C5.71735 8.52981 5.829 8.45556 5.9519 8.40528C6.0748 8.355 6.20648 8.32969 6.33926 8.33085C6.47204 8.332 6.60325 8.35959 6.72526 8.412C6.84726 8.46441 6.95761 8.54059 7.04985 8.6361L11.9999 13.5861L16.9499 8.6361C17.1385 8.45394 17.3911 8.35315 17.6533 8.35542C17.9155 8.3577 18.1663 8.46287 18.3517 8.64828C18.5371 8.83369 18.6423 9.0845 18.6445 9.3467C18.6468 9.60889 18.546 9.8615 18.3639 10.0501L12.7069 15.7071Z"" fill=""#525252""/>
                        </svg></div>")
                    OnSelect: =If(!isDisable, Set(reportWeekShowDropdown, !reportWeekShowDropdown))
                    PaddingRight: =5.27
                    PaddingTop: =5.27
                    Size: =11.60
                    Width: =35
                    X: =WeekDropdown.X + WeekDropdown.Width - If(App.Width > 800, 40, 30)
                    Y: =WeekDropdown.Y + 5
                    ZIndex: =25

                Month_Label As label:
                    Color: =RGBA(82, 82, 82, 1)
                    Font: =Font.Arial
                    Height: =30
                    PaddingLeft: =0
                    PaddingRight: =5.00
                    PaddingTop: =5.00
                    Size: =10.5
                    Text: =If(Language = "Vn", "Tháng", "Month")
                    Width: =150.00
                    X: =WeekDropdown.X + WeekDropdown.Width + If(App.Width > 800, 40, 10)
                    Y: =Week_Label.Y
                    ZIndex: =26

                MonthDropdown As button:
                    Align: =Align.Left
                    BorderColor: =If(reportMonthShowDropdown, RGBA(0, 18, 107, 1), ColorFade(Self.Fill, -15%))
                    BorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Color: =RGBA(82, 82, 82, 1)
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    Fill: =RGBA(255, 255, 255, 1)
                    FocusedBorderColor: =RGBA(0, 18, 107, 1)
                    FocusedBorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Normal
                    Height: =44
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(241, 244, 249, 1)
                    OnSelect: =Set(reportMonthShowDropdown, !reportMonthShowDropdown)
                    PaddingLeft: =15
                    PaddingRight: =5.27
                    PaddingTop: =5.27
                    PressedBorderColor: =
                    PressedColor: =
                    PressedFill: =
                    RadiusBottomLeft: =5
                    RadiusBottomRight: =5
                    RadiusTopLeft: =5
                    RadiusTopRight: =5
                    Size: =10.5
                    Text: =reportMonthValue
                    Width: =If(App.Width > 800, (WhiteBackground_6.Width - 260) * 1/5, ReportTypeDropdown_1.Width)
                    X: =Month_Label.X
                    Y: =Month_Label.Y + Month_Label.Height
                    ZIndex: =27

                MonthChevron As htmlViewer:
                    Font: =Font.Arial
                    Height: =44
                    HtmlText: |-
                        =If(reportMonthShowDropdown,
                        "<div style="""&If(!isDisable, "cursor: pointer")&"""><svg width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"" xmlns=""http://www.w3.org/2000/svg"">
                        <g clip-path=""url(#clip0_1760_3688)"">
                        <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M11.2682 8.62347C11.4558 8.436 11.7101 8.33068 11.9752 8.33068C12.2404 8.33068 12.4947 8.436 12.6822 8.62347L18.3392 14.2805C18.4348 14.3727 18.5109 14.4831 18.5633 14.6051C18.6158 14.7271 18.6433 14.8583 18.6445 14.9911C18.6456 15.1238 18.6203 15.2555 18.5701 15.3784C18.5198 15.5013 18.4455 15.613 18.3516 15.7069C18.2577 15.8008 18.1461 15.875 18.0232 15.9253C17.9003 15.9756 17.7686 16.0009 17.6358 15.9997C17.5031 15.9986 17.3718 15.971 17.2498 15.9186C17.1278 15.8662 17.0175 15.79 16.9252 15.6945L11.9752 10.7445L7.02524 15.6945C6.83664 15.8766 6.58404 15.9774 6.32184 15.9751C6.05965 15.9729 5.80883 15.8677 5.62342 15.6823C5.43802 15.4969 5.33285 15.2461 5.33057 14.9839C5.32829 14.7217 5.42908 14.4691 5.61124 14.2805L11.2682 8.62347Z"" fill=""#525252""/>
                        </g>
                        <defs>
                        <clipPath id=""clip0_1760_3688"">
                        <rect width=""24"" height=""24"" fill=""white""/>
                        </clipPath>
                        </defs>
                        </svg></div>"
                        , "<div style="""&If(!isDisable, "cursor: pointer")&"""><svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"">
                        <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M12.7069 15.7071C12.5193 15.8946 12.265 15.9999 11.9999 15.9999C11.7347 15.9999 11.4804 15.8946 11.2929 15.7071L5.63585 10.0501C5.54034 9.95785 5.46416 9.84751 5.41175 9.7255C5.35934 9.6035 5.33176 9.47228 5.3306 9.3395C5.32945 9.20672 5.35475 9.07504 5.40503 8.95215C5.45531 8.82925 5.52957 8.7176 5.62346 8.6237C5.71735 8.52981 5.829 8.45556 5.9519 8.40528C6.0748 8.355 6.20648 8.32969 6.33926 8.33085C6.47204 8.332 6.60325 8.35959 6.72526 8.412C6.84726 8.46441 6.95761 8.54059 7.04985 8.6361L11.9999 13.5861L16.9499 8.6361C17.1385 8.45394 17.3911 8.35315 17.6533 8.35542C17.9155 8.3577 18.1663 8.46287 18.3517 8.64828C18.5371 8.83369 18.6423 9.0845 18.6445 9.3467C18.6468 9.60889 18.546 9.8615 18.3639 10.0501L12.7069 15.7071Z"" fill=""#525252""/>
                        </svg></div>")
                    OnSelect: =If(!isDisable, Set(reportMonthShowDropdown, !reportMonthShowDropdown))
                    PaddingRight: =5.27
                    PaddingTop: =5.27
                    Size: =11.60
                    Width: =35
                    X: =MonthDropdown.X + MonthDropdown.Width - If(App.Width > 800, 40, 30)
                    Y: =MonthDropdown.Y + 5
                    ZIndex: =28

                Quarter_Label As label:
                    Color: =RGBA(82, 82, 82, 1)
                    Font: =Font.Arial
                    Height: =30
                    PaddingLeft: =0
                    PaddingRight: =5.00
                    PaddingTop: =5.00
                    Size: =10.5
                    Text: =If(Language = "Vn", "Quý", "Quarter")
                    Width: =150.00
                    X: =If(App.Width > 800, MonthDropdown.X + MonthDropdown.Width + If(App.Width > 800, 40, 10), Date_InputNack.X)
                    Y: =If(App.Width > 800, Date_Label.Y, MonthDropdown.Y + MonthDropdown.Height + 10)
                    ZIndex: =29

                QuarterDropdown As button:
                    Align: =Align.Left
                    BorderColor: =If(reportQuarterShowDropdown, RGBA(0, 18, 107, 1), ColorFade(Self.Fill, -15%))
                    BorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Color: =RGBA(82, 82, 82, 1)
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    Fill: =RGBA(255, 255, 255, 1)
                    FocusedBorderColor: =RGBA(0, 18, 107, 1)
                    FocusedBorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Normal
                    Height: =44
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(241, 244, 249, 1)
                    OnSelect: =Set(reportQuarterShowDropdown, !reportQuarterShowDropdown)
                    PaddingLeft: =15
                    PaddingRight: =5.27
                    PaddingTop: =5.27
                    PressedBorderColor: =
                    PressedColor: =
                    PressedFill: =
                    RadiusBottomLeft: =5
                    RadiusBottomRight: =5
                    RadiusTopLeft: =5
                    RadiusTopRight: =5
                    Size: =10.5
                    Text: =reportQuarterValue
                    Width: =If(App.Width > 800, (WhiteBackground_6.Width - 260) * 1/5, ReportTypeDropdown_1.Width)
                    X: =Quarter_Label.X
                    Y: =Quarter_Label.Y + Quarter_Label.Height
                    ZIndex: =30

                QuarterChevron As htmlViewer:
                    Font: =Font.Arial
                    Height: =44
                    HtmlText: |-
                        =If(reportQuarterShowDropdown,
                        "<div style="""&If(!isDisable, "cursor: pointer")&"""><svg width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"" xmlns=""http://www.w3.org/2000/svg"">
                        <g clip-path=""url(#clip0_1760_3688)"">
                        <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M11.2682 8.62347C11.4558 8.436 11.7101 8.33068 11.9752 8.33068C12.2404 8.33068 12.4947 8.436 12.6822 8.62347L18.3392 14.2805C18.4348 14.3727 18.5109 14.4831 18.5633 14.6051C18.6158 14.7271 18.6433 14.8583 18.6445 14.9911C18.6456 15.1238 18.6203 15.2555 18.5701 15.3784C18.5198 15.5013 18.4455 15.613 18.3516 15.7069C18.2577 15.8008 18.1461 15.875 18.0232 15.9253C17.9003 15.9756 17.7686 16.0009 17.6358 15.9997C17.5031 15.9986 17.3718 15.971 17.2498 15.9186C17.1278 15.8662 17.0175 15.79 16.9252 15.6945L11.9752 10.7445L7.02524 15.6945C6.83664 15.8766 6.58404 15.9774 6.32184 15.9751C6.05965 15.9729 5.80883 15.8677 5.62342 15.6823C5.43802 15.4969 5.33285 15.2461 5.33057 14.9839C5.32829 14.7217 5.42908 14.4691 5.61124 14.2805L11.2682 8.62347Z"" fill=""#525252""/>
                        </g>
                        <defs>
                        <clipPath id=""clip0_1760_3688"">
                        <rect width=""24"" height=""24"" fill=""white""/>
                        </clipPath>
                        </defs>
                        </svg></div>"
                        , "<div style="""&If(!isDisable, "cursor: pointer")&"""><svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"">
                        <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M12.7069 15.7071C12.5193 15.8946 12.265 15.9999 11.9999 15.9999C11.7347 15.9999 11.4804 15.8946 11.2929 15.7071L5.63585 10.0501C5.54034 9.95785 5.46416 9.84751 5.41175 9.7255C5.35934 9.6035 5.33176 9.47228 5.3306 9.3395C5.32945 9.20672 5.35475 9.07504 5.40503 8.95215C5.45531 8.82925 5.52957 8.7176 5.62346 8.6237C5.71735 8.52981 5.829 8.45556 5.9519 8.40528C6.0748 8.355 6.20648 8.32969 6.33926 8.33085C6.47204 8.332 6.60325 8.35959 6.72526 8.412C6.84726 8.46441 6.95761 8.54059 7.04985 8.6361L11.9999 13.5861L16.9499 8.6361C17.1385 8.45394 17.3911 8.35315 17.6533 8.35542C17.9155 8.3577 18.1663 8.46287 18.3517 8.64828C18.5371 8.83369 18.6423 9.0845 18.6445 9.3467C18.6468 9.60889 18.546 9.8615 18.3639 10.0501L12.7069 15.7071Z"" fill=""#525252""/>
                        </svg></div>")
                    OnSelect: =If(!isDisable, Set(reportQuarterShowDropdown, !reportQuarterShowDropdown))
                    PaddingRight: =5.27
                    PaddingTop: =5.27
                    Size: =11.60
                    Width: =35
                    X: =QuarterDropdown.X + QuarterDropdown.Width - If(App.Width > 800, 40, 30)
                    Y: =QuarterDropdown.Y + 5
                    ZIndex: =31

                Year_Label As label:
                    Color: =RGBA(82, 82, 82, 1)
                    Font: =Font.Arial
                    Height: =30
                    PaddingLeft: =0
                    PaddingRight: =5.00
                    PaddingTop: =5.00
                    Size: =10.5
                    Text: =If(Language = "Vn", "Năm", "Year")
                    Width: =150.00
                    X: =QuarterDropdown.X + QuarterDropdown.Width + If(App.Width > 800, 40, 10)
                    Y: =Quarter_Label.Y
                    ZIndex: =32

                YearDropdown As button:
                    Align: =Align.Left
                    BorderColor: =If(reportYearShowDropdown, RGBA(0, 18, 107, 1), ColorFade(Self.Fill, -15%))
                    BorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Color: =RGBA(82, 82, 82, 1)
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    Fill: =RGBA(255, 255, 255, 1)
                    FocusedBorderColor: =RGBA(0, 18, 107, 1)
                    FocusedBorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Normal
                    Height: =44
                    HoverColor: =RGBA(0, 0, 0, 1)
                    HoverFill: =RGBA(241, 244, 249, 1)
                    OnSelect: =Set(reportYearShowDropdown, !reportYearShowDropdown)
                    PaddingLeft: =15
                    PaddingRight: =5.27
                    PaddingTop: =5.27
                    PressedBorderColor: =
                    PressedColor: =
                    PressedFill: =
                    RadiusBottomLeft: =5
                    RadiusBottomRight: =5
                    RadiusTopLeft: =5
                    RadiusTopRight: =5
                    Size: =10.5
                    Text: =reportYearValue
                    Width: =If(App.Width > 800, (WhiteBackground_6.Width - 260) * 1/5, ReportTypeDropdown_1.Width)
                    X: =Year_Label.X
                    Y: =Year_Label.Y + Year_Label.Height
                    ZIndex: =33

                YearChevron As htmlViewer:
                    Font: =Font.Arial
                    Height: =44
                    HtmlText: |-
                        =If(reportYearShowDropdown,
                        "<div style="""&If(!isDisable, "cursor: pointer")&"""><svg width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"" xmlns=""http://www.w3.org/2000/svg"">
                        <g clip-path=""url(#clip0_1760_3688)"">
                        <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M11.2682 8.62347C11.4558 8.436 11.7101 8.33068 11.9752 8.33068C12.2404 8.33068 12.4947 8.436 12.6822 8.62347L18.3392 14.2805C18.4348 14.3727 18.5109 14.4831 18.5633 14.6051C18.6158 14.7271 18.6433 14.8583 18.6445 14.9911C18.6456 15.1238 18.6203 15.2555 18.5701 15.3784C18.5198 15.5013 18.4455 15.613 18.3516 15.7069C18.2577 15.8008 18.1461 15.875 18.0232 15.9253C17.9003 15.9756 17.7686 16.0009 17.6358 15.9997C17.5031 15.9986 17.3718 15.971 17.2498 15.9186C17.1278 15.8662 17.0175 15.79 16.9252 15.6945L11.9752 10.7445L7.02524 15.6945C6.83664 15.8766 6.58404 15.9774 6.32184 15.9751C6.05965 15.9729 5.80883 15.8677 5.62342 15.6823C5.43802 15.4969 5.33285 15.2461 5.33057 14.9839C5.32829 14.7217 5.42908 14.4691 5.61124 14.2805L11.2682 8.62347Z"" fill=""#525252""/>
                        </g>
                        <defs>
                        <clipPath id=""clip0_1760_3688"">
                        <rect width=""24"" height=""24"" fill=""white""/>
                        </clipPath>
                        </defs>
                        </svg></div>"
                        , "<div style="""&If(!isDisable, "cursor: pointer")&"""><svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"">
                        <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M12.7069 15.7071C12.5193 15.8946 12.265 15.9999 11.9999 15.9999C11.7347 15.9999 11.4804 15.8946 11.2929 15.7071L5.63585 10.0501C5.54034 9.95785 5.46416 9.84751 5.41175 9.7255C5.35934 9.6035 5.33176 9.47228 5.3306 9.3395C5.32945 9.20672 5.35475 9.07504 5.40503 8.95215C5.45531 8.82925 5.52957 8.7176 5.62346 8.6237C5.71735 8.52981 5.829 8.45556 5.9519 8.40528C6.0748 8.355 6.20648 8.32969 6.33926 8.33085C6.47204 8.332 6.60325 8.35959 6.72526 8.412C6.84726 8.46441 6.95761 8.54059 7.04985 8.6361L11.9999 13.5861L16.9499 8.6361C17.1385 8.45394 17.3911 8.35315 17.6533 8.35542C17.9155 8.3577 18.1663 8.46287 18.3517 8.64828C18.5371 8.83369 18.6423 9.0845 18.6445 9.3467C18.6468 9.60889 18.546 9.8615 18.3639 10.0501L12.7069 15.7071Z"" fill=""#525252""/>
                        </svg></div>")
                    OnSelect: =If(!isDisable, Set(reportYearShowDropdown, !reportYearShowDropdown))
                    PaddingRight: =5.27
                    PaddingTop: =5.27
                    Size: =11.60
                    Width: =35
                    X: =YearDropdown.X + YearDropdown.Width - If(App.Width > 800, 40, 30)
                    Y: =YearDropdown.Y + 5
                    ZIndex: =34

                Note_Label As label:
                    Font: =Font.Arial
                    FontWeight: =FontWeight.Semibold
                    Height: =42
                    PaddingLeft: =0
                    Size: =12
                    Text: =If(Language = "Vn", "Ghi chú", "Note")
                    Width: =120
                    X: =BasicInformation_Label.X
                    Y: =YearDropdown.Y + YearDropdown.Height + 30
                    ZIndex: =35

                Note_Input As text:
                    BorderColor: =RGBA(191, 191, 192, 1)
                    BorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Default: =If(IsBlank(investmentDetail), "", investmentDetail.note_en )
                    DisabledColor: =If(App.Width > 600, RGBA(166, 166, 166, 1), RGBA(166, 166, 166, 0))
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    FocusedBorderColor: =RGBA(0, 18, 107, 1)
                    FocusedBorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Font: =Font.Arial
                    Height: =380
                    HoverFill: =RGBA(186, 202, 226, 0)
                    MaxLength: =3500
                    Mode: =If(Note_InputMobile.Visible, TextMode.SingleLine, TextMode.MultiLine)
                    PressedBorderColor: =RGBA(0, 18, 107, 1)
                    Size: =If(App.Width > 600, 10.5, 12)
                    Visible: =Language <> "Vn"
                    Width: =YearDropdown.X + YearDropdown.Width - Self.X
                    X: =Note_Label.X
                    Y: =Note_Label.Y + Note_Label.Height + 5
                    ZIndex: =36

                Note_Input_Vn As text:
                    BorderColor: =RGBA(191, 191, 192, 1)
                    BorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Default: =If(IsBlank(investmentDetail), "", investmentDetail.note)
                    DisabledColor: =If(App.Width > 600, RGBA(166, 166, 166, 1), RGBA(166, 166, 166, 0))
                    DisplayMode: =If(isDisable, DisplayMode.Disabled, DisplayMode.Edit)
                    FocusedBorderColor: =RGBA(0, 18, 107, 1)
                    FocusedBorderThickness: =If(Self.DisplayMode = DisplayMode.Disabled, 0, 1)
                    Font: =Font.Arial
                    Height: =380
                    HoverFill: =RGBA(186, 202, 226, 0)
                    MaxLength: =3500
                    Mode: =If(Note_Input_VnMobile.Visible, TextMode.SingleLine, TextMode.MultiLine)
                    PressedBorderColor: =RGBA(0, 18, 107, 1)
                    Size: =If(App.Width > 600, 10.5, 12)
                    Visible: =Language = "Vn"
                    Width: =YearDropdown.X + YearDropdown.Width - Self.X
                    X: =Note_Label.X
                    Y: =Note_Label.Y + Note_Label.Height + 5
                    ZIndex: =37

    HeaderQT2List_2 As Header:
        ZIndex: =21

    MenuItemsSideBar_8 As MenuItemsSideBar:
        Height: =Parent.Height - Self.Y
        MenuItems: |-
            =Table(
                {
                    MenuLabel: "Dashboard",
                    MenuIcon: MenuItemsSideBar_8.IconDasboard,
                    MenuScreenNavigate: Dashboard,
                    MenuID: 1,
                    MenuIconDropDown: MenuItemsSideBar_8.IconDropDown,
                    MenuIconDropUp: MenuItemsSideBar_8.IconDropUp,
                    Submenu: []
                },
                {
                    MenuLabel: "Portal",
                    MenuIcon: MenuItemsSideBar_8.IconSettings,
                    MenuScreenNavigate: Dashboard,
                    MenuID: 2,
                    MenuIconDropDown: MenuItemsSideBar_8.IconDropDown,
                    MenuIconDropUp: MenuItemsSideBar_8.IconDropUp,
                    Submenu: Table(
                        {
                            MenuLabel: "'Information of non-listed compan",
                            MenuIcon: MenuItemsSideBar_8.IconDasboard,
                            MenuScreenNavigate: Portal,
                            MenuID: 2.1
                        },
                        {
                            MenuLabel: "Comunication Records (Minutes of meeting)",
                            MenuIcon: MenuItemsSideBar_8.IconDasboard,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 2.2
                        },
                        {
                            MenuLabel: "Investment Research",
                            MenuIcon: MenuItemsSideBar_8.IconDasboard,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 2.3
                        }
                    )
                },
                {
                    MenuLabel: "Business process",
                    MenuIcon: MenuItemsSideBar_8.IconFile,
                    MenuScreenNavigate: Dashboard,
                    MenuID: 3,
                    MenuIconDropDown: MenuItemsSideBar_8.IconDropDown,
                    MenuIconDropUp: MenuItemsSideBar_8.IconDropUp,
                    Submenu: Table(
                        {
                            MenuLabel: "M&A",
                            MenuIcon: MenuItemsSideBar_8.IconFile,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 3.1
                        },
                        {
                            MenuLabel: "Fixed Income Investment ProcessA",
                            MenuIcon: MenuItemsSideBar_8.IconFile,
                            MenuScreenNavigate: TableProposalQT2,
                            MenuID: 3.2
                        },
                        {
                            MenuLabel: "Margin limit approvalprocess (ad-hoc)",
                            MenuIcon: MenuItemsSideBar_8.IconFile,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 3.3
                        },
                        {
                            MenuLabel: "PEVC",
                            MenuIcon: MenuItemsSideBar_8.IconFile,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 3.4
                        }
                    )
                },
                {
                    MenuLabel: "Admin",
                    MenuIcon: MenuItemsSideBar_8.IconSettings,
                    MenuScreenNavigate: Dashboard,
                    MenuID: 4,
                    MenuIconDropDown: MenuItemsSideBar_8.IconDropDown,
                    MenuIconDropUp: MenuItemsSideBar_8.IconDropUp,
                    Submenu: Table(
                        {
                            MenuLabel: "Manager Authoration&A",
                            MenuIcon: MenuItemsSideBar_8.IconFile,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 4.1
                        },
                        {
                            MenuLabel: "Decentralization",
                            MenuIcon: MenuItemsSideBar_8.IconFile,
                            MenuScreenNavigate: TableProposalQT2,
                            MenuID: 4.2
                        }
                    )
                }
            )
        Visible: =MobileShowMenu
        Width: =If(App.Width > 800, 240, App.Width)
        Y: =56
        ZIndex: =22

    MenuItemsSideBar_Small_12 As MenuItemsSideBar_Small:
        Height: =Parent.Height - Self.Y
        MenuItems: |-
            =Table(
                {
                    MenuLabel: "Dashboard",
                    MenuIcon: MenuItemsSideBar_Small_12.IconDasboard,
                    MenuScreenNavigate: Dashboard,
                    MenuID: 1,
                    MenuIconDropDown: MenuItemsSideBar_Small_12.IconDropDown,
                    MenuIconDropUp: MenuItemsSideBar_Small_12.IconDropUp,
                    Submenu: []
                },
                {
                    MenuLabel: "Portal",
                    MenuIcon: MenuItemsSideBar_Small_12.IconSettings,
                    MenuScreenNavigate: Dashboard,
                    MenuID: 2,
                    MenuIconDropDown: MenuItemsSideBar_Small_12.IconDropDown,
                    MenuIconDropUp: MenuItemsSideBar_Small_12.IconDropUp,
                    Submenu: Table(
                        {
                            MenuLabel: "'Information of non-listed compan",
                            MenuIcon: MenuItemsSideBar_Small_12.IconDasboard,
                            MenuScreenNavigate: Portal,
                            MenuID: 2.1
                        },
                        {
                            MenuLabel: "Comunication Records (Minutes of meeting)",
                            MenuIcon: MenuItemsSideBar_Small_12.IconDasboard,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 2.2
                        },
                        {
                            MenuLabel: "Investment Research",
                            MenuIcon: MenuItemsSideBar_Small_12.IconDasboard,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 2.3
                        }
                    )
                },
                {
                    MenuLabel: "Business process",
                    MenuIcon: MenuItemsSideBar_Small_12.IconFile,
                    MenuScreenNavigate: Dashboard,
                    MenuID: 3,
                    MenuIconDropDown: MenuItemsSideBar_Small_12.IconDropDown,
                    MenuIconDropUp: MenuItemsSideBar_Small_12.IconDropUp,
                    Submenu: Table(
                        {
                            MenuLabel: "M&A",
                            MenuIcon: MenuItemsSideBar_Small_12.IconFile,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 3.1
                        },
                        {
                            MenuLabel: "Fixed Income Investment ProcessA",
                            MenuIcon: MenuItemsSideBar_Small_12.IconFile,
                            MenuScreenNavigate: TableProposalQT2,
                            MenuID: 3.2
                        },
                        {
                            MenuLabel: "Margin limit approvalprocess (ad-hoc)",
                            MenuIcon: MenuItemsSideBar_Small_12.IconFile,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 3.3
                        },
                        {
                            MenuLabel: "PEVC",
                            MenuIcon: MenuItemsSideBar_Small_12.IconFile,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 3.4
                        }
                    )
                },
                {
                    MenuLabel: "Admin",
                    MenuIcon: MenuItemsSideBar_Small_12.IconSettings,
                    MenuScreenNavigate: Dashboard,
                    MenuID: 4,
                    MenuIconDropDown: MenuItemsSideBar_Small_12.IconDropDown,
                    MenuIconDropUp: MenuItemsSideBar_Small_12.IconDropUp,
                    Submenu: Table(
                        {
                            MenuLabel: "Manager Authoiation&A",
                            MenuIcon: MenuItemsSideBar_Small_12.IconFile,
                            MenuScreenNavigate: Dashboard,
                            MenuID: 4.1
                        },
                        {
                            MenuLabel: "Decentralization",
                            MenuIcon: MenuItemsSideBar_Small_12.IconFile,
                            MenuScreenNavigate: TableProposalQT2,
                            MenuID: 4.2
                        }
                    )
                }
            )
        Visible: =App.Width > 800 && !MobileShowMenu
        Y: =56
        ZIndex: =23

    SubHeaderGroup_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =42

        SubHeaderBg_2 As rectangle:
            BorderColor: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =56
            Width: =Parent.Width - If(Parent.Width > 800, If(MobileShowMenu, 240, 50), 0)
            X: =If(App.Width > 800, If(MobileShowMenu, 240, 50), 0)
            Y: =56
            ZIndex: =2

        IconBack_2 As icon.ArrowLeft:
            Color: =RGBA(0, 0, 0, 1)
            Height: =If(App.Width > 600, 25, 15)
            Icon: =If(App.Width > 600, Icon.ArrowLeft, Icon.ChevronLeft)
            OnSelect: |-
                =//Reset Field
                If(IsBlank(DealDetailTab), Set(DealDetailTab, 1));
                Navigate(TableInvestmentResearch, ScreenTransition.Fade);
            Width: =If(App.Width > 600, 25, 25)
            X: =SubHeaderBg_2.X + If(App.Width > 800, 5, 0)
            Y: =SubHeaderBg_2.Y + If(App.Width > 600, 16, 20)
            ZIndex: =3

        LabelTitle_1 As label:
            Font: =Font.Arial
            FontWeight: =FontWeight.Bold
            Height: =19
            Size: =If(App.Width > 600, 10.5, 9)
            Text: =If(IsBlank(investmentDetail), If(IsBlank(investmentId), "",investmentId & " - "), investmentDetail.id & " - ") & Substitute(If(Language = "Vn", ReportName_Input_Vn.Text,ReportName_Input.Text),Char(10),",")
            Tooltip: =If(Len(Self.Text) > 100, Self.Text, "")
            Width: |-
                =If( btnDelete_1.Visible, btnDelete_1.X,
                    SaveButton_2.Visible, SaveButton_2.X,
                    btnSubmit_1.Visible, btnSubmit_1.X,
                    btnReject_1.Visible, btnReject_1.X,
                    btnRevise_1.Visible, btnRevise_1.X,
                    btnApprove_1.Visible, btnApprove_1.X,
                    btnPublic.Visible, btnPublic.X,
                    btnSubmit_1.X + btnSubmit_1.Width) - Self.X - 10
            Wrap: =false
            X: =If(App.Width > 600, IconBack_2.X + IconBack_2.Width + 10, BackMobile_Label_2.X + BackMobile_Label_2.Width)
            Y: =IconBack_2.Y - If(App.Width > 600, 5, 8)
            ZIndex: =4

        LabelSubTitle_1 As label:
            Font: =Font.Arial
            Height: =19
            Size: =If(App.Width > 600, 10.5, 9)
            Text: |-
                =If(App.Width > 600, "Last edited user: ", "")& If(IsBlank(investmentDetail), currenUserV2.name
                , If(IsBlank(irDetail.write_by), investmentDetail.write_by, irDetail.write_by) ) &" "& If(IsBlank(investmentDetail), Text(Now(), "dd/mm/yyyy hh:mm:ss"), Text(DateTimeValue(If(IsBlank(irDetail.write_date), investmentDetail.write_date, irDetail.write_date)),"dd/mm/yyyy hh:mm:ss")) &""
            Width: =LabelTitle_1.Width
            Wrap: =false
            X: =LabelTitle_1.X
            Y: =LabelTitle_1.Y + LabelTitle_1.Height
            ZIndex: =5

        SaveButton_2 As htmlViewer:
            BorderStyle: =BorderStyle.Solid
            Font: =Font.Arial
            Height: =50
            HtmlText: |-
                ="<div style=""width: 40px; height: 38px; display: flex; justify-content: center; align-items: center; border: 1px solid black; border-radius: 5px; cursor: pointer""><svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"">
                  <path d=""M21 7V19C21 19.55 20.804 20.021 20.412 20.413C20.02 20.805 19.5493 21.0007 19 21H5C4.45 21 3.979 20.804 3.587 20.412C3.195 20.02 2.99934 19.5493 3 19V5C3 4.45 3.196 3.979 3.588 3.587C3.98 3.195 4.45067 2.99934 5 3H17L21 7ZM19 7.85L16.15 5H5V19H19V7.85ZM12 18C12.8333 18 13.5417 17.7083 14.125 17.125C14.7083 16.5417 15 15.8333 15 15C15 14.1667 14.7083 13.4583 14.125 12.875C13.5417 12.2917 12.8333 12 12 12C11.1667 12 10.4583 12.2917 9.875 12.875C9.29167 13.4583 9 14.1667 9 15C9 15.8333 9.29167 16.5417 9.875 17.125C10.4583 17.7083 11.1667 18 12 18ZM6 10H15V6H6V10ZM5 7.85V19V5V7.85Z"" fill=""#525252""/>
                </svg></div>"
            OnSelect: |-
                =// Setup before select
                UpdateContext({ShowNotification: false});
                ClearCollect(listFiles, []);
                ClearCollect(listFilesDeleted, []);
                ClearCollect(listReportAttachmentInsert, []);
                ClearCollect(listReportAttachFileToSave, []);
                ClearCollect(listReportAttachmentInsertVn, []);
                ClearCollect(listReportAttachFileToSaveVn, []);
                ClearCollect(listOthersAttachmentInsert, []);
                ClearCollect(listOthersAttachFileToSave, []);
                ClearCollect(listOthersAttachmentInsertVn, []);
                ClearCollect(listOthersAttachFileToSaveVn, []);
                
                // Select Button Upload file
                // File Report EN
                Clear(listAttachFileNonPrefix);
                Clear(colAttachments);
                ForAll(ReportAttachFile.Attachments As att,
                        Collect(colAttachments,
                        {   Id:"",
                            Date: nowV1,
                            By: User().FullName,
                            Name: att.Name, 
                            file_name: att.Name,
                            NameGroup: att.Name,
                            Value: att.Value,
                            File: {file: {contentBytes: att.Value,name: att.Name, file_name: Text(Now(), "ddmmyyyy_hhmmss_") & att.Name}},
                            IsDeleted:false,
                            Size: ""
                        }
                    )
                );
                ClearCollect(GroupedItems,GroupBy(colAttachments,NameGroup,Group));
                ForAll(GroupedItems,Collect(listAttachFileNonPrefix,First(ThisRecord.Group)); );
                UpdateIf(listAttachFileNonPrefix, true, {Name: Text(Now(), "ddmmyyyy_hhmmss_") & Name, file_name: Text(Now(), "ddmmyyyy_hhmmss_") & Name});
                Collect(listReportAttachFileToSave,listAttachFileNonPrefix);
                Reset(ReportAttachFile);
                // File Report VN
                Clear(listAttachFileNonPrefix);
                Clear(colAttachments);
                ForAll(ReportAttachFile_Vn.Attachments As att,
                Collect(colAttachments,{Id:"",Date: nowV1,By: User().FullName,Name: att.Name, file_name: att.Name,NameGroup: att.Name,Value: att.Value,File: {file: {contentBytes: att.Value,name: att.Name, file_name: Text(Now(), "ddmmyyyy_hhmmss_") & att.Name}},IsDeleted:false,Size: ""}));
                ClearCollect(GroupedItems,GroupBy(colAttachments,NameGroup,Group));
                ForAll(GroupedItems,Collect(listAttachFileNonPrefix,First(ThisRecord.Group)); );
                UpdateIf(listAttachFileNonPrefix, true, {Name: Text(Now(), "ddmmyyyy_hhmmss_") & Name, file_name: Text(Now(), "ddmmyyyy_hhmmss_") & Name});
                Collect(listReportAttachFileToSaveVn,listAttachFileNonPrefix);
                Reset(ReportAttachFile_Vn);
                // File Others EN
                Clear(listAttachFileNonPrefix);
                Clear(colAttachments);
                ForAll(OthersAttachFile.Attachments As att,
                Collect(colAttachments,{Id:"",Date: nowV1,By: User().FullName,Name: att.Name, file_name: att.Name,NameGroup: att.Name,Value: att.Value,File: {file: {contentBytes: att.Value,name: att.Name, file_name: Text(Now(), "ddmmyyyy_hhmmss_") & att.Name}},IsDeleted:false,Size: ""}));
                ClearCollect(GroupedItems,GroupBy(colAttachments,NameGroup,Group));
                ForAll(GroupedItems,Collect(listAttachFileNonPrefix,First(ThisRecord.Group)); );
                UpdateIf(listAttachFileNonPrefix, true, {Name: Text(Now(), "ddmmyyyy_hhmmss_") & Name, file_name: Text(Now(), "ddmmyyyy_hhmmss_") & Name});
                Collect(listOthersAttachFileToSave,listAttachFileNonPrefix);
                Reset(OthersAttachFile);
                // File Others VN
                Clear(listAttachFileNonPrefix);
                Clear(colAttachments);
                ForAll(OthersAttachFile_Vn.Attachments As att,
                Collect(colAttachments,{Id:"",Date: nowV1,By: User().FullName,Name: att.Name, file_name: att.Name,NameGroup: att.Name,Value: att.Value,File: {file: {contentBytes: att.Value,name: att.Name, file_name: Text(Now(), "ddmmyyyy_hhmmss_") & att.Name}},IsDeleted:false,Size: ""}));
                ClearCollect(GroupedItems,GroupBy(colAttachments,NameGroup,Group));
                ForAll(GroupedItems,Collect(listAttachFileNonPrefix,First(ThisRecord.Group)); );
                UpdateIf(listAttachFileNonPrefix, true, {Name: Text(Now(), "ddmmyyyy_hhmmss_") & Name, file_name: Text(Now(), "ddmmyyyy_hhmmss_") & Name});
                Collect(listOthersAttachFileToSaveVn,listAttachFileNonPrefix);
                Reset(OthersAttachFile_Vn);
                
                // Set File Object to send
                // Report Object EN
                ForAll(listReportAttachFileToSave,If(IsBlank(ThisRecord.Id) && !ThisRecord.IsDeleted,Collect(listReportAttachmentInsert,{id: "",file_name: If(IsBlank(ThisRecord.Name),"",ThisRecord.Name),created_date: If(IsBlank(ThisRecord.Date),"",ThisRecord.Date),created_by: If(IsBlank(ThisRecord.By),"",ThisRecord.By),investment_id: If(IsBlank(investmentDetail),"",investmentDetail.id), type: "RP"});));
                // Report Object VN
                ForAll(listReportAttachFileToSaveVn,If(IsBlank(ThisRecord.Id) && !ThisRecord.IsDeleted,Collect(listReportAttachmentInsertVn,{id: "",file_name: If(IsBlank(ThisRecord.Name),"",ThisRecord.Name),created_date: If(IsBlank(ThisRecord.Date),"",ThisRecord.Date),created_by: If(IsBlank(ThisRecord.By),"",ThisRecord.By),investment_id: If(IsBlank(investmentDetail),"",investmentDetail.id), type: "RPVN"});));
                // Others Object EN
                ForAll(listOthersAttachFileToSave,If(IsBlank(ThisRecord.Id) && !ThisRecord.IsDeleted,Collect(listOthersAttachmentInsert,{id: "",file_name: If(IsBlank(ThisRecord.Name),"",ThisRecord.Name),created_date: If(IsBlank(ThisRecord.Date),"",ThisRecord.Date),created_by: If(IsBlank(ThisRecord.By),"",ThisRecord.By),investment_id: If(IsBlank(investmentDetail),"",investmentDetail.id), type: "ORP"});));
                // Others Object VN
                ForAll(listOthersAttachFileToSaveVn,If(IsBlank(ThisRecord.Id) && !ThisRecord.IsDeleted,Collect(listOthersAttachmentInsertVn,{id: "",file_name: If(IsBlank(ThisRecord.Name),"",ThisRecord.Name),created_date: If(IsBlank(ThisRecord.Date),"",ThisRecord.Date),created_by: If(IsBlank(ThisRecord.By),"",ThisRecord.By),investment_id: If(IsBlank(investmentDetail),"",investmentDetail.id), type: "ORPVN"});));
                
                // Collect List File to JSON
                Collect(listFiles, listReportAttachmentInsert);
                Collect(listFiles, listReportAttachmentInsertVn);
                Collect(listFiles, listOthersAttachmentInsert);
                Collect(listFiles, listOthersAttachmentInsertVn);
                Collect(listFilesDeleted, Filter(listReportAttachFile, IsDeleted));
                Collect(listFilesDeleted, Filter(listOthersAttachFile, IsDeleted));
                Collect(listFilesDeleted, Filter(listReportAttachFileVn, IsDeleted));
                Collect(listFilesDeleted, Filter(listOthersAttachFileVn, IsDeleted));
                
                //Set Object JSON to send
                Set(investmentReq,
                  {
                    report_name: If(IsBlank(ReportName_Input_Vn.Text), "",ReportName_Input_Vn.Text),
                    report_name_en: If(IsBlank(ReportName_Input.Text), "",ReportName_Input.Text),
                    frequency: If(IsBlank(frequencyValue), "", frequencyValue),
                    report_type: If(IsBlank(reportTypeValue), "", reportTypeValue),
                    monthly_report: If(IsBlank(reportMonthValue), "", reportMonthValue),
                    quarterly_report: If(IsBlank(reportQuarterValue), "", reportQuarterValue),
                    annaul_report: If(IsBlank(reportYearValue), "", reportYearValue),
                    status: If(IsBlank(irDetail) || IsBlank(irDetail.status), "DRAFT", If(irDetail.status = "REVISED", "REVISED", "DRAFT")), // Draft BE sẽ k update status
                    report_date: Text(DateValue(Date_Datepicker.SelectedDate), "yyyy-mm-dd"),
                    public: If(IsBlank(reportPrivacyValue), "", reportPrivacyValue),
                    note: If(IsBlank(Note_Input_Vn.Text), "",Note_Input_Vn.Text),
                    note_en: If(IsBlank(Note_Input.Text), "",Note_Input.Text),
                    created_by: If(IsBlank(currenUserV2.id), "", currenUserV2.id),
                    write_by: If(IsBlank(currenUserV2.id), "", currenUserV2.id),
                    type: If(!IsBlank(ReportName_Input_Vn.Text) && !IsBlank(ReportName_Input.Text), "En, Vn", !IsBlank(ReportName_Input_Vn.Text), "Vn", !IsBlank(ReportName_Input.Text), "En", Language),
                    week_report: If(IsBlank(reportWeekValue), "", reportWeekValue),
                    listFiles: AddColumns(listFiles, FilePath, urlUploadRSHead & file_name, Container, bucketRSAttach),
                    listFilesDelete: DropColumns(listFilesDeleted, IsDeleted)
                  }  
                );
                
                Set(isLoading, true);
                Set(investmentSaveRes, 'TVS->CreateUpdateInvestment-V1'.Run(
                    resKeyOpenAll.open,
                    resKeyOpenAll.close,
                    If(IsBlank(currenUserV2.id), "", currenUserV2.id),
                    JSON(investmentReq, JSONFormat.IndentFour),
                    If(IsBlank(investmentDetail), If(IsBlank(investmentId), "", investmentId), investmentDetail.id),
                    envDEV,envTEST, envUAT1, envUAT2, "false"
                ));
                Set(investmentId, investmentSaveRes.idinvestment);
                
                If(investmentSaveRes.status = "200",
                ForAll(listReportAttachFileToSave,If(IsBlank(ThisRecord.Id) && !ThisRecord.IsDeleted,AzureBlobStorage.CreateFile(bucketRSAttach,ThisRecord.file_name,ThisRecord.Value);));
                ForAll(listReportAttachFileToSaveVn,If(IsBlank(ThisRecord.Id) && !ThisRecord.IsDeleted,AzureBlobStorage.CreateFile(bucketRSAttach,ThisRecord.file_name,ThisRecord.Value);));
                ForAll(listOthersAttachFileToSave,If(IsBlank(ThisRecord.Id) && !ThisRecord.IsDeleted,AzureBlobStorage.CreateFile(bucketRSAttach,ThisRecord.file_name,ThisRecord.Value);));
                ForAll(listOthersAttachFileToSaveVn,If(IsBlank(ThisRecord.Id) && !ThisRecord.IsDeleted,AzureBlobStorage.CreateFile(bucketRSAttach,ThisRecord.file_name,ThisRecord.Value);));
                );
                
                If(investmentSaveRes.status = "301",
                        Set(IsError, true);
                        Set(NoticationText,"This proposal has been processed by another user, please reload this page.");
                        UpdateContext({ShowNotification: true});,
                    investmentSaveRes.status = "200",
                        Set(IsError, false);
                        Set(DealDetailTab, 1);
                        Set(NoticationText,"Saved successfully!");
                        UpdateContext({ShowNotification: true});
                );
                Set(isLoading, false);
                
                // Reload files
                If(investmentSaveRes.status = "200",
                    Clear(listOthersAttachFile); Clear(listReportAttachFile); Clear(listReportAttachFileVn); Clear(listOthersAttachFileVn);
                    Set(irDetail, 'TVS->GetByIdInvestmentResearch-V1'.Run(investmentSaveRes.idinvestment, resKeyOpenAll.open, resKeyOpenAll.close, envDEV,envTEST, envUAT1, envUAT2));
                    // Set(investmentDetail, irDetail);
                    If(!IsBlank(irDetail),
                        ClearCollect(listReportAttachFile, AddColumns(Filter(irDetail.listAttach, type = "RP"), IsDeleted, false));
                        ClearCollect(listOthersAttachFile, AddColumns(Filter(irDetail.listAttach, type = "ORP"), IsDeleted, false));
                        ClearCollect(listReportAttachFileVn, AddColumns(Filter(irDetail.listAttach, type = "RPVN"), IsDeleted, false));
                        ClearCollect(listOthersAttachFileVn, AddColumns(Filter(irDetail.listAttach, type = "ORPVN"), IsDeleted, false));
                        ,
                        Clear(listReportAttachFile);
                        Clear(listOthersAttachFile);
                        Clear(listReportAttachFileVn);
                        Clear(listOthersAttachFileVn);
                ));
                Set(inRSNextStatus, Blank());
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Visible: |-
                =((IsBlank(investmentDetail) || (investmentDetail.status in ["DRAFT", "REVISED"] && investmentDetail.created_id = currenUserV2.id))
                && If(IsBlank(investmentDetail), "CREATE", "EDIT") in LookUp(currenUserV2.permissionList, process_code = "Process1.3", action)) ||
                (!IsBlank(investmentDetail) && investmentDetail.status in ["PENDING"] && "APPROVE" in LookUp(currenUserV2.permissionList, process_code = "Process1.3", action))
            Width: =43
            X: =If(btnReject_1.Visible, btnReject_1.X, btnSubmit_1.X) - Self.Width - 8
            Y: =btnReject_1.Y + If(App.Width > 600, 1, 0)
            ZIndex: =6

        btnSubmit_1 As button:
            BorderColor: =Self.Fill
            BorderThickness: =0
            DisabledFill: =Self.Fill
            Fill: =RGBA(17, 79, 144, 1)
            FocusedBorderThickness: =0
            Font: =Font.Arial
            FontWeight: =FontWeight.Normal
            HoverColor: =Self.Color
            HoverFill: =Self.Fill
            OnSelect: |-
                =// Setup before select
                UpdateContext({ShowNotification: false});
                ClearCollect(listFiles, []);
                ClearCollect(listFilesDeleted, []);
                ClearCollect(listReportAttachmentInsert, []);
                ClearCollect(listReportAttachmentDelete, []);
                ClearCollect(listReportAttachFileToSave, []);
                ClearCollect(listReportAttachmentInsertVn, []);
                ClearCollect(listReportAttachmentDeleteVn, []);
                ClearCollect(listReportAttachFileToSaveVn, []);
                ClearCollect(listOthersAttachmentInsert, []);
                ClearCollect(listOthersAttachmentDelete, []);
                ClearCollect(listOthersAttachFileToSave, []);
                ClearCollect(listOthersAttachmentInsertVn, []);
                ClearCollect(listOthersAttachmentDeleteVn, []);
                ClearCollect(listOthersAttachFileToSaveVn, []);
                
                // Select Button Upload file
                // File Report EN
                Clear(listAttachFileNonPrefix);
                Clear(colAttachments);
                ForAll(ReportAttachFile.Attachments As att,
                Collect(colAttachments,{Id:"",Date: nowV1,By: User().FullName,Name: att.Name, file_name: att.Name,NameGroup: att.Name,Value: att.Value,File: {file: {contentBytes: att.Value,name: att.Name, file_name: Text(Now(), "ddmmyyyy_hhmmss_") & att.Name}},IsDeleted:false,Size: ""}));
                ClearCollect(GroupedItems,GroupBy(colAttachments,NameGroup,Group));
                ForAll(GroupedItems,Collect(listAttachFileNonPrefix,First(ThisRecord.Group)); );
                UpdateIf(listAttachFileNonPrefix, true, {Name: Text(Now(), "ddmmyyyy_hhmmss_") & Name, file_name: Text(Now(), "ddmmyyyy_hhmmss_") & Name});
                Collect(listReportAttachFileToSave,listAttachFileNonPrefix);
                Reset(ReportAttachFile);
                // File Report VN
                Clear(listAttachFileNonPrefix);
                Clear(colAttachments);
                ForAll(ReportAttachFile_Vn.Attachments As att,
                Collect(colAttachments,{Id:"",Date: nowV1,By: User().FullName,Name: att.Name, file_name: att.Name,NameGroup: att.Name,Value: att.Value,File: {file: {contentBytes: att.Value,name: att.Name, file_name: Text(Now(), "ddmmyyyy_hhmmss_") & att.Name}},IsDeleted:false,Size: ""}));
                ClearCollect(GroupedItems,GroupBy(colAttachments,NameGroup,Group));
                ForAll(GroupedItems,Collect(listAttachFileNonPrefix,First(ThisRecord.Group)); );
                UpdateIf(listAttachFileNonPrefix, true, {Name: Text(Now(), "ddmmyyyy_hhmmss_") & Name, file_name: Text(Now(), "ddmmyyyy_hhmmss_") & Name});
                Collect(listReportAttachFileToSaveVn,listAttachFileNonPrefix);
                Reset(ReportAttachFile_Vn);
                // File Others EN
                Clear(listAttachFileNonPrefix);
                Clear(colAttachments);
                ForAll(OthersAttachFile.Attachments As att,
                Collect(colAttachments,{Id:"",Date: nowV1,By: User().FullName,Name: att.Name, file_name: att.Name,NameGroup: att.Name,Value: att.Value,File: {file: {contentBytes: att.Value,name: att.Name, file_name: Text(Now(), "ddmmyyyy_hhmmss_") & att.Name}},IsDeleted:false,Size: ""}));
                ClearCollect(GroupedItems,GroupBy(colAttachments,NameGroup,Group));
                ForAll(GroupedItems,Collect(listAttachFileNonPrefix,First(ThisRecord.Group)); );
                UpdateIf(listAttachFileNonPrefix, true, {Name: Text(Now(), "ddmmyyyy_hhmmss_") & Name, file_name: Text(Now(), "ddmmyyyy_hhmmss_") & Name});
                Collect(listOthersAttachFileToSave,listAttachFileNonPrefix);
                Reset(OthersAttachFile);
                // File Others VN
                Clear(listAttachFileNonPrefix);
                Clear(colAttachments);
                ForAll(OthersAttachFile_Vn.Attachments As att,
                Collect(colAttachments,{Id:"",Date: nowV1,By: User().FullName,Name: att.Name, file_name: att.Name,NameGroup: att.Name,Value: att.Value,File: {file: {contentBytes: att.Value,name: att.Name, file_name: Text(Now(), "ddmmyyyy_hhmmss_") & att.Name}},IsDeleted:false,Size: ""}));
                ClearCollect(GroupedItems,GroupBy(colAttachments,NameGroup,Group));
                ForAll(GroupedItems,Collect(listAttachFileNonPrefix,First(ThisRecord.Group)); );
                UpdateIf(listAttachFileNonPrefix, true, {Name: Text(Now(), "ddmmyyyy_hhmmss_") & Name, file_name: Text(Now(), "ddmmyyyy_hhmmss_") & Name});
                Collect(listOthersAttachFileToSaveVn,listAttachFileNonPrefix);
                Reset(OthersAttachFile_Vn);
                
                // Set File Object to send
                // Report Object EN
                ForAll(listReportAttachFileToSave,If(IsBlank(ThisRecord.Id) && !ThisRecord.IsDeleted,Collect(listReportAttachmentInsert,{id: "",file_name: If(IsBlank(ThisRecord.Name),"",ThisRecord.Name),created_date: If(IsBlank(ThisRecord.Date),"",ThisRecord.Date),created_by: If(IsBlank(ThisRecord.By),"",ThisRecord.By),investment_id: If(IsBlank(investmentDetail),"",investmentDetail.id), type: "RP"});));
                // ForAll(listReportAttachDelete,Collect(listReportAttachmentDelete,{id: ThisRecord.Id,file_name: If(IsBlank(ThisRecord.Name),"",ThisRecord.Name),created_date: If(IsBlank(ThisRecord.Date),"",ThisRecord.Date),created_by: If(IsBlank(ThisRecord.By),"",ThisRecord.By),investment_id: If(IsBlank(investmentDetail),"",investmentDetail.id), type: "RP"}););
                // Report Object VN
                ForAll(listReportAttachFileToSaveVn,If(IsBlank(ThisRecord.Id) && !ThisRecord.IsDeleted,Collect(listReportAttachmentInsertVn,{id: "",file_name: If(IsBlank(ThisRecord.Name),"",ThisRecord.Name),created_date: If(IsBlank(ThisRecord.Date),"",ThisRecord.Date),created_by: If(IsBlank(ThisRecord.By),"",ThisRecord.By),investment_id: If(IsBlank(investmentDetail),"",investmentDetail.id), type: "RPVN"});));
                // Need to add delete
                
                // Others Object EN
                ForAll(listOthersAttachFileToSave,If(IsBlank(ThisRecord.Id) && !ThisRecord.IsDeleted,Collect(listOthersAttachmentInsert,{id: "",file_name: If(IsBlank(ThisRecord.Name),"",ThisRecord.Name),created_date: If(IsBlank(ThisRecord.Date),"",ThisRecord.Date),created_by: If(IsBlank(ThisRecord.By),"",ThisRecord.By),investment_id: If(IsBlank(investmentDetail),"",investmentDetail.id), type: "ORP"});));
                // Others Object VN
                ForAll(listOthersAttachFileToSaveVn,If(IsBlank(ThisRecord.Id) && !ThisRecord.IsDeleted,Collect(listOthersAttachmentInsertVn,{id: "",file_name: If(IsBlank(ThisRecord.Name),"",ThisRecord.Name),created_date: If(IsBlank(ThisRecord.Date),"",ThisRecord.Date),created_by: If(IsBlank(ThisRecord.By),"",ThisRecord.By),investment_id: If(IsBlank(investmentDetail),"",investmentDetail.id), type: "ORPVN"});));
                // Need to add delete
                
                // Collect List File to JSON
                Collect(listFiles, listReportAttachmentInsert);
                Collect(listFiles, listReportAttachmentInsertVn);
                Collect(listFiles, listOthersAttachmentInsert);
                Collect(listFiles, listOthersAttachmentInsertVn);
                Collect(listFilesDeleted, listReportAttachmentDelete);
                Collect(listFilesDeleted, listReportAttachmentDeleteVn);
                Collect(listFilesDeleted, listOthersAttachmentDelete);
                Collect(listFilesDeleted, listOthersAttachmentDeleteVn);
                
                //Set Object JSON to send
                Set(investmentReq,
                  {
                    report_name: If(IsBlank(Trim(ReportName_Input_Vn.Text)), "", Trim(ReportName_Input_Vn.Text)),
                    report_name_en: If(IsBlank(Trim(ReportName_Input.Text)), "", Trim(ReportName_Input.Text)),
                    frequency: If(IsBlank(frequencyValue), "", frequencyValue),
                    report_type: If(IsBlank(reportTypeValue), "", reportTypeValue),
                    monthly_report: If(IsBlank(reportMonthValue), "", reportMonthValue),
                    quarterly_report: If(IsBlank(reportQuarterValue), "", reportQuarterValue),
                    annaul_report: If(IsBlank(reportYearValue), "", reportYearValue),
                    status: "PENDING",
                    report_date: Text(DateValue(Date_Datepicker.SelectedDate), "yyyy-mm-dd"),
                    public: If(IsBlank(reportPrivacyValue), "", reportPrivacyValue),
                    note: If(IsBlank(Note_Input_Vn.Text), "",Note_Input_Vn.Text),
                    note_en: If(IsBlank(Note_Input.Text), "",Note_Input.Text),
                    created_by: If(IsBlank(currenUserV2.id), "7489663a-c37f-4ee0-9d6d-9c6d9e3d8e33", currenUserV2.id),
                    write_by: If(IsBlank(currenUserV2.id), "7489663a-c37f-4ee0-9d6d-9c6d9e3d8e33", currenUserV2.id),
                    type: If(!IsBlank(ReportName_Input_Vn.Text) && !IsBlank(ReportName_Input.Text), "En, Vn", !IsBlank(ReportName_Input_Vn.Text), "Vn", !IsBlank(ReportName_Input.Text), "En", Language),
                    week_report: If(IsBlank(reportWeekValue), "", reportWeekValue),
                    listFiles: AddColumns(listFiles, FilePath, urlUploadRSHead & file_name, Container, bucketRSAttach),
                    listFilesDelete: listFilesDeleted
                  }
                );
                
                If(
                    IsBlank(Trim(ReportName_Input.Text)) && IsBlank(Trim(ReportName_Input_Vn.Text)), Set(IsError, true); Set(NoticationText,"Report name is required!"); UpdateContext({ShowNotification: true});,
                    IsBlank(frequencyValue), Set(IsError, true); Set(NoticationText,"Frequency is required!"); UpdateContext({ShowNotification: true});,
                    IsBlank(reportTypeValue), Set(IsError, true); Set(NoticationText,"Report type is required!"); UpdateContext({ShowNotification: true});,
                    IsEmpty(listFiles) && IsEmpty(listReportAttachFile) && IsEmpty(listOthersAttachFile) && IsEmpty(listReportAttachFileVn) && IsEmpty(listOthersAttachFileVn),
                    Set(IsError, true); Set(NoticationText,"Attach file is required!"); UpdateContext({ShowNotification: true});,
                    // Validated
                    Set(isLoading, true);
                        // Upload file
                        ForAll(listReportAttachFileToSave,If(IsBlank(ThisRecord.Id) && !ThisRecord.IsDeleted,AzureBlobStorage.CreateFile(bucketRSAttach,ThisRecord.file_name,ThisRecord.Value);));
                        ForAll(listReportAttachFileToSaveVn,If(IsBlank(ThisRecord.Id) && !ThisRecord.IsDeleted,AzureBlobStorage.CreateFile(bucketRSAttach,ThisRecord.file_name,ThisRecord.Value);));
                        ForAll(listOthersAttachFileToSave,If(IsBlank(ThisRecord.Id) && !ThisRecord.IsDeleted,AzureBlobStorage.CreateFile(bucketRSAttach,ThisRecord.file_name,ThisRecord.Value);));
                        ForAll(listOthersAttachFileToSaveVn,If(IsBlank(ThisRecord.Id) && !ThisRecord.IsDeleted,AzureBlobStorage.CreateFile(bucketRSAttach,ThisRecord.file_name,ThisRecord.Value);));
                        // Call API create/update
                        Set(investmentSaveRes, 'TVS->CreateUpdateInvestment-V1'.Run(resKeyOpenAll.open,resKeyOpenAll.close,If(IsBlank(currenUserV2.id), "", currenUserV2.id),JSON(investmentReq, JSONFormat.IndentFour),
                        If(IsBlank(investmentDetail), If(IsBlank(investmentId), "", investmentId), investmentDetail.id),envDEV,envTEST, envUAT1, envUAT2, "true"));
                        Set(isLoading, false);
                        Set(investmentId, investmentSaveRes.idinvestment);
                
                    // FE show notification and navigate
                    If(investmentSaveRes.status = "301",
                        Set(IsError, true);
                        Set(NoticationText,"This proposal has been processed by another user, please reload this page.");
                        UpdateContext({ShowNotification: true});
                    );
                    Set(ShowNotificationCheck,
                        If(investmentSaveRes.status = "200",
                        If(!IsBlank(investmentDetail),"UPDATED_SUCCESS","CREATED_SUCCESS"),
                        If(investmentSaveRes.status = "301", "", "SYSTEM_ERROR"))
                    );
                    If(investmentSaveRes.status = "200", Set(DealDetailTab, 1); Navigate(TableInvestmentResearch, ScreenTransition.Fade));
                
                    // Call send mail and noti
                    If(investmentSaveRes.status = "200",
                        'TVS->SendNotiEmail-Process1.3-V1'.Run(
                            resKeyOpenAll.open,resKeyOpenAll.close,
                            "PENDING",
                            investmentSaveRes.idinvestment,
                            If(IsBlank(ReportName_Input.Text), If(IsBlank(ReportName_Input_Vn.Text), "", Trim(ReportName_Input_Vn.Text)), Trim(ReportName_Input.Text)),
                            "<a href='" & linkToApp & "?screen=detail-ir&action=approve-ir&ir_id=" & investmentSaveRes.idinvestment & "'>Link to item</a>",
                            currenUserV2.name,
                            envDEV,envTEST, envUAT1, envUAT2,
                            If(IsBlank(investmentDetail.created_id), currenUserV2.id, investmentDetail.created_id),
                            currenUserV2.id,
                            appProperty, emailFromConfix, If(IsBlank(investmentDetail.status),"",investmentDetail.status),""
                        );
                    )
                );
            PaddingLeft: =30
            PressedColor: =Self.Color
            PressedFill: =Self.Fill
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Size: =10.5
            TabIndex: =1
            Text: =If(App.Width > 800, If(Language = "Vn", "Gửi duyệt", "Submit"), "")
            Visible: =(IsBlank(investmentDetail) || (investmentDetail.status in ["DRAFT", "REVISED"] && investmentDetail.created_id = currenUserV2.id)) && ("EDIT" in LookUp(currenUserV2.permissionList, process_code = "Process1.3", action) || "CREATE" in LookUp(currenUserV2.permissionList, process_code = "Process1.3", action))
            Width: =If(App.Width > 800, 100, 40)
            X: =App.Width - Self.Width - If(App.Width > 800, 35, 15)
            Y: =Header_22.Y + Header_22.Height + 8
            ZIndex: =7

        btnSubmitIcon_1 As htmlViewer:
            Font: =Font.Arial
            HtmlText: |-
                ="<div style=""width: 40px; height: 38px; display: flex; justify-content: center; align-items: center; cursor: pointer""><svg xmlns=""http://www.w3.org/2000/svg"" width=""25"" height=""24"" viewBox=""0 0 25 24"" fill=""none"">
                  <path d=""M5 2.25V21.75H20V7.2L19.775 6.975L15.275 2.475L15.05 2.25H5ZM6.5 3.75H14V8.25H18.5V20.25H6.5V3.75ZM15.5 4.8L17.45 6.75H15.5V4.8ZM12.5 9.75L9.5 12.75H11.75V16.5H13.25V12.75H15.5L12.5 9.75ZM9.5 17.25V18.75H15.5V17.25H9.5Z"" fill=""#FEFEFE""/>
                </svg></div>"
            OnSelect: =Select(btnSubmit_1);
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Visible: =(IsBlank(investmentDetail) || (investmentDetail.status in ["DRAFT", "REVISED"] && investmentDetail.created_id = currenUserV2.id)) && ("EDIT" in LookUp(currenUserV2.permissionList, process_code = "Process1.3", action) || "CREATE" in LookUp(currenUserV2.permissionList, process_code = "Process1.3", action))
            Width: =40
            X: =btnSubmit_1.X
            Y: =btnSubmit_1.Y
            ZIndex: =8

        btnApprove_1 As button:
            BorderColor: =Self.Fill
            BorderThickness: =0
            DisabledFill: =Self.Fill
            Fill: =RGBA(17, 79, 144, 1)
            FocusedBorderThickness: =0
            Font: =Font.Arial
            FontWeight: =FontWeight.Normal
            HoverColor: =Self.Color
            HoverFill: =Self.Fill
            OnSelect: |-
                =Set(showApprovePopup, true);
                Set(isSummitedPopup, false);
                Reset(DetailIRReason_Input);
            PaddingLeft: =30
            PressedColor: =Self.Color
            PressedFill: =Self.Fill
            RadiusBottomLeft: =5
            RadiusBottomRight: =5
            RadiusTopLeft: =5
            RadiusTopRight: =5
            Size: =10.5
            TabIndex: =1
            Text: =If(App.Width > 800, If(Language = "Vn", "Duyệt ", "Approve"), "")
            Visible: |-
                =(!IsBlank(investmentDetail) && investmentDetail.status in ["PENDING"] && "APPROVE" in LookUp(currenUserV2.permissionList, process_code = "Process1.3", action)) ||
                (!IsBlank(investmentDetail) && investmentDetail.status in ["PENDING_DCEO"] && "DCEO_APPROVE" in LookUp(currenUserV2.permissionList, process_code = "Process1.3", action))
            Width: =If(App.Width > 800, 90, 40)
            X: =App.Width - Self.Width - If(App.Width > 800, 35, 15)
            Y: =Header_22.Y + Header_22.Height + 8
            ZIndex: =9

        ApproveIcon_1 As htmlViewer:
            Font: =Font.Arial
            HtmlText: |-
                ="<div style=""width: 40px; height: 38px; display: flex; justify-content: center; align-items: center; cursor: pointer""><svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"">
                  <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M21.546 5.11155C21.8272 5.39285 21.9852 5.77431 21.9852 6.17205C21.9852 6.5698 21.8272 6.95126 21.546 7.23255L10.303 18.4756C10.1544 18.6242 9.97805 18.7421 9.7839 18.8225C9.58976 18.9029 9.38167 18.9443 9.17153 18.9443C8.96138 18.9443 8.75329 18.9029 8.55915 18.8225C8.365 18.7421 8.1886 18.6242 8.04003 18.4756L2.45403 12.8906C2.31076 12.7522 2.19649 12.5867 2.11787 12.4037C2.03926 12.2207 1.99788 12.0238 1.99615 11.8247C1.99442 11.6255 2.03237 11.428 2.10779 11.2436C2.18322 11.0593 2.29459 10.8918 2.43543 10.751C2.57627 10.6101 2.74375 10.4987 2.92809 10.4233C3.11244 10.3479 3.30996 10.3099 3.50913 10.3117C3.7083 10.3134 3.90513 10.3548 4.08813 10.4334C4.27114 10.512 4.43666 10.6263 4.57503 10.7696L9.17103 15.3656L19.424 5.11155C19.5633 4.97216 19.7287 4.86159 19.9108 4.78615C20.0928 4.71071 20.288 4.67188 20.485 4.67188C20.6821 4.67188 20.8772 4.71071 21.0593 4.78615C21.2413 4.86159 21.4067 4.97216 21.546 5.11155Z"" fill=""#FEFEFE""/>
                </svg></div>"
            OnSelect: |-
                =Set(showApprovePopup, true);
                Set(isSummitedPopup, false);
                Reset(DetailIRReason_Input);
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Visible: =btnApprove_1.Visible
            Width: =40
            X: =btnApprove_1.X
            Y: =btnApprove_1.Y
            ZIndex: =10

        btnRevise_1 As button:
            BorderColor: =Self.Fill
            BorderThickness: =0
            DisabledFill: =Self.Fill
            Fill: =RGBA(214, 117, 27, 1)
            FocusedBorderThickness: =0
            Font: =Font.Arial
            FontWeight: =FontWeight.Normal
            HoverColor: =Self.Color
            HoverFill: =Self.Fill
            OnSelect: |-
                =Set(showRevisePopup, true);
                Set(isSummitedPopup, false);
                Reset(DetailIRReason_Input);
            PaddingLeft: =30
            PressedColor: =Self.Color
            PressedFill: =Self.Fill
            RadiusBottomLeft: =5
            RadiusBottomRight: =5
            RadiusTopLeft: =5
            RadiusTopRight: =5
            Size: =10.5
            TabIndex: =1
            Text: =If(App.Width > 800,  If(Language = "Vn", "Trả lại ", "Revise"), "")
            Visible: =btnApprove_1.Visible
            Width: =If(App.Width > 800, 90, 40)
            X: =btnApprove_1.X - 8 - Self.Width
            Y: =Header_22.Y + Header_22.Height + 8
            ZIndex: =11

        ReviseIcon_1 As htmlViewer:
            Font: =Font.Arial
            HtmlText: |-
                ="<div style=""width: 40px; height: 38px; display: flex; justify-content: center; align-items: center; cursor: pointer""><svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"">
                  <path d=""M9.505 21H4.5C4.10218 21 3.72064 20.842 3.43934 20.5607C3.15804 20.2794 3 19.8978 3 19.5V4.5C3 4.10218 3.15804 3.72064 3.43934 3.43934C3.72064 3.15804 4.10218 3 4.5 3H19.5C19.8978 3 20.2794 3.15804 20.5607 3.43934C20.842 3.72064 21 4.10218 21 4.5V9.515M14.5185 21H20.5C20.6326 21 20.7598 20.9473 20.8536 20.8536C20.9473 20.7598 21 20.6326 21 20.5V14.5175H9"" stroke=""white"" stroke-width=""2"" stroke-linecap=""round"" stroke-linejoin=""round""/>
                  <path d=""M11.5 11.5L8.5 14.5L11.5 17.5"" stroke=""white"" stroke-width=""2"" stroke-linecap=""round"" stroke-linejoin=""round""/>
                </svg></div>"
            OnSelect: |-
                =Set(showRevisePopup, true);
                Set(isSummitedPopup, false);
                Reset(DetailIRReason_Input);
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Visible: =btnRevise_1.Visible
            Width: =40
            X: =btnRevise_1.X + If(App.Width > 600, 2, 0)
            Y: =btnRevise_1.Y
            ZIndex: =12

        btnReject_1 As button:
            BorderColor: =Self.Fill
            BorderThickness: =0
            DisabledFill: =Self.Fill
            Fill: =RGBA(214, 27, 27, 1)
            FocusedBorderThickness: =0
            Font: =Font.Arial
            FontWeight: =FontWeight.Normal
            HoverColor: =Self.Color
            HoverFill: =Self.Fill
            OnSelect: |-
                =Set(showRejectPopup, true);
                Set(isSummitedPopup, false);
                Reset(DetailIRReason_Input);
            PaddingLeft: =30
            PressedColor: =Self.Color
            PressedFill: =Self.Fill
            RadiusBottomLeft: =5
            RadiusBottomRight: =5
            RadiusTopLeft: =5
            RadiusTopRight: =5
            Size: =10.5
            TabIndex: =1
            Text: =If(App.Width > 800,  If(Language = "Vn", "Từ chối ", "Reject"), "")
            Visible: =btnApprove_1.Visible
            Width: =If(App.Width > 800, 90, 40)
            X: =If(true, btnRevise_1.X, btnApprove_1.X) - Self.Width - 8
            Y: =Header_22.Y + Header_22.Height + 8
            ZIndex: =13

        RejectIcon_1 As icon.CancelBadge:
            Color: =RGBA(255, 255, 255, 1)
            Height: =20
            Icon: =Icon.CancelBadge
            OnSelect: |-
                =Set(showRejectPopup, true);
                Set(isSummitedPopup, false);
                Reset(DetailIRReason_Input);
            Visible: =btnReject_1.Visible
            Width: =20
            X: =btnReject_1.X + If(App.Width > 600, 10, 10)
            Y: =btnReject_1.Y + 10
            ZIndex: =14

        SubHeaderHr_2 As rectangle:
            Fill: =RGBA(191, 191, 192, 1)
            Height: =IconBack_2.Height + 10
            Visible: =App.Width > 600
            Width: =0.5
            X: =IconBack_2.X + IconBack_2.Width + 5
            Y: =IconBack_2.Y - 5
            ZIndex: =15

        BackMobile_Label_2 As label:
            Font: =Font.Arial
            Height: =30
            OnSelect: =Navigate(TableProposalQT2, ScreenTransition.Fade)
            Size: =10.5
            Text: ="Back"
            Visible: =App.Width < 600
            Width: =0
            X: =IconBack_2.X + IconBack_2.Width
            Y: =IconBack_2.Y - 7
            ZIndex: =16

        btnDelete_1 As button:
            BorderColor: =RGBA(255, 0, 0, 1)
            BorderThickness: =1
            DisabledFill: =Self.Fill
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =0
            Font: =Font.Arial
            FontWeight: =FontWeight.Normal
            Height: =39
            HoverColor: =Self.Color
            HoverFill: =Self.Fill
            OnSelect: |-
                =//Set(deleteStatus, 'TVS->DeleteInvestmentResearch'.Run(resKeyOpenAll.open, resKeyOpenAll.close, If(IsBlank(currenUserV2.id), "", currenUserV2.id), investmentDetail.id, //env).status);
                //If(deleteStatus = "200", Navigate(TableInvestmentResearch, ScreenTransition.Fade));
                Set(idProposalDelete, If(IsBlank(proposalInfoEdit), investmentId, proposalInfoEdit.id));
                Set(isShowPopupDelete, true);
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingTop: =0
            PressedColor: =Self.Color
            PressedFill: =Self.Fill
            RadiusBottomLeft: =5
            RadiusBottomRight: =5
            RadiusTopLeft: =5
            RadiusTopRight: =5
            Size: =10.5
            TabIndex: =1
            Text: =""
            Visible: =((!IsBlank(investmentDetail) && investmentDetail.status = "DRAFT" && investmentDetail.created_id = currenUserV2.id) || If(IsBlank(investmentDetail), !IsBlank(investmentId), !IsBlank(investmentId) && investmentDetail.status = "DRAFT")) && "DELETE" in LookUp(currenUserV2.permissionList,process_code = "Process1.3",action)
            Width: =40
            X: =If(SaveButton_2.Visible, SaveButton_2.X - 8 - Self.Width, btnSubmit_1.X - 8 - Self.Width)
            Y: =btnSubmit_1.Y
            ZIndex: =17

        DeleteIcon_1 As htmlViewer:
            Font: =Font.Arial
            Height: =42
            HtmlText: |-
                ="<div style=""cursor:pointer; width:40px; height: 37px; display:flex; justify-content:center; align-items:center""><svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 16 16"" fill=""none"">
                  <path d=""M4.66683 2.66634C4.66683 2.31272 4.8073 1.97358 5.05735 1.72353C5.3074 1.47348 5.64654 1.33301 6.00016 1.33301H10.0002C10.3538 1.33301 10.6929 1.47348 10.943 1.72353C11.193 1.97358 11.3335 2.31272 11.3335 2.66634V3.99967H14.0002C14.177 3.99967 14.3465 4.06991 14.4716 4.19494C14.5966 4.31996 14.6668 4.48953 14.6668 4.66634C14.6668 4.84315 14.5966 5.01272 14.4716 5.13775C14.3465 5.26277 14.177 5.33301 14.0002 5.33301H13.2875L12.7095 13.4277C12.6856 13.7641 12.535 14.0789 12.2882 14.3087C12.0415 14.5386 11.7167 14.6663 11.3795 14.6663H4.62016C4.28292 14.6663 3.95821 14.5386 3.71142 14.3087C3.46463 14.0789 3.31411 13.7641 3.29016 13.4277L2.7135 5.33301H2.00016C1.82335 5.33301 1.65378 5.26277 1.52876 5.13775C1.40373 5.01272 1.3335 4.84315 1.3335 4.66634C1.3335 4.48953 1.40373 4.31996 1.52876 4.19494C1.65378 4.06991 1.82335 3.99967 2.00016 3.99967H4.66683V2.66634ZM6.00016 3.99967H10.0002V2.66634H6.00016V3.99967ZM4.0495 5.33301L4.62083 13.333H11.3802L11.9515 5.33301H4.0495ZM6.66683 6.66634C6.84364 6.66634 7.01321 6.73658 7.13823 6.8616C7.26326 6.98663 7.3335 7.1562 7.3335 7.33301V11.333C7.3335 11.5098 7.26326 11.6794 7.13823 11.8044C7.01321 11.9294 6.84364 11.9997 6.66683 11.9997C6.49002 11.9997 6.32045 11.9294 6.19542 11.8044C6.0704 11.6794 6.00016 11.5098 6.00016 11.333V7.33301C6.00016 7.1562 6.0704 6.98663 6.19542 6.8616C6.32045 6.73658 6.49002 6.66634 6.66683 6.66634ZM9.3335 6.66634C9.51031 6.66634 9.67988 6.73658 9.8049 6.8616C9.92992 6.98663 10.0002 7.1562 10.0002 7.33301V11.333C10.0002 11.5098 9.92992 11.6794 9.8049 11.8044C9.67988 11.9294 9.51031 11.9997 9.3335 11.9997C9.15668 11.9997 8.98712 11.9294 8.86209 11.8044C8.73707 11.6794 8.66683 11.5098 8.66683 11.333V7.33301C8.66683 7.1562 8.73707 6.98663 8.86209 6.8616C8.98712 6.73658 9.15668 6.66634 9.3335 6.66634Z"" fill=""#D00C0C""/>
                </svg></div>"
            OnSelect: |-
                =//Set(deleteStatus, 'TVS->DeleteInvestmentResearch'.Run(resKeyOpenAll.open, resKeyOpenAll.close, If(IsBlank(currenUserV2.id), "", currenUserV2.id), investmentDetail.id, //env).status);
                //If(deleteStatus = "200", Navigate(TableInvestmentResearch, ScreenTransition.Fade));
                Set(idProposalDelete, If(IsBlank(proposalInfoEdit), investmentId, proposalInfoEdit.id));
                Set(isShowPopupDelete, true);
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Visible: =((!IsBlank(investmentDetail) && investmentDetail.status = "DRAFT" && investmentDetail.created_id = currenUserV2.id) || If(IsBlank(investmentDetail), !IsBlank(investmentId), !IsBlank(investmentId) && investmentDetail.status = "DRAFT")) && "DELETE" in LookUp(currenUserV2.permissionList,process_code = "Process1.3",action)
            Width: =42
            X: =btnDelete_1.X
            Y: =btnDelete_1.Y
            ZIndex: =18

        btnPublic As button:
            BorderColor: =Self.Fill
            BorderThickness: =0
            DisabledFill: =Self.Fill
            Fill: =RGBA(17, 79, 144, 1)
            FocusedBorderThickness: =0
            Font: =Font.Arial
            FontWeight: =FontWeight.Normal
            HoverColor: =Self.Color
            HoverFill: =Self.Fill
            OnSelect: |-
                =Set(showPublishPopup, true);
                Set(isSummitedPopup, false);
                ClearCollect(listFileToPublish, []);
                ClearCollect(listFileTotal,listOthersAttachFile,listReportAttachFile,listOthersAttachFileVn,listReportAttachFileVn);
                Reset(DetailIRReason_Input);
                Reset(PublishIRMailEmails_Input);
                Reset(PublishIRMailSubject_Input);
                Reset(PublishIRMailContent_Input);
            PaddingLeft: =30
            PressedColor: =Self.Color
            PressedFill: =Self.Fill
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Size: =10.5
            Text: =If(App.Width > 800, If(Language = "Vn", "Công bố", "Publish"), "")
            Visible: =(!IsBlank(investmentDetail) && investmentDetail.status in ["APPROVED", "APPROVE", "PUBLISHED"]) && !irLoading
            Width: =If(App.Width > 800, 90, 40)
            X: =App.Width - Self.Width - If(App.Width > 800, 40, 15)
            Y: =Header_22.Y + Header_22.Height + 8
            ZIndex: =19

        PublicIcon As htmlViewer:
            Font: =Font.Arial
            HtmlText: |-
                ="<div style=""width: 40px; height: 38px; display: flex; justify-content: center; align-items: center; cursor: pointer""><svg xmlns=""http://www.w3.org/2000/svg"" width=""25"" height=""24"" viewBox=""0 0 25 24"" fill=""none"">
                  <path d=""M5 2.25V21.75H20V7.2L19.775 6.975L15.275 2.475L15.05 2.25H5ZM6.5 3.75H14V8.25H18.5V20.25H6.5V3.75ZM15.5 4.8L17.45 6.75H15.5V4.8ZM12.5 9.75L9.5 12.75H11.75V16.5H13.25V12.75H15.5L12.5 9.75ZM9.5 17.25V18.75H15.5V17.25H9.5Z"" fill=""#FEFEFE""/>
                </svg></div>"
            OnSelect: |-
                =Set(showPublishPopup, true);
                Set(isSummitedPopup, false);
                ClearCollect(listFileToPublish, []);
                ClearCollect(listFileTotal,listOthersAttachFile,listReportAttachFile,listOthersAttachFileVn,listReportAttachFileVn);
                Reset(DetailIRReason_Input);
                Reset(PublishIRMailEmails_Input);
                Reset(PublishIRMailSubject_Input);
                Reset(PublishIRMailContent_Input);
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Visible: =(!IsBlank(investmentDetail) && investmentDetail.status in ["APPROVED", "APPROVE", "PUBLISHED"]) && !irLoading
            Width: =40
            X: =btnPublic.X
            Y: =btnPublic.Y
            ZIndex: =20

    DetailIRPopupGroup As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =44

        DetailIRPopupBack As rectangle:
            Fill: =RGBA(0.3, 0.3, 0.3, 0.3)
            Height: =App.Height
            Visible: =showRejectPopup || showApprovePopup || showRevisePopup
            Width: =App.Width
            ZIndex: =32

        DetailIRPopupBg As htmlViewer:
            Font: =Font.Arial
            Height: =330
            HtmlText: |-
                ="<div style='width: calc(100% - 10px); height: "& Self.Height - 20 &"px; background-color: white; border-radius: 12px;box-shadow: 5px 4px 8px 0px rgba(0, 0, 0, 0.10);
                '></div>"
            PaddingRight: =5.00
            PaddingTop: =5.00
            Size: =11.00
            Visible: =showRejectPopup || showApprovePopup || showRevisePopup
            Width: =If(Parent.Width > 600, 600, Parent.Width)
            X: =If(Parent.Width > 600, App.Width / 2 - Self.Width / 2, 5)
            Y: =(App.Height - Self.Height) / 2
            ZIndex: =33

        DetailIR_Title As label:
            Font: =Font.Arial
            FontWeight: =FontWeight.Bold
            Height: =43
            LineHeight: =2.2
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =12
            Text: |-
                =If(showRejectPopup,
                If(Language = "Vn", "Bạn muốn từ chối bản ghi này?", "Reject this record?"),
                showRevisePopup, If(Language = "Vn", "Bạn muốn trả lại bản ghi này?", "Revise this record?"),
                showPublishPopup, If(Language = "Vn", "Bạn muốn công bố bản ghi này?", "Publish this record?"),
                If(Language = "Vn", "Bạn muốn duyệt bản ghi này?", "Approve this record?"))
            Visible: =showRejectPopup || showApprovePopup || showRevisePopup
            Width: =299
            X: =DetailIRPopupBg.X + 20
            Y: =DetailIRPopupBg.Y + 10
            ZIndex: =34

        DetailIRName_Title As label:
            Font: =Font.Arial
            Height: =43
            LineHeight: =2.2
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10.5
            Text: =If(Language = "Vn", "Nhập bình luận ", "Add your comment")
            Visible: =showRejectPopup || showApprovePopup || showRevisePopup
            Width: =159
            X: =DetailIR_Title.X
            Y: =DetailIR_Title.Y + DetailIR_Title.Height
            ZIndex: =35

        DetailIRReason_Input As text:
            BorderColor: |-
                =// If(isSummitedPopup && Len(Self.Text) = 0, RGBA(214, 27, 27, 1), RGBA(191, 191, 192, 1))
                RGBA(191, 191, 192, 1)
            BorderThickness: =1
            Default: =
            FocusedBorderColor: =Self.HoverBorderColor
            FocusedBorderThickness: =1
            Font: =Font.Arial
            Height: =If(App.Width > 600, 140, 120)
            HintText: =If(Language = "Vn", "Nhập bình luận.", "Input your comment.")
            HoverFill: =RGBA(186, 202, 226, 0)
            Mode: =TextMode.MultiLine
            Size: =If(App.Width > 600, 10.5, 12)
            Visible: =showRejectPopup || showApprovePopup || showRevisePopup
            Width: =DetailIRPopupBg.Width - 50
            X: =DetailIRName_Title.X
            Y: =DetailIRName_Title.Y + DetailIRName_Title.Height
            ZIndex: =36

        DetailIRSubmitButton As button:
            BorderThickness: =0
            Fill: =If(showRejectPopup, RGBA(214, 27, 27, 1), showRevisePopup, RGBA(214, 117, 27, 1), RGBA(17, 79, 144, 1))
            FocusedBorderThickness: =0
            Font: =Font.Arial
            FontWeight: =FontWeight.Normal
            Height: =44
            HoverFill: =ColorFade(Self.Fill , -15%)
            OnSelect: |-
                =Set(isLoading, true);
                Set(inRSNextStatus, Blank());
                Set(investmentUpdateStatusRes, Blank());
                If(
                    showRejectPopup,
                    If(
                        // Len(DetailIRReason_Input.Text) <> 0,
                        true,
                        Set(investmentUpdateStatusRes, 'TVS->ApproveRejectProcess1.3Investment-V1'.Run(
                            resKeyOpenAll.open,resKeyOpenAll.close,investmentDetail.id,investmentDetail.status,
                            "REJECTED",envDEV,envTEST, envUAT1, envUAT2,
                            If(IsBlank(DetailIRReason_Input.Text), "", DetailIRReason_Input.Text),currenUserV2.id
                        ));
                    );,
                    showRevisePopup,
                    If(
                        // Len(DetailIRReason_Input.Text) <> 0,
                        true,
                        Set(investmentUpdateStatusRes, 'TVS->ApproveRejectProcess1.3Investment-V1'.Run(
                            resKeyOpenAll.open,resKeyOpenAll.close,investmentDetail.id,investmentDetail.status,
                            "REVISED",envDEV,envTEST, envUAT1, envUAT2,
                            If(IsBlank(DetailIRReason_Input.Text), "", DetailIRReason_Input.Text),currenUserV2.id
                        ));
                    );,
                    showApprovePopup,
                    Set(investmentUpdateStatusRes, 'TVS->ApproveRejectProcess1.3Investment-V1'.Run(
                        resKeyOpenAll.open,resKeyOpenAll.close,investmentDetail.id,investmentDetail.status,
                            "APPROVED",envDEV,envTEST, envUAT1, envUAT2,
                            If(IsBlank(DetailIRReason_Input.Text), "", DetailIRReason_Input.Text),currenUserV2.id
                        ));
                    ,
                    showPublishPopup,
                    Set(investmentUpdateStatusRes, 'TVS->ApproveRejectProcess1.3Investment-V1'.Run(
                            resKeyOpenAll.open,resKeyOpenAll.close,investmentDetail.id,investmentDetail.status,
                            "PUBLISHED",envDEV,envTEST, envUAT1, envUAT2,
                            If(IsBlank(DetailIRReason_Input.Text), "", DetailIRReason_Input.Text),currenUserV2.id
                        ));
                );
                
                If(investmentUpdateStatusRes.status = "301",
                        Set(IsError, true);
                        Set(NoticationText,"This record has been processed by another user, please reload this page.");
                        Set(showRejectPopup, false); Set(showApprovePopup, false); Set(showRevisePopup, false); Set(showPublishPopup, false);
                        UpdateContext({ShowNotification: true});
                );
                
                // Call send mail and noti
                Set(urlToSendNoti, "<a href='" & linkToApp & "?screen=detail-ir&action=approve-ir&ir_id=" & investmentDetail.id & "'>Link to item</a>");
                If(investmentUpdateStatusRes.status = "200",
                    If(SaveButton_2.Visible, Select(SaveButton_2));
                    Set(sendNotiRes, 'TVS->SendNotiEmail-Process1.3-V1'.Run(
                        resKeyOpenAll.open,resKeyOpenAll.close,
                        If(showRejectPopup, "REJECTED", showRevisePopup, "REVISED", showPublishPopup, "PUBLISHED", "APPROVED"),
                        investmentDetail.id,
                        If(IsBlank(investmentDetail.report_name_en), Trim(investmentDetail.report_name), Trim(investmentDetail.report_name_en)),
                        urlToSendNoti, currenUserV2.name, envDEV,envTEST, envUAT1, envUAT2,
                        investmentDetail.created_id, currenUserV2.id,
                        appProperty, emailFromConfix, investmentDetail.status, If(IsBlank(DetailIRReason_Input.Text), "", DetailIRReason_Input.Text)
                    ));
                    Set(ShowNotificationCheck, If(showRejectPopup, "REJECTED_SUCCESS", showRevisePopup, "REVISED_SUCCESS", showPublishPopup, "PUBLISHED_SUCCESS", "APPROVED_SUCCESS"));
                    Set(showRejectPopup, false); Set(showApprovePopup, false); Set(showRevisePopup, false); Set(showPublishPopup, false);
                    Navigate(TableInvestmentResearch, ScreenTransition.Fade);
                );
                // End
                Set(isSummitedPopup, true);
                Set(isLoading, false);
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedColor: =Self.Color 
            PressedFill: =Self.Fill
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Size: =10.5
            Text: |-
                =If(showRejectPopup,
                If(Language = "Vn", "Từ chối", "Reject"),
                showRevisePopup,
                If(Language = "Vn", "Trả lại", "Revise"),
                showPublishPopup,
                If(Language = "Vn", "Công bố", "Publish"),
                If(Language = "Vn", "Duyệt", "Approve"))
            Visible: =showRejectPopup || showApprovePopup || showRevisePopup
            Width: =120
            X: =DetailIRPopupBg.X + DetailIRPopupBg.Width - 150
            Y: =DetailIRPopupBg.Y + DetailIRPopupBg.Height - 70
            ZIndex: =37

        DetailIRCancelButton As button:
            BorderColor: =Self.Color
            BorderThickness: =1
            Color: =RGBA(139, 139, 139, 1)
            DisabledFill: =Self.Fill
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =1
            Font: =Font.Arial
            FontWeight: =FontWeight.Normal
            Height: =44
            HoverBorderColor: =Self.BorderColor
            HoverColor: =Self.Color
            HoverFill: =ColorFade(Self.Fill , -15%)
            OnSelect: =Set(showRejectPopup, false); Set(showApprovePopup, false); Set(showRevisePopup, false); Set(showPublishPopup, false);
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =Self.BorderColor
            PressedColor: =Self.Color 
            PressedFill: =Self.Fill
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Size: =10.5
            Text: =If(Language = "Vn", "Trở lại", "Cancel")
            Visible: =showRejectPopup || showApprovePopup || showRevisePopup
            Width: =120
            X: =DetailIRSubmitButton.X - 130
            Y: =DetailIRPopupBg.Y + DetailIRPopupBg.Height - 70
            ZIndex: =38

        DetailIRPopupCloseIcon As icon.Cancel:
            Color: =RGBA(0, 0, 0, 1)
            Height: =20
            Icon: =Icon.Cancel
            OnSelect: =Set(showRejectPopup, false); Set(showApprovePopup, false); Set(showRevisePopup, false); Set(showPublishPopup, false);
            Visible: =showRejectPopup || showApprovePopup || showRevisePopup
            Width: =20
            X: =DetailIRPopupBg.X + DetailIRPopupBg.Width - 50
            Y: =DetailIR_Title.Y + 10
            ZIndex: =39

        DetailProposalName_Title_2 As label:
            Color: =RGBA(255, 0, 0, 1)
            Font: =Font.Arial
            Height: =20
            LineHeight: =2.2
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10.5
            Text: =LabelRequired.Text
            Visible: |-
                =// (showRejectPopup || showApprovePopup || showRevisePopup) && (isSummitedPopup && Len(DetailIRReason_Input.Text) = 0)
                false
            Width: =159
            X: =DetailProposalReason_Input.X
            Y: =DetailProposalReason_Input.Y + DetailProposalReason_Input.Height
            ZIndex: =40

    DeleteConfirm_3 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =51

        RejectPopupBack_9 As rectangle:
            Fill: =RGBA(0.3, 0.3, 0.3, 0.3)
            Height: =Parent.Height
            Visible: =isShowPopupDelete
            Width: =Parent.Width
            ZIndex: =64

        DeleteConfirmBg_7 As htmlViewer:
            Font: =Font.Arial
            Height: =If(Parent.Width > 600, 200, 200)
            HtmlText: |-
                ="<div style='margin-left: 8px; width: calc(100% - 16px); height: "& Self.Height - 20 &"px; background-color: white; border-radius: 12px;box-shadow: 5px 4px 8px 0px rgba(0, 0, 0, 0.10);
                '></div>"
            PaddingRight: =5.00
            PaddingTop: =5.00
            Size: =11.00
            Visible: =isShowPopupDelete
            Width: =If(App.Width > 600, 550, App.Width + 5)
            X: =If(App.Width > 600, App.Width * 0.5 - DeleteConfirmBg_7.Width *0.5, -3)
            Y: =App.Height / 2 - Self.Height
            ZIndex: =65

        CancelResearchOpinionButton_5 As button:
            BorderColor: =Self.Color
            BorderThickness: =1
            Color: =RGBA(214, 27, 27, 1)
            DisabledBorderColor: =RGBA(214, 27, 27, 1)
            DisabledColor: =RGBA(214, 27, 27, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(0, 0, 0, 0)
            FocusedBorderThickness: =1
            Font: =Font.Arial
            Height: =44
            HoverColor: =RGBA(214, 27, 27, 1)
            HoverFill: =
            OnSelect: |-
                =Set(varEncryptionDeleteSelectedId, Blank());
                Set(isShowPopupDelete, false);
            PressedBorderColor: =RGBA(214, 27, 27, 1)
            PressedColor: =RGBA(214, 27, 27, 1)
            PressedFill: =
            Size: =10.5
            Text: ="No"
            Visible: =isShowPopupDelete
            Width: =120
            X: =DeleteConfirmBg_7.X + DeleteConfirmBg_7.Width - 280
            Y: =DeleteConfirmBg_7.Y + DeleteConfirmBg_7.Height - 70
            ZIndex: =66

        DeleteResearchOpinionButton_5 As button:
            BorderThickness: =
            DisabledBorderColor: =RGBA(214, 27, 27, 1)
            DisabledColor: =RGBA(255, 255, 255, 1)
            DisabledFill: =RGBA(214, 27, 27, 1)
            Fill: =RGBA(214, 27, 27, 1)
            FocusedBorderThickness: =
            Font: =Font.Arial
            Height: =44
            HoverFill: =
            OnSelect: |-
                =UpdateContext({ShowNotification: false});
                If(isShowPreviewPopup,
                    If(btnDelete_1.Visible,
                        Set(idProposalDelete, If(IsBlank(investmentDetail), investmentId, investmentDetail.id));
                        Set(isLoading, true);
                        Set(deleteStatus, Blank());
                        Set(deleteStatus, 'TVS->DeleteInvestmentResearch-V1'.Run(resKeyOpenAll.open, resKeyOpenAll.close, If(IsBlank(currenUserV2.id), "", currenUserV2.id), idProposalDelete, envDEV,envTEST, envUAT1, envUAT2).status);
                        Set(isShowPopupDelete, false);
                        If(Value(deleteStatus) = 200,
                            Set(isShowPopupDelete, false); Set(IsSuccess, true);Set(NoticationText,"Deleted successfully");UpdateContext({ShowNotification: true});
                            Reset(ReportName_Input);
                            Reset(Note_Input);
                            Reset(ReportName_Input_Vn);
                            Reset(Note_Input_Vn);
                            Clear(listReportAttachFile);
                            Clear(listOthersAttachFile);
                            Clear(listReportAttachFileVn);
                            Clear(listOthersAttachFileVn);
                            Set(frequencyValue, Blank());
                            Set(reportTypeValue, Blank());
                            Set(reportWeekValue, Text(WeekNum(Today())));
                            Set(reportQuarterValue, Text(RoundUp(Month(Today()) / 3, 0)));
                            Set(reportMonthValue, Text(Month(Today())));
                            Set(reportYearValue, Text(Year(Today())));
                            Reset(ReportAttachFile);
                            Reset(OthersAttachFile);
                            Reset(ReportAttachFile_Vn);
                            Reset(OthersAttachFile_Vn);
                            Set(investmentDetail, Blank());
                            Set(investmentSaveRes, Blank());
                            Set(investmentId, Blank());
                            Set(isShowPreviewPopup, false);
                            Set(isShowPopupDelete, false);
                            ,
                            Set(isShowPopupDelete, false); Set(IsSuccess, false);Set(NoticationText,"This record has been processed by another user, please reload this page again.");UpdateContext({ShowNotification: true});
                        );
                        Set(isLoading, false);
                    ,
                        Reset(ReportName_Input);
                        Reset(Note_Input);
                        Reset(ReportName_Input_Vn);
                        Reset(Note_Input_Vn);
                        Clear(listReportAttachFile);
                        Clear(listOthersAttachFile);
                        Clear(listReportAttachFileVn);
                        Clear(listOthersAttachFileVn);
                        Set(frequencyValue, Blank());
                        Set(reportTypeValue, Blank());
                        Set(reportWeekValue, Text(WeekNum(Today())));
                        Set(reportQuarterValue, Text(RoundUp(Month(Today()) / 3, 0)));
                        Set(reportMonthValue, Text(Month(Today())));
                        Set(reportYearValue, Text(Year(Today())));
                        Reset(ReportAttachFile);
                        Reset(OthersAttachFile);
                        Reset(ReportAttachFile_Vn);
                        Reset(OthersAttachFile_Vn);
                        Set(investmentId, Blank());
                        Set(isShowPreviewPopup, false);
                        Set(isShowPopupDelete, false);
                    )
                ,
                    Set(isLoading, true);
                    Set(deleteStatus, Blank());
                    Set(deleteStatus, 'TVS->DeleteInvestmentResearch-V1'.Run(resKeyOpenAll.open, resKeyOpenAll.close, If(IsBlank(currenUserV2.id), "", currenUserV2.id), idProposalDelete, envDEV,envTEST, envUAT1, envUAT2).status);
                    If(Value(deleteStatus) = 200,
                    Set(ShowNotificationCheck, "DELETED_SUCCESS");
                    Navigate(TableInvestmentResearch, ScreenTransition.Fade);,
                    Set(isShowPopupDelete, false); Set(IsSuccess, false);Set(NoticationText,"This record has been processed by another user, please reload this page again.");UpdateContext({ShowNotification: true});
                );
                    Set(isLoading, false);
                );
                
                Set(reportTypeShowDropdown, false);
                Set(reportYearShowDropdown, false);
                Set(reportQuarterShowDropdown, false);
                Set(reportMonthShowDropdown, false);
                Set(reportWeekShowDropdown, false);
                Set(reportPrivacyShowDropdown, false);
            PressedColor: =RGBA(255, 255, 255, 1)
            PressedFill: =RGBA(214, 27, 27, 1)
            Size: =10.5
            Text: ="Yes"
            Visible: =isShowPopupDelete
            Width: =120
            X: =DeleteConfirmBg_7.X + DeleteConfirmBg_7.Width - 150
            Y: =DeleteConfirmBg_7.Y + DeleteConfirmBg_7.Height - 70
            ZIndex: =67

        DeleteConfirmCloseIcon_8 As icon.Cancel:
            Color: =RGBA(26, 26, 26, 1)
            Height: =20
            Icon: =Icon.Cancel
            OnSelect: |-
                =Set(varEncryptionDeleteSelectedId, Blank());
                Set(isShowPopupDelete, false);
            Visible: =isShowPopupDelete
            Width: =20
            X: =DeleteConfirmBg_7. X + DeleteConfirmBg_7.Width -50
            Y: =DeleteConfirmBg_7.Y + 20
            ZIndex: =68

        DeleteConfirmLabel_8 As label:
            Font: =Font.Arial
            Size: =12
            Text: ="Are you sure to delete this report ?"
            Visible: =isShowPopupDelete
            Width: =DeleteConfirmBg_7.Width - DeleteConfirmCloseIcon_8.Width - 40
            X: =Label2_5.X
            Y: =Label2_5.Y + Label2_5.Height
            ZIndex: =69

        Label2_5 As label:
            Font: =Font.Arial
            FontWeight: =FontWeight.Bold
            Size: =14
            Text: ="Delete"
            Visible: =isShowPopupDelete
            X: =DeleteConfirmBg_7.X + 30
            Y: =DeleteConfirmBg_7.Y + 10
            ZIndex: =70

    PreviewPopup As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =54

        RejectPopupBack_8 As rectangle:
            Fill: =RGBA(0.3, 0.3, 0.3, 0.3)
            Height: =Parent.Height
            Visible: =isShowPreviewPopup
            Width: =Parent.Width
            ZIndex: =24

        DeleteConfirmBg_6 As htmlViewer:
            Font: =Font.Arial
            Height: =If(App.Height > 700, 600, 500)
            HtmlText: |-
                ="<div style='margin-left: 8px; width: calc(100% - 16px); height: "& Self.Height - 20 &"px; background-color: white; border-radius: 12px;box-shadow: 5px 4px 8px 0px rgba(0, 0, 0, 0.10);
                '></div>"
            PaddingRight: =5.00
            PaddingTop: =5.00
            Size: =11.00
            Visible: =isShowPreviewPopup
            Width: =If(App.Width > 800, App.Width * 6 / 10, App.Width + 5)
            X: =If(App.Width > 800, App.Width * 0.2, -3)
            Y: =(App.Height - Self.Height) / 2
            ZIndex: =25

        CancelResearchOpinionButton_4 As button:
            BorderColor: =Self.Color
            BorderThickness: =1
            DisabledBorderColor: =RGBA(214, 27, 27, 1)
            DisabledColor: =RGBA(255, 255, 255, 1)
            DisabledFill: =RGBA(202, 202, 202, 1)
            Fill: =RGBA(214, 27, 27, 1)
            FocusedBorderThickness: =1
            Font: =Font.Arial
            Height: =44
            HoverColor: =Self.Color
            HoverFill: =
            OnSelect: =Set(isShowPreviewPopup, false);
            PressedBorderColor: =RGBA(214, 27, 27, 1)
            PressedColor: =Self.Color
            PressedFill: =
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Size: =10.5
            Text: =If(Language = "Vn", "Đóng", "Close")
            Visible: =isShowPreviewPopup
            Width: =120
            X: =DeleteConfirmBg_6.X + DeleteConfirmBg_6.Width - 150
            Y: =DeleteConfirmBg_6.Y + DeleteConfirmBg_6.Height - 70
            ZIndex: =26

        DeleteResearchOpinionButton_4 As button:
            BorderColor: =RGBA(139, 139, 139, 1)
            BorderThickness: =1
            Color: =Self.BorderColor
            DisabledBorderColor: =RGBA(219, 219, 219, 1)
            DisabledColor: =RGBA(255, 255, 255, 1)
            DisabledFill: =RGBA(202, 202, 202, 1)
            DisplayMode: =If(If(IsBlank(investmentDetail), SaveButton_2.Visible, btnDelete_1.Visible), DisplayMode.Edit, DisplayMode.Disabled)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =1
            Font: =Font.Arial
            Height: =44
            HoverColor: =Self.Color
            HoverFill: =
            OnSelect: =Set(isShowPopupDelete, true);
            PressedBorderColor: =Self.BorderColor
            PressedColor: =Self.Color
            PressedFill: =RGBA(255, 255, 255, 1)
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Size: =10.5
            Text: =If(Language = "Vn", "Xóa ", "Delete")
            Visible: =isShowPreviewPopup
            Width: =120
            X: =CancelResearchOpinionButton_4.X - Self.Width - 10
            Y: =DeleteConfirmBg_6.Y + DeleteConfirmBg_6.Height - 70
            ZIndex: =27

        DeleteConfirmCloseIcon_7 As icon.Cancel:
            Color: =RGBA(26, 26, 26, 1)
            Height: =20
            Icon: =Icon.Cancel
            OnSelect: =Set(isShowPreviewPopup, false);
            Visible: =isShowPreviewPopup
            Width: =20
            X: =DeleteConfirmBg_6. X + DeleteConfirmBg_6.Width -50
            Y: =DeleteConfirmBg_6.Y + 15
            ZIndex: =28

        Label2_4 As label:
            AutoHeight: =true
            Font: =Font.Arial
            FontWeight: =FontWeight.Semibold
            Height: =If(App.Width > 600, 40, 80)
            Size: =If(App.Width > 600, 12, 10.5)
            Text: |-
                =Substitute(If(IsBlank(reportTypeValue), If(IsBlank(If(Language = "Vn", ReportName_Input_Vn.Text,ReportName_Input.Text)), If(Language = "En", "Preview", "Bản xem trước"), If(Language = "Vn", ReportName_Input_Vn.Text,ReportName_Input.Text)), If(Language = "Vn", First(Filter(reportTypeArray, reportTypeValue = value)).vn, First(Filter(reportTypeArray, reportTypeValue = value)).en) & " : " & If(Language = "Vn", ReportName_Input_Vn.Text,ReportName_Input.Text)),Char(10),",")
            Visible: =isShowPreviewPopup
            Width: =DeleteConfirmBg_6.Width - 90
            X: =DeleteConfirmBg_6.X + 30
            Y: =DeleteConfirmBg_6.Y + 10
            ZIndex: =29

        Hr_2 As rectangle:
            BorderColor: =RGBA(191, 191, 192, 1)
            Fill: =RGBA(191, 191, 192, 1)
            Height: =2
            Visible: =isShowPreviewPopup
            Width: =DeleteConfirmBg_6.Width - 27
            X: =DeleteConfirmBg_6.X + 13
            Y: =Label2_4.Y + Label2_4.Height + 5
            ZIndex: =30

        TextInput3 As text:
            Align: =If(IsBlank(If(Language = "Vn", Note_Input_Vn.Text, Note_Input.Text)), Align.Center, Align.Left)
            BorderThickness: =0
            Default: =If(IsBlank(If(Language = "Vn", Note_Input_Vn.Text, Note_Input.Text)), "There is no content.", If(Language = "Vn", Note_Input_Vn.Text, Note_Input.Text))
            DisabledColor: =RGBA(0, 0, 0, 1)
            DisabledFill: =RGBA(0, 0, 0, 0)
            DisplayMode: =DisplayMode.Disabled
            FocusedBorderThickness: =0
            Font: =Font.Arial
            Height: =DeleteResearchOpinionButton_4.Y - Self.Y - 20
            LineHeight: =1.5
            Mode: =TextMode.MultiLine
            PaddingLeft: =6
            Size: =10.5
            Visible: =isShowPreviewPopup
            Width: =Hr_2.Width - If(App.Width > 600, 30, 20)
            X: =Label2_4.X
            Y: =Hr_2.Y + 6
            ZIndex: =31

    Timer1_15 As timer:
        Duration: =3000
        Font: =Font.Arial
        OnTimerEnd: |-
            =Reset(Timer1_15); UpdateContext({ShowNotification: false}); Set(IsError, false);
        Start: =ShowNotification
        Visible: =false
        X: =1135
        Y: =592
        ZIndex: =60

    NotificationBox_15 As button:
        Align: =Align.Left
        BorderColor: =RGBA(40, 167, 69, 1)
        BorderThickness: =0
        DisabledFill: =Self.Fill
        Fill: =If(IsError, RGBA(209, 50, 50, 1), RGBA(40, 167, 69, 1))
        FocusedBorderThickness: =0
        Font: =Font.Arial
        Height: =50
        HoverBorderColor: =Self.Fill
        HoverFill: =Self.Fill
        PaddingLeft: =15
        PaddingRight: =30
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =Self.Fill
        RadiusBottomLeft: =5
        RadiusBottomRight: =5
        RadiusTopLeft: =5
        RadiusTopRight: =5
        Size: =10.5
        Text: =NoticationText
        Visible: =Timer1_15.Value <> 0
        Width: =320
        X: =App.Width - Self.Width - 2
        Y: =25
        ZIndex: =61

    CloseNotiIcon_15 As icon.Cancel:
        Color: =RGBA(255, 255, 255, 1)
        Height: =15
        Icon: =Icon.Cancel
        OnSelect: =Reset(Timer1_15); Set(IsError, false);
        Visible: =NotificationBox_15.Visible
        Width: =15
        X: =NotificationBox_15.X + NotificationBox_15.Width - 25
        Y: =NotificationBox_15.Y + 17.5
        ZIndex: =62

    NotificationScreen_10 As NotificationScreen:
        Visible: =ShowNotificationPopup
        ZIndex: =63

    LoadingQT2List_12 As LoadingComponent_4:
        Visible: =isLoading
        ZIndex: =71

    Button2_2 As button:
        Font: =Font.Arial
        OnSelect: |-
            =Set(ShowNotificationCheck, "ACCESS_DENIED_IR");
            Navigate(WelcomePage, ScreenTransition.Fade)
        Text: ="Button"
        Visible: =false
        X: =40
        Y: =40
        ZIndex: =72

    PublishIRPopupGroup As group:
        Height: =5
        Width: =5
        X: =80
        Y: =80
        ZIndex: =73

        PublishIRPopupBack As rectangle:
            Fill: =RGBA(0.3, 0.3, 0.3, 0.3)
            Height: =App.Height
            Visible: =showPublishPopup
            Width: =App.Width
            ZIndex: =41

        PublishIRPopupBg As htmlViewer:
            Font: =Font.Arial
            Height: =620 + listFilesToSend_Items.Height
            HtmlText: |-
                ="<div style='width: calc(100% - 10px); height: "& Self.Height - 20 &"px; background-color: white; border-radius: 12px;box-shadow: 5px 4px 8px 0px rgba(0, 0, 0, 0.10);
                '></div>"
            PaddingRight: =5.00
            PaddingTop: =5.00
            Size: =11.00
            Visible: =showPublishPopup
            Width: =If(Parent.Width > 600, 600, Parent.Width)
            X: =If(Parent.Width > 600, App.Width / 2 - Self.Width / 2, 5)
            Y: =(App.Height - Self.Height) / 2
            ZIndex: =42

        PublishIR_Title As label:
            Font: =Font.Arial
            FontWeight: =FontWeight.Bold
            Height: =43
            LineHeight: =2.2
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =12
            Text: |-
                =If(showRejectPopup,
                If(Language = "Vn", "Bạn muốn từ chối bản ghi này?", "Reject this record?"),
                showRevisePopup, If(Language = "Vn", "Bạn muốn trả lại bản ghi này?", "Revise this record?"),
                showPublishPopup, If(Language = "Vn", "Bạn muốn công bố bản ghi này?", "Publish this record?"),
                If(Language = "Vn", "Bạn muốn duyệt bản ghi này?", "Approve this record?"))
            Visible: =showPublishPopup
            Width: =299
            X: =PublishIRPopupBg.X + 20
            Y: =PublishIRPopupBg.Y + 10
            ZIndex: =43

        PublishIRMailContent_Title As label:
            Font: =Font.Arial
            Height: =43
            LineHeight: =2.2
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10.5
            Text: =If(Language = "Vn", "Nội dung email", "Email content")
            Visible: =showPublishPopup
            Width: =159
            X: =PublishIR_Title.X
            Y: =PublishIRMailEmails_Input.Y + PublishIRMailEmails_Input.Height + 10
            ZIndex: =44

        PublishIRMailContent_Input As text:
            BorderColor: =If(isSummitedPopup && Len(Self.Text) = 0, RGBA(214, 27, 27, 1), RGBA(191, 191, 192, 1))
            BorderThickness: =1
            Default: |-
                ="Dear all,
                
                TVS Research Team would like to send you the "&
                    If(!IsBlank(investmentDetail.report_name_en) && !IsBlank(investmentDetail.report_name),
                    investmentDetail.report_name_en & "(" & investmentDetail.report_name & ")",
                    !IsBlank(investmentDetail.report_name_en), investmentDetail.report_name_en,
                    investmentDetail.report_name)
                &". Some key highlights from our reports: 
                "&
                If(!IsBlank(investmentDetail.report_name_en) && !IsBlank(investmentDetail.report_name),
                "English preview content:
                " & investmentDetail.note_en& "
                -----------------------------------
                Vietnamese preview content:
                " & investmentDetail.note,
                !IsBlank(investmentDetail.report_name_en), 
                "English preview content:
                " & investmentDetail.note_en,
                "Vietnamese preview content:
                " & investmentDetail.note)
                &"
                
                Please access the report(s) via the link(s): 
                [Your report(s) files link will be attach here]
                
                If you have any questions, please contact us via email: research@tvs.vn. We also appreciate any comments and feedback from you.
                
                Best regards, 
                TVS Research Team"
            FocusedBorderColor: =Self.HoverBorderColor
            FocusedBorderThickness: =1
            Font: =Font.Arial
            Height: =If(App.Width > 600, 140, 120)
            HintText: =If(Language = "Vn", "Nhập nội dung email.", "Input your email content.")
            HoverFill: =RGBA(186, 202, 226, 0)
            Mode: =TextMode.MultiLine
            Size: =If(App.Width > 600, 10.5, 12)
            Visible: =showPublishPopup
            Width: =PublishIRPopupBg.Width - 50
            X: =PublishIRMailContent_Title.X
            Y: =PublishIRMailContent_Title.Y + PublishIRMailContent_Title.Height
            ZIndex: =45

        PublishIRSubmitButton As button:
            BorderThickness: =0
            Fill: =If(showRejectPopup, RGBA(214, 27, 27, 1), showRevisePopup, RGBA(214, 117, 27, 1), RGBA(17, 79, 144, 1))
            FocusedBorderThickness: =0
            Font: =Font.Arial
            FontWeight: =FontWeight.Normal
            Height: =44
            HoverFill: =Self.Fill
            OnSelect: |-
                =UpdateContext({ShowNotification: false});
                If(IsBlank(PublishIRMailSubject_Input.Text),
                    Set(IsError, true); Set(NoticationText,"Subject is required!"); UpdateContext({ShowNotification: true});,
                    IsBlank(PublishIRMailEmails_Input.Text),
                    Set(IsError, true); Set(NoticationText,"List emails is required!"); UpdateContext({ShowNotification: true});,
                    "," in PublishIRMailEmails_Input.Text || " " in PublishIRMailEmails_Input.Text || "|" in PublishIRMailEmails_Input.Text ||
                    "&" in PublishIRMailEmails_Input.Text || "#" in PublishIRMailEmails_Input.Text,
                    Set(IsError, true); Set(NoticationText,"List emails split by semicolons!"); UpdateContext({ShowNotification: true});,
                
                    // Validated
                    Set(isLoading, true);
                    Clear(listFileEmail);
                ForAll(listFileToPublish,Collect(listFileEmail,{
                    file_name: ThisRecord.file_name
                }));
                ClearCollect(listReportFile, Filter(listFileTotal, !("O" in type)));
                ClearCollect(listReportFileVN, Filter(listReportFile, "VN" in type));
                ClearCollect(listReportFileEN, Filter(listReportFile, !("VN" in type)));
                Set(fileLinkVN, Concat(listReportFileVN, "<a href="""&urlUploadRSHead&file_name&urlUploadRSTail&""">"&file_name&"</a>" & "<br/>"));
                Set(fileLinkEN, Concat(listReportFileEN, "<a href="""&urlUploadRSHead&file_name&urlUploadRSTail&""">"&file_name&"</a>" & "<br/>"));
                Set(fileLink,
                    If(Len(fileLinkVN) > 0 && Len(fileLinkEN) > 0,
                    "En version: <br />
                    " & fileLinkEN & "
                    Vn version: <br />
                    " & fileLinkVN,
                    Len(fileLinkEN) > 0,
                    "En version: <br />
                    " & fileLinkEN,
                    "Vn version: <br />
                    " & fileLinkVN
                ));
                
                
                Set(body, Substitute(Substitute(PublishIRMailContent_Input.Text,Char(10), "<br />"), "[Your report(s) files link will be attach here]", fileLink));
                
                Set(sendEmailPublishRes, 'TVS->SendEmailTemplate-1.3-V1'.Run(
                    JSON(listFileEmail,JSONFormat.IndentFour),
                    PublishIRMailSubject_Input.Text,
                    PublishIRMailEmails_Input.Text,
                    body, resKeyOpenAll.open, resKeyOpenAll.close, investmentDetail.id, envDEV, envTEST, envUAT1, envUAT2,bucketRSAttach, emailFromConfix)
                );
                
                If(!IsError(sendEmailPublishRes) && sendEmailPublishRes.status = "200",
                    Set(ShowNotificationCheck, "PUBLISHED_SUCCESS"); Set(showPublishPopup, false); Navigate(TableInvestmentResearch, ScreenTransition.Fade);,
                    !IsError(sendEmailPublishRes) && sendEmailPublishRes.status = "300",
                    Set(IsError, true); Set(NoticationText,"Total attachment files max 20MB"); UpdateContext({ShowNotification: true}),
                    Set(IsError, true); Set(NoticationText,"The selected file is invalid!"); UpdateContext({ShowNotification: true})
                );
                Set(isLoading, false);
                );
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedColor: =Self.Color 
            PressedFill: =Self.Fill
            Size: =10.5
            Text: |-
                =If(showRejectPopup,
                If(Language = "Vn", "Từ chối", "Reject"),
                showRevisePopup,
                If(Language = "Vn", "Trả lại", "Revise"),
                showPublishPopup,
                If(Language = "Vn", "Công bố", "Publish"),
                If(Language = "Vn", "Duyệt", "Approve"))
            Visible: =showPublishPopup
            Width: =120
            X: =PublishIRPopupBg.X + PublishIRPopupBg.Width - 150
            Y: =PublishIRPopupBg.Y + PublishIRPopupBg.Height - 70
            ZIndex: =46

        PublishIRCancelButton As button:
            BorderColor: =Self.Color
            BorderThickness: =1
            Color: =RGBA(139, 139, 139, 1)
            DisabledFill: =Self.Fill
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =1
            Font: =Font.Arial
            FontWeight: =FontWeight.Normal
            Height: =44
            HoverBorderColor: =Self.BorderColor
            HoverColor: =Self.Color
            HoverFill: =Self.Fill
            OnSelect: =Set(showPublishPopup, false);
            PaddingBottom: =10
            PaddingLeft: =10
            PaddingRight: =10
            PaddingTop: =10
            PressedBorderColor: =Self.BorderColor
            PressedColor: =Self.Color 
            PressedFill: =Self.Fill
            Size: =10.5
            Text: =If(Language = "Vn", "Trở lại", "Cancel")
            Visible: =showPublishPopup
            Width: =120
            X: =PublishIRSubmitButton.X - 140
            Y: =PublishIRPopupBg.Y + PublishIRPopupBg.Height - 70
            ZIndex: =47

        PublishIRPopupCloseIcon As icon.Cancel:
            Color: =RGBA(0, 0, 0, 1)
            Height: =20
            Icon: =Icon.Cancel
            OnSelect: =Set(showPublishPopup, false);
            Visible: =showPublishPopup
            Width: =20
            X: =PublishIRPopupBg.X + PublishIRPopupBg.Width - 50
            Y: =PublishIR_Title.Y + 10
            ZIndex: =48

        PublishIRMailContent_Error As label:
            Color: =RGBA(255, 0, 0, 1)
            Font: =Font.Arial
            Height: =20
            LineHeight: =2.2
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10.5
            Text: =LabelRequired.Text
            Visible: =showPublishPopup && (isSummitedPopup && Len(PublishIRMailContent_Input.Text) = 0)
            Width: =159
            X: =DetailProposalReason_Input.X
            Y: =DetailProposalReason_Input.Y + DetailProposalReason_Input.Height
            ZIndex: =49

        PublishIRMailSubject_Title As label:
            Font: =Font.Arial
            Height: =43
            LineHeight: =2.2
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10.5
            Text: =If(Language = "Vn", "Tiêu đề", "Subject")
            Visible: =showPublishPopup
            Width: =159
            X: =PublishIR_Title.X
            Y: =PublishIR_Title.Y + PublishIR_Title.Height + 10
            ZIndex: =50

        PublishIRMailSubject_Input As text:
            BorderColor: =If(isSummitedPopup && Len(Self.Text) = 0, RGBA(214, 27, 27, 1), RGBA(191, 191, 192, 1))
            BorderThickness: =1
            Default: |-
                =If(!IsBlank(investmentDetail.report_name_en) && !IsBlank(investmentDetail.report_name),
                    investmentDetail.report_name_en & "(" & investmentDetail.report_name & ")",
                    !IsBlank(investmentDetail.report_name_en), investmentDetail.report_name_en,
                    investmentDetail.report_name)
            FocusedBorderColor: =Self.HoverBorderColor
            FocusedBorderThickness: =1
            Font: =Font.Arial
            Height: =44
            HintText: =If(Language = "Vn", "Nhập tiêu đề email.", "Enter your email subject.")
            HoverFill: =RGBA(186, 202, 226, 0)
            MaxLength: =500
            Mode: =TextMode.MultiLine
            Size: =If(App.Width > 600, 10.5, 12)
            TabIndex: =1
            Visible: =showPublishPopup
            Width: =PublishIRPopupBg.Width - 50
            X: =PublishIRMailSubject_Title.X
            Y: =PublishIRMailSubject_Title.Y + PublishIRMailSubject_Title.Height
            ZIndex: =51

        PublishIRMailEmails_Title As label:
            Font: =Font.Arial
            Height: =43
            LineHeight: =2.2
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10.5
            Text: =If(Language = "Vn", "Danh sách email", "List emails")
            Visible: =showPublishPopup
            Width: =159
            X: =PublishIR_Title.X
            Y: =PublishIRMailSubject_Input.Y + PublishIRMailSubject_Input.Height + 10
            ZIndex: =52

        PublishIRMailEmails_Input As text:
            BorderColor: =If(isSummitedPopup && Len(Self.Text) = 0, RGBA(214, 27, 27, 1), RGBA(191, 191, 192, 1))
            BorderThickness: =1
            Default: =
            FocusedBorderColor: =Self.HoverBorderColor
            FocusedBorderThickness: =1
            Font: =Font.Arial
            Height: =44
            HintText: =If(Language = "Vn", "Nhập danh sách email (cách nhau bởi dấu chấm phẩy).", "Enter emails (split by semicolons).")
            HoverFill: =RGBA(186, 202, 226, 0)
            Size: =If(App.Width > 600, 10.5, 12)
            Visible: =showPublishPopup
            Width: =PublishIRPopupBg.Width - 50
            X: =PublishIRMailEmails_Title.X
            Y: =PublishIRMailEmails_Title.Y + PublishIRMailEmails_Title.Height
            ZIndex: =53

        PublishIRMailFiles_Title As label:
            Font: =Font.Arial
            Height: =43
            LineHeight: =2.2
            PaddingBottom: =0
            PaddingLeft: =0
            PaddingRight: =0
            PaddingTop: =0
            Size: =10.5
            Text: =If(Language = "Vn", "Chọn file muốn đính kèm", "Choose files to send ")
            Visible: =showPublishPopup
            Width: =159
            X: =PublishIR_Title.X
            Y: =PublishIRMailContent_Input.Y + PublishIRMailContent_Input.Height + 10
            ZIndex: =54

        PublishFilesDropdown As button:
            Align: =Align.Left
            BorderColor: =If(reportTypeShowDropdown, RGBA(0, 18, 107, 1), ColorFade(Self.Fill, -15%))
            BorderThickness: =1
            Color: =RGBA(82, 82, 82, 1)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderThickness: =1
            Font: =Font.Arial
            FontWeight: =FontWeight.Normal
            Height: =44
            HoverColor: =RGBA(0, 0, 0, 1)
            HoverFill: =RGBA(241, 244, 249, 1)
            OnSelect: |-
                =If(CountRows(Filter(listFileTotal, !(ThisRecord in listFileToPublish))) > 0,
                    Set(filesShowDropdown, !filesShowDropdown)
                )
            PaddingLeft: =15
            PaddingRight: =5.27
            PaddingTop: =5.27
            PressedBorderColor: =
            PressedColor: =
            PressedFill: =
            RadiusBottomLeft: =5
            RadiusBottomRight: =5
            RadiusTopLeft: =5
            RadiusTopRight: =5
            Size: =10.5
            Text: =""
            Visible: =showPublishPopup
            Width: =PublishIRPopupBg.Width - 50
            X: =PublishIRMailFiles_Title.X
            Y: =PublishIRMailFiles_Title.Y + PublishIRMailFiles_Title.Height
            ZIndex: =55

        PublishFilesChevron As htmlViewer:
            Font: =Font.Arial
            Height: =44
            HtmlText: |-
                =If(reportTypeShowDropdown,
                "<div style=""cursor: pointer""><svg width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"" xmlns=""http://www.w3.org/2000/svg"">
                <g clip-path=""url(#clip0_1760_3688)"">
                <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M11.2682 8.62347C11.4558 8.436 11.7101 8.33068 11.9752 8.33068C12.2404 8.33068 12.4947 8.436 12.6822 8.62347L18.3392 14.2805C18.4348 14.3727 18.5109 14.4831 18.5633 14.6051C18.6158 14.7271 18.6433 14.8583 18.6445 14.9911C18.6456 15.1238 18.6203 15.2555 18.5701 15.3784C18.5198 15.5013 18.4455 15.613 18.3516 15.7069C18.2577 15.8008 18.1461 15.875 18.0232 15.9253C17.9003 15.9756 17.7686 16.0009 17.6358 15.9997C17.5031 15.9986 17.3718 15.971 17.2498 15.9186C17.1278 15.8662 17.0175 15.79 16.9252 15.6945L11.9752 10.7445L7.02524 15.6945C6.83664 15.8766 6.58404 15.9774 6.32184 15.9751C6.05965 15.9729 5.80883 15.8677 5.62342 15.6823C5.43802 15.4969 5.33285 15.2461 5.33057 14.9839C5.32829 14.7217 5.42908 14.4691 5.61124 14.2805L11.2682 8.62347Z"" fill=""#525252""/>
                </g>
                <defs>
                <clipPath id=""clip0_1760_3688"">
                <rect width=""24"" height=""24"" fill=""white""/>
                </clipPath>
                </defs>
                </svg></div>"
                , "<div style=""cursor: pointer""><svg xmlns=""http://www.w3.org/2000/svg"" width=""24"" height=""24"" viewBox=""0 0 24 24"" fill=""none"">
                <path fill-rule=""evenodd"" clip-rule=""evenodd"" d=""M12.7069 15.7071C12.5193 15.8946 12.265 15.9999 11.9999 15.9999C11.7347 15.9999 11.4804 15.8946 11.2929 15.7071L5.63585 10.0501C5.54034 9.95785 5.46416 9.84751 5.41175 9.7255C5.35934 9.6035 5.33176 9.47228 5.3306 9.3395C5.32945 9.20672 5.35475 9.07504 5.40503 8.95215C5.45531 8.82925 5.52957 8.7176 5.62346 8.6237C5.71735 8.52981 5.829 8.45556 5.9519 8.40528C6.0748 8.355 6.20648 8.32969 6.33926 8.33085C6.47204 8.332 6.60325 8.35959 6.72526 8.412C6.84726 8.46441 6.95761 8.54059 7.04985 8.6361L11.9999 13.5861L16.9499 8.6361C17.1385 8.45394 17.3911 8.35315 17.6533 8.35542C17.9155 8.3577 18.1663 8.46287 18.3517 8.64828C18.5371 8.83369 18.6423 9.0845 18.6445 9.3467C18.6468 9.60889 18.546 9.8615 18.3639 10.0501L12.7069 15.7071Z"" fill=""#525252""/>
                </svg></div>")
            OnSelect: |-
                =If(CountRows(Filter(listFileTotal, !(ThisRecord in listFileToPublish))) > 0,
                    Set(filesShowDropdown, !filesShowDropdown)
                )
            PaddingRight: =5.27
            PaddingTop: =5.27
            Size: =11.60
            Visible: =showPublishPopup
            Width: =35
            X: =PublishFilesDropdown.X + PublishFilesDropdown.Width - 40
            Y: =PublishFilesDropdown.Y + 5
            ZIndex: =56

        "listFilesToSend_Items As gallery.'BrowseLayout_Flexible_SocialFeed_ver5.0'":
            '#CopilotOverlayLabel': ="Filtered"
            DelayItemLoading: =true
            Height: =Min(Self.AllItemsCount, 4) * Self.TemplateHeight
            Items: =listFileToPublish
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =If(App.Width > 800, 35, 45)
            Visible: =showPublishPopup
            Width: =PublishFilesDropdown.Width
            X: =PublishFilesDropdown.X
            Y: =PublishFilesDropdown.Y + PublishFilesDropdown.Height
            ZIndex: =57

            Label7_9 As label:
                BorderColor: =RGBA(77, 77, 77, 1)
                Font: =Font.Arial
                Height: =Parent.TemplateHeight
                OnSelect: =Select(Parent)
                PaddingTop: =If(App.Width > 800, 5, 0)
                Size: =10.5
                Text: =If(App.Width > 800, ThisItem.file_name, If(Len(ThisItem.file_name) < 70, ThisItem.file_name, Left(ThisItem.file_name, 70) & "..."))
                Tooltip: =ThisItem.file_name
                Width: =listFilesToSend_Items.Width - HtmlText2_10.Width
                X: =HtmlText2_10.X + HtmlText2_10.Width
                ZIndex: =2

            HtmlText2_10 As htmlViewer:
                Font: =Font.Arial
                Height: =Parent.TemplateHeight
                HtmlText: |-
                    ="<div style=""cursor:pointer""><svg xmlns=""http://www.w3.org/2000/svg"" width=""10"" height=""11"" viewBox=""0 0 10 11"" fill=""none"">
                      <g clip-path=""url(#clip0_5576_58443)"">
                        <path d=""M5 0.5C2.21429 0.5 0 2.71429 0 5.5C0 8.28571 2.21429 10.5 5 10.5C7.78571 10.5 10 8.28571 10 5.5C10 2.71429 7.78571 0.5 5 0.5ZM6.92857 8L5 6.07143L3.07143 8L2.5 7.42857L4.42857 5.5L2.5 3.57143L3.07143 3L5 4.92857L6.92857 3L7.5 3.57143L5.57143 5.5L7.5 7.42857L6.92857 8Z"" fill=""black""/>
                      </g>
                      <defs>
                        <clipPath id=""clip0_5576_58443"">
                          <rect width=""10"" height=""10"" fill=""white"" transform=""translate(0 0.5)""/>
                        </clipPath>
                      </defs>
                    </svg></div>"
                OnSelect: =RemoveIf(listFileToPublish, ThisRecord.id = ThisItem.id)
                Width: =25
                ZIndex: =3

        PublishFilesCloseDropdown As rectangle:
            Fill: =RGBA(255, 255, 255, 0)
            Height: =App.Height - 100
            OnSelect: =Set(filesShowDropdown, false)
            Visible: =filesShowDropdown && showPublishPopup
            Width: =Parent.Width
            Y: =60
            ZIndex: =58

        "PublishFilesItems As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
            '#CopilotOverlayLabel': ="Filtered"
            BorderColor: =RGBA(191, 191, 192, 1)
            BorderThickness: =0.5
            Fill: =RGBA(255, 255, 255, 1)
            Height: =Min(Self.AllItemsCount, 4) * Self.TemplateHeight + 10
            Items: =Filter(listFileTotal, !(ThisRecord in listFileToPublish))
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplatePadding: =0
            TemplateSize: =40
            Visible: =filesShowDropdown && showPublishPopup
            Width: =PublishFilesDropdown.Width
            X: =PublishFilesDropdown.X
            Y: =PublishFilesDropdown.Y + 50
            ZIndex: =59

            Button6_18 As button:
                Align: =Align.Left
                BorderThickness: =0
                Color: =RGBA(82, 82, 82, 1)
                Fill: =RGBA(0, 0, 0, 0)
                FocusedBorderThickness: =0
                Font: =Font.Arial
                FontWeight: =FontWeight.Normal
                HoverColor: =RGBA(0, 0, 0, 1)
                HoverFill: =RGBA(241, 244, 249, 1)
                OnSelect: |-
                    =Collect(listFileToPublish, ThisItem);
                    Set(filesShowDropdown, false);
                PaddingLeft: =15
                PaddingRight: =5.27
                PaddingTop: =5.27
                PressedColor: =Self.Color
                PressedFill: =
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =10.5
                Text: =ThisItem.file_name
                Width: =Parent.Width 
                X: =0.00
                ZIndex: =1

